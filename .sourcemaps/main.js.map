{"version":3,"sources":["../../node_modules/@angular/core/@angular lazy","../../src lazy","../../src/models/objects.ts","../../src/helpers/api.ts","../../src/providers/configuration.ts","../../src/providers/authentication.ts","../../src/providers/statistics.ts","../../src/providers/books.ts","../../src/providers/resources.ts","../../src/pages/search/search.ts","../../src/pages/books/surf/surf.ts","../../src/pages/books/info/info.ts","../../src/pages/books/options/options.ts","../../src/pages/books/read/read.ts","../../src/pages/home/home.ts","../../src/pages/accounts/signin/signin.ts","../../src/pages/accounts/profile/profile.ts","../../src/providers/accounts.ts","../../src/pages/accounts/search/search.ts","../../src/app/app.component.ts","../../src/app/app.module.ts","../../src/app/app.module.ngfactory.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","Error","keys","module","exports","id","__extends","this","api___extends","__decorate","decorators","target","key","desc","authentication___decorate","statistics___decorate","books___decorate","resources___decorate","surf___decorate","accounts___decorate","_super"],"mappings":"oCAAA,SAAAA,EAAAC,GAGA,OAAAC,QAAAC,UAAAC,KAAA,WACA,MAAA,IAAAC,MAAA,uBAAAJ,EAAA,QAGAD,EAAAM,KAAA,WAA4C,UAC5CN,EAAAG,QAAAH,EACAO,EAAAC,QAAAR,EACAA,EAAAS,GAAA,uBCVA,SAAAT,EAAAC,GAGA,OAAAC,QAAAC,UAAAC,KAAA,WACA,MAAA,IAAAC,MAAA,uBAAAJ,EAAA,QAGAD,EAAAM,KAAA,WAA4C,UAC5CN,EAAAG,QAAAH,EACAO,EAAAC,QAAAR,EACAA,EAAAS,GAAA,60xNCVAC,GAAAC,MAAAA,KAAAD,WAAA,wSAAA,w4jBCAAE,GAAAD,MAAAA,KAAAD,WAAA,wSAAA,iwNCAA,IAAAG,GAAAF,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDA4D0B,6kXAAA,6SC5D1BC,GAAAP,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDAyD2B,qwhBAAA,qLCzD3BE,GAAAR,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDAwDuB,gsOAAA,+OCxDvBG,GAAAT,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDAyDkB,kzOAAA,2OCzDlBI,GAAAV,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDAoDsB,olGAAA,4LClCN,+xGAAA,GClBhBK,GAAAX,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,kcAoBqC,ovNAAA,+gBCFnB,s8DAAA,q0CC+BM,0rCAAA,q0CCSN,wkNAAA,MCvCJ,g3CAAA,MCHE,42GAAA,MCWC,+7fAAA,GC3BjBM,GAAAZ,MAAAA,KAAAE,YAAA,SAAAC,EAAAC,EAAAC,EAAAC,8vDAoDqB,6yDAAA,kICjCG,suMAAA,q0CCiDf,q2UAAA,MCzBM,+BAAA,grIC0DQ,SAAAO,48nBAAA","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 229;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@angular/core/@angular lazy\n// module id = 229\n// module chunks = 0","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 245;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src lazy\n// module id = 245\n// module chunks = 0","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as Collections from \"typescript-collections\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppData } from \"./data\";\nexport var AppModels;\n(function (AppModels) {\n    /** Base of all model classes */\n    var Base = (function () {\n        function Base() {\n            this.ID = \"\";\n        }\n        /** Copys data from source (object or JSON) and fill into this objects' properties */\n        Base.prototype.copy = function (source, onCompleted) {\n            AppUtility.copy(source, this, onCompleted);\n        };\n        return Base;\n    }());\n    AppModels.Base = Base;\n    /** Present details information of an account */\n    var Account = (function (_super) {\n        __extends(Account, _super);\n        function Account() {\n            var _this = _super.call(this) || this;\n            _this.ID = \"\";\n            _this.Name = \"\";\n            _this.FirstName = \"\";\n            _this.LastName = \"\";\n            _this.BirthDay = \"\";\n            _this.Gender = \"\";\n            _this.Address = \"\";\n            _this.County = \"\";\n            _this.Province = \"\";\n            _this.Country = \"\";\n            _this.PostalCode = \"\";\n            _this.Email = \"\";\n            _this.Mobile = \"\";\n            _this.Avatar = \"\";\n            _this.Gravatar = \"\";\n            _this.Alias = \"\";\n            _this.Bio = \"\";\n            _this.Notes = \"\";\n            _this.Level = \"\";\n            _this.Reputation = \"\";\n            _this.TotalPoints = 0;\n            _this.RestPoints = 0;\n            _this.TotalRewards = 0;\n            _this.TotalContributions = 0;\n            _this.LastUpdated = new Date();\n            _this.LastSync = new Date();\n            _this.RatingPoints = new Collections.Dictionary();\n            _this.Status = \"\";\n            _this.Joined = new Date();\n            _this.LastAccess = new Date();\n            _this.IsOnline = false;\n            _this.Title = \"\";\n            _this.FullAddress = \"\";\n            _this.Gender = \"NotProvided\";\n            _this.Status = \"Activated\";\n            _this.Level = \"Normal\";\n            _this.Reputation = \"Unknown\";\n            return _this;\n        }\n        Account.deserialize = function (json) {\n            var account = new Account();\n            AppUtility.copy(json, account, function (data) {\n                account.RatingPoints = new Collections.Dictionary();\n                if (AppUtility.isArray(data.RatingPoints)) {\n                    new List(data.RatingPoints).ForEach(function (r) { return account.RatingPoints.setValue(r.Type, RatingPoint.deserialize(r)); });\n                }\n                if (AppUtility.isNotEmpty(account.BirthDay)) {\n                    account.BirthDay = account.BirthDay.replace(/--/g, \"01\").replace(/\\//g, \"-\");\n                }\n                account.FullAddress = account.Address\n                    + (AppUtility.isNotEmpty(account.Province) ? (AppUtility.isNotEmpty(account.Address) ? \", \" : \"\")\n                        + account.County + \", \" + account.Province + \", \" + account.Country : \"\");\n                account.Title = AppUtility.toANSI(account.Name + \" \" + account.FullAddress + \" \" + account.Email + \" \" + account.Mobile).toLowerCase();\n            });\n            return account;\n        };\n        Account.update = function (data) {\n            if (AppUtility.isObject(data, true)) {\n                var account = data instanceof Account\n                    ? data\n                    : Account.deserialize(data);\n                if (AppData.Configuration.session.jwt != null && AppData.Configuration.session.jwt.uid == account.ID) {\n                    account.IsOnline = true;\n                }\n                AppData.Accounts.setValue(account.ID, account);\n            }\n        };\n        return Account;\n    }(Base));\n    AppModels.Account = Account;\n    /** Present details information of a book */\n    var Book = (function (_super) {\n        __extends(Book, _super);\n        /** Initializes a new instance of book */\n        function Book() {\n            var _this = _super.call(this) || this;\n            _this.ID = \"\";\n            _this.Title = \"\";\n            _this.Author = \"\";\n            _this.Translator = \"\";\n            _this.Category = \"\";\n            _this.Original = \"\";\n            _this.Publisher = \"\";\n            _this.Producer = \"\";\n            _this.Language = \"\";\n            _this.Status = \"\";\n            _this.Cover = \"\";\n            _this.Tags = \"\";\n            _this.Source = \"\";\n            _this.SourceUrl = \"\";\n            _this.Contributor = \"\";\n            _this.TotalChapters = 0;\n            _this.Counters = undefined;\n            _this.RatingPoints = undefined;\n            _this.LastUpdated = new Date();\n            _this.TOCs = new Array();\n            _this.Chapters = new Array();\n            _this.Body = \"\";\n            _this.Files = {\n                Epub: {\n                    Size: \"generating...\",\n                    Url: \"\"\n                },\n                Mobi: {\n                    Size: \"generating...\",\n                    Url: \"\"\n                }\n            };\n            _this.ANSITitle = \"\";\n            _this.Language = \"vi\";\n            return _this;\n        }\n        Book.deserialize = function (json, book) {\n            book = book || new Book();\n            AppUtility.copy(json, book, function (data) {\n                book.Counters = new Collections.Dictionary();\n                new List(data.Counters).ForEach(function (c) { return book.Counters.setValue(c.Type, CounterInfo.deserialize(c)); });\n                book.RatingPoints = new Collections.Dictionary();\n                new List(data.RatingPoints).ForEach(function (r) { return book.RatingPoints.setValue(r.Type, RatingPoint.deserialize(r)); });\n                if (book.SourceUrl != \"\" && AppUtility.isNativeApp()) {\n                    book.SourceUrl = \"\";\n                }\n                book.Chapters = book.TotalChapters > 1 && book.Chapters.length < 1\n                    ? new List(book.TOCs).Select(function (t) { return \"\"; }).ToArray()\n                    : book.Chapters;\n                book.ANSITitle = AppUtility.toANSI(book.Title + \" \" + book.Author).toLowerCase();\n            });\n            return book;\n        };\n        Book.update = function (data) {\n            if (AppUtility.isObject(data, true)) {\n                var book = data instanceof Book\n                    ? data\n                    : Book.deserialize(data, AppData.Books.getValue(data.ID));\n                AppData.Books.setValue(book.ID, book);\n            }\n        };\n        return Book;\n    }(Base));\n    AppModels.Book = Book;\n    /** Access privilege */\n    var Privilege = (function () {\n        function Privilege() {\n            this.ServiceName = \"\";\n            this.ObjectName = \"\";\n            this.Role = \"\";\n            this.Actions = [];\n        }\n        Privilege.deserialize = function (json) {\n            var obj = new Privilege();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return Privilege;\n    }());\n    AppModels.Privilege = Privilege;\n    /** Contact information */\n    var ContactInfo = (function () {\n        function ContactInfo() {\n            this.Name = \"\";\n            this.Phone = \"\";\n            this.Email = \"\";\n            this.Address = \"\";\n            this.County = \"\";\n            this.Province = \"\";\n            this.Country = \"\";\n            this.PostalCode = \"\";\n            this.Notes = \"\";\n            this.GPSLocation = \"\";\n        }\n        ContactInfo.deserialize = function (json) {\n            var obj = new ContactInfo();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return ContactInfo;\n    }());\n    AppModels.ContactInfo = ContactInfo;\n    /** Rating information */\n    var RatingPoint = (function () {\n        function RatingPoint() {\n            this.Type = \"\";\n            this.Total = 0;\n            this.Points = 0.0;\n            this.Average = 0.0;\n        }\n        RatingPoint.deserialize = function (json) {\n            var obj = new RatingPoint();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return RatingPoint;\n    }());\n    AppModels.RatingPoint = RatingPoint;\n    /** Bookmark of an e-book */\n    var Bookmark = (function () {\n        function Bookmark() {\n            this.ID = \"\";\n            this.Chapter = 0;\n            this.Position = 0;\n            this.Time = new Date();\n        }\n        Bookmark.deserialize = function (json) {\n            var obj = new Bookmark();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return Bookmark;\n    }());\n    AppModels.Bookmark = Bookmark;\n    /** Based-Counter information */\n    var CounterBase = (function () {\n        function CounterBase(type, total) {\n            this.Type = \"\";\n            this.Total = 0;\n            if (AppUtility.isNotEmpty(type) && total != undefined) {\n                this.Type = type;\n                this.Total = total;\n            }\n        }\n        CounterBase.deserialize = function (json) {\n            var obj = new CounterBase();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return CounterBase;\n    }());\n    AppModels.CounterBase = CounterBase;\n    /** Counter information */\n    var CounterInfo = (function (_super) {\n        __extends(CounterInfo, _super);\n        function CounterInfo() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.LastUpdated = new Date();\n            _this.Month = 0;\n            _this.Week = 0;\n            return _this;\n        }\n        CounterInfo.deserialize = function (json) {\n            var obj = new CounterInfo();\n            AppUtility.copy(json, obj);\n            return obj;\n        };\n        return CounterInfo;\n    }(CounterBase));\n    AppModels.CounterInfo = CounterInfo;\n    /** Based-Statistic information */\n    var StatisticBase = (function () {\n        function StatisticBase() {\n            this.Name = \"\";\n            this.Title = \"\";\n            this.Counters = 0;\n        }\n        StatisticBase.deserialize = function (json) {\n            var statistic = new StatisticBase();\n            AppUtility.copy(json, statistic, function (d) {\n                statistic.Title = AppUtility.toANSI(statistic.Name).toLowerCase();\n            });\n            return statistic;\n        };\n        return StatisticBase;\n    }());\n    AppModels.StatisticBase = StatisticBase;\n    /** Statistic information */\n    var StatisticInfo = (function (_super) {\n        __extends(StatisticInfo, _super);\n        function StatisticInfo() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.FullName = \"\";\n            _this.Children = [];\n            return _this;\n        }\n        StatisticInfo.deserialize = function (json) {\n            var statistic = new StatisticInfo();\n            AppUtility.copy(json, statistic, function (data) {\n                statistic.FullName = statistic.Name;\n                statistic.Title = AppUtility.toANSI(statistic.FullName).toLowerCase();\n                statistic.Children = !AppUtility.isArray(data.Children)\n                    ? []\n                    : new List(data.Children)\n                        .Select(function (c) {\n                        var child = new StatisticInfo();\n                        AppUtility.copy(c, child);\n                        child.FullName = statistic.Name + \" > \" + child.Name;\n                        child.Title = AppUtility.toANSI(child.FullName).toLowerCase();\n                        return child;\n                    })\n                        .ToArray();\n            });\n            return statistic;\n        };\n        StatisticInfo.prototype.toJSON = function () {\n            var json = {\n                Name: this.Name,\n                Counters: this.Counters,\n                Children: []\n            };\n            json.Children = new List(this.Children)\n                .Select(function (c) {\n                return { Name: c.Name, Counters: c.Counters };\n            })\n                .ToArray();\n            return JSON.stringify(json);\n        };\n        return StatisticInfo;\n    }(StatisticBase));\n    AppModels.StatisticInfo = StatisticInfo;\n    /** All available statistics */\n    var Statistics = (function () {\n        function Statistics() {\n            this.Categories = new Array();\n            this.Authors = new Collections.Dictionary();\n            this.Status = new Array();\n        }\n        return Statistics;\n    }());\n    AppModels.Statistics = Statistics;\n})(AppModels || (AppModels = {}));\n//# sourceMappingURL=objects.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/models/objects.ts","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ReflectiveInjector } from \"@angular/core\";\nimport { Http, Headers } from \"@angular/http\";\nimport { BrowserXhr, ConnectionBackend, XHRBackend, XSRFStrategy, CookieXSRFStrategy } from \"@angular/http\";\nimport { BaseRequestOptions, RequestOptions, BaseResponseOptions, ResponseOptions } from \"@angular/http\";\nimport { List } from \"linqts\";\nimport * as Rx from \"rxjs/Rx\";\nimport \"rxjs/add/operator/toPromise\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"./utility\";\nimport { AppCrypto } from \"./crypto\";\nimport { AppData } from \"../models/data\";\nexport var AppAPI;\n(function (AppAPI) {\n    var httpInstance = undefined;\n    /** Sets the instance of the Angular Http service */\n    function setHttp(http) {\n        if (httpInstance == undefined && http != undefined && http != null) {\n            httpInstance = http;\n        }\n    }\n    AppAPI.setHttp = setHttp;\n    /** Gets the instance of the Angular Http service */\n    function getHttp() {\n        if (httpInstance == undefined) {\n            httpInstance = ReflectiveInjector.resolveAndCreate([\n                Http,\n                BrowserXhr,\n                { provide: RequestOptions, useClass: BaseRequestOptions },\n                { provide: ResponseOptions, useClass: BaseResponseOptions },\n                { provide: ConnectionBackend, useClass: XHRBackend },\n                { provide: XSRFStrategy, useFactory: function () { return new CookieXSRFStrategy(); } }\n            ]).get(Http);\n        }\n        return httpInstance;\n    }\n    AppAPI.getHttp = getHttp;\n    /**\n        * Performs a request to APIs with 'GET' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function Get(path, headers) {\n        return getHttp().get(AppData.Configuration.app.uris.apis + path, { headers: getHeaders(headers) });\n    }\n    AppAPI.Get = Get;\n    /**\n        * Performs a request to APIs with 'GET' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function GetAsync(path, headers) {\n        return Get(path, headers).toPromise();\n    }\n    AppAPI.GetAsync = GetAsync;\n    /**\n        * Performs a request to APIs with 'POST' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param body The JSON object that contains the body to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function Post(path, body, headers) {\n        return getHttp().post(AppData.Configuration.app.uris.apis + path, JSON.stringify(body), { headers: getHeaders(headers, true) });\n    }\n    AppAPI.Post = Post;\n    /**\n        * Performs a request to APIs with 'POST' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param body The JSON object that contains the body to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function PostAsync(path, body, headers) {\n        return Post(path, body, headers).toPromise();\n    }\n    AppAPI.PostAsync = PostAsync;\n    /**\n        * Performs a request to APIs with 'PUT' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param body The JSON object that contains the body to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function Put(path, body, headers) {\n        return getHttp().put(AppData.Configuration.app.uris.apis + path, JSON.stringify(body), { headers: getHeaders(headers, true) });\n    }\n    AppAPI.Put = Put;\n    /**\n        * Performs a request to APIs with 'PUT' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param body The JSON object that contains the body to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function PutAsync(path, body, headers) {\n        return Put(path, body, headers).toPromise();\n    }\n    AppAPI.PutAsync = PutAsync;\n    /**\n        * Performs a request to APIs with 'DELETE' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function Delete(path, headers) {\n        return getHttp().delete(AppData.Configuration.app.uris.apis + path, { headers: getHeaders(headers, false) });\n    }\n    AppAPI.Delete = Delete;\n    /**\n        * Performs a request to APIs with 'DELETE' method\n        * @param path Path of the end-point API's uri to perform the request\n        * @param headers Additional headers to perform the request\n    */\n    function DeleteAsync(path, headers) {\n        return Delete(path, headers).toPromise();\n    }\n    AppAPI.DeleteAsync = DeleteAsync;\n    /** Gets the headers for making requests to APIs */\n    function getHeaders(additional, addContentType) {\n        var headers = new Headers();\n        if (addContentType) {\n            headers.append(\"content-type\", \"application/json\");\n        }\n        var authHeaders = getAuthHeaders();\n        for (var name in authHeaders) {\n            headers.append(name, authHeaders[name]);\n        }\n        if (additional != undefined) {\n            if (AppUtility.isArray(additional)) {\n                new List(additional).ForEach(function (h) {\n                    if (AppUtility.isObject(h, true) && AppUtility.isNotEmpty(h.name) && AppUtility.isNotEmpty(h.value)) {\n                        headers.append(h.name, h.value);\n                    }\n                });\n            }\n            else if (AppUtility.isObject(additional, true)) {\n                for (var name in additional) {\n                    headers.append(name, additional[name]);\n                }\n            }\n        }\n        return headers;\n    }\n    AppAPI.getHeaders = getHeaders;\n    /** Gets the authenticated headers (JSON) for making requests to APIs */\n    function getAuthHeaders(addToken, addAppInfo, addDeviceID) {\n        if (addToken === void 0) { addToken = true; }\n        if (addAppInfo === void 0) { addAppInfo = true; }\n        if (addDeviceID === void 0) { addDeviceID = true; }\n        var headers = {};\n        if (addToken\n            && AppUtility.isObject(AppData.Configuration.session.jwt, true)\n            && AppUtility.isObject(AppData.Configuration.session.keys, true)\n            && AppUtility.isNotEmpty(AppData.Configuration.session.keys.jwt)) {\n            headers[\"x-app-token\"] = AppCrypto.jwtEncode(AppData.Configuration.session.jwt, AppData.Configuration.session.keys.jwt);\n        }\n        if (addAppInfo) {\n            headers[\"x-app-name\"] = AppData.Configuration.app.name;\n            headers[\"x-app-platform\"] = AppData.Configuration.app.platform;\n        }\n        if (addDeviceID && AppUtility.isNotEmpty(AppData.Configuration.session.device)) {\n            headers[\"x-device-id\"] = AppData.Configuration.session.device;\n        }\n        return headers;\n    }\n    AppAPI.getAuthHeaders = getAuthHeaders;\n    /** Completer custom searching services */\n    var CompleterCustomSearch = (function (_super) {\n        __extends(CompleterCustomSearch, _super);\n        function CompleterCustomSearch(buildRequest, doConvert, doCancel) {\n            var _this = _super.call(this) || this;\n            _this.buildRequest = buildRequest;\n            _this.doConvert = doConvert;\n            _this.doCancel = doCancel;\n            _this.subscription = undefined;\n            return _this;\n        }\n        CompleterCustomSearch.prototype.search = function (term) {\n            var _this = this;\n            this.subscription = Get(this.buildRequest(term))\n                .map(function (response) {\n                _this.next(_this.doConvert(response.json()));\n            })\n                .subscribe();\n        };\n        CompleterCustomSearch.prototype.cancel = function () {\n            if (this.doCancel != undefined) {\n                this.doCancel();\n            }\n            if (this.subscription) {\n                this.subscription.unsubscribe();\n            }\n        };\n        return CompleterCustomSearch;\n    }(Rx.Subject));\n    AppAPI.CompleterCustomSearch = CompleterCustomSearch;\n})(AppAPI || (AppAPI = {}));\n//# sourceMappingURL=api.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/api.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { Platform } from \"ionic-angular\";\nimport { Storage } from \"@ionic/storage\";\nimport { Device } from \"@ionic-native/device\";\nimport { List } from \"linqts\";\nimport * as Collections from \"typescript-collections\";\nimport \"rxjs/add/operator/toPromise\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppCrypto } from \"../helpers/crypto\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppRTU } from \"../helpers/rtu\";\nimport { AppData } from \"../models/data\";\nimport { AppModels } from \"../models/objects\";\nvar ConfigurationService = (function () {\n    function ConfigurationService(http, platform, device, storage) {\n        var _this = this;\n        this.http = http;\n        this.platform = platform;\n        this.device = device;\n        this.storage = storage;\n        AppAPI.setHttp(this.http);\n        AppRTU.register(\"Scheduler\", function (message) { return _this.sendBookmarks(); });\n    }\n    /** Prepare the working environments of the app */\n    ConfigurationService.prototype.prepare = function (onCompleted) {\n        // app mode\n        AppData.Configuration.app.mode = this.platform.is(\"cordova\") && this.device.platform != \"browser\" ? \"NTA\" : \"PWA\";\n        // native app\n        if (AppUtility.isNativeApp()) {\n            AppData.Configuration.app.platform = this.device.platform;\n            AppData.Configuration.session.device = this.device.uuid;\n        }\n        else {\n            AppData.Configuration.app.host = window.location.hostname;\n            if (AppUtility.indexOf(AppData.Configuration.app.host, \".\") > 0) {\n                var host = AppUtility.toArray(AppData.Configuration.app.host, \".\");\n                AppData.Configuration.app.host = host[host.length - 2] + \".\" + host[host.length - 1];\n                AppData.Configuration.app.name = AppData.Configuration.app.host;\n            }\n            AppData.Configuration.app.platform = this.device.platform;\n            if (!AppUtility.isNotEmpty(AppData.Configuration.app.platform) || AppData.Configuration.app.platform == \"browser\") {\n                AppData.Configuration.app.platform =\n                    /iPhone|iPad|iPod|Windows Phone|Android|BlackBerry|BB10|IEMobile|webOS|Opera Mini/i.test(window.navigator.userAgent)\n                        ? /iPhone|iPad|iPod/i.test(window.navigator.userAgent)\n                            ? \"iOS\"\n                            : /Windows Phone/i.test(window.navigator.userAgent)\n                                ? \"Windows Phone\"\n                                : /Android/i.test(window.navigator.userAgent)\n                                    ? \"Android\"\n                                    : /BlackBerry|BB10/i.test(window.navigator.userAgent)\n                                        ? \"BlackBerry\"\n                                        : \"Mobile\"\n                        : \"Desktop\";\n            }\n            // add mode when working with progressive web app (PWA)\n            if (AppData.Configuration.app.mode == \"PWA\") {\n                AppData.Configuration.app.platform += \" \" + AppData.Configuration.app.mode;\n            }\n            // refer\n            var refer = this.platform.getQueryParam(\"refer\");\n            if (AppUtility.isNotEmpty(refer)) {\n                refer = AppUtility.getQueryParamJson(refer);\n                AppData.Configuration.app.refer = {\n                    id: AppUtility.isNotEmpty(refer.id) ? refer.id : \"\",\n                    section: AppUtility.isNotEmpty(refer.section) ? refer.section : \"\"\n                };\n            }\n        }\n        onCompleted != undefined && onCompleted(AppData.Configuration);\n    };\n    /** Initializes the configuration settings of the app */\n    ConfigurationService.prototype.initializeAsync = function (onNext, onError, noInitializeSession) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // prepare environment\n                        AppData.Configuration.app.mode == \"\" && this.prepare();\n                        if (!(AppData.Configuration.session.jwt == null || AppData.Configuration.session.keys == null)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.loadSessionAsync()];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        if (!AppUtility.isFalse(noInitializeSession)) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.initializeSessionAsync(onNext, onError)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        onNext != undefined && onNext();\n                        _a.label = 5;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Initializes the session with REST API */\n    ConfigurationService.prototype.initializeSessionAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var response, data_1, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        return [4 /*yield*/, AppAPI.GetAsync(\"users/session\")];\n                    case 1:\n                        response = _a.sent();\n                        data_1 = response.json();\n                        if (!(data_1.Status == \"OK\")) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.updateSessionAsync(data_1.Data, function () {\n                                var isAuthenticated = _this.isAuthenticated() && AppUtility.isObject(AppData.Configuration.session.account, true);\n                                AppData.Configuration.session.account = isAuthenticated\n                                    ? AppData.Configuration.session.account\n                                    : _this.getAccount(true);\n                                AppEvents.broadcast(isAuthenticated ? \"SessionIsRegistered\" : \"SessionIsInitialized\", AppData.Configuration.session);\n                                onNext != undefined && onNext(data_1);\n                            })];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        console.error(\"[Configuration]: Error occurred while initializing the session\");\n                        AppUtility.isObject(data_1.Error, true) && console.log(\"[\" + data_1.Error.Type + \"]: \" + data_1.Error.Message);\n                        onError != undefined && onError(data_1);\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_1 = _a.sent();\n                        console.error(\"[Configuration]: Error occurred while initializing the session\", e_1);\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Registers the initialized session (anonymous) with REST API */\n    ConfigurationService.prototype.registerSessionAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, data, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        path = \"users/session\"\n                            + \"?register=\" + AppData.Configuration.session.id;\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 3];\n                        AppData.Configuration.session.account = this.getAccount(true);\n                        return [4 /*yield*/, this.saveSessionAsync(function () {\n                                AppEvents.broadcast(\"SessionIsRegistered\", AppData.Configuration.session);\n                            })];\n                    case 2:\n                        _a.sent();\n                        onNext != undefined && onNext(data);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        console.error(\"[Configuration]: Error occurred while registering the session\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_2 = _a.sent();\n                        console.error(\"[Configuration]: Error occurred while registering the session\", e_2);\n                        onError != undefined && onError(e_2);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Updates the session and stores into storage */\n    ConfigurationService.prototype.updateSessionAsync = function (session, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (AppUtility.isNotEmpty(session.ID)) {\n                            AppData.Configuration.session.id = session.ID;\n                        }\n                        if (AppUtility.isNotEmpty(session.DeviceID)) {\n                            AppData.Configuration.session.device = session.DeviceID;\n                        }\n                        if (AppUtility.isObject(session.Keys, true)) {\n                            AppData.Configuration.session.keys = {\n                                jwt: session.Keys.JWT,\n                                aes: {\n                                    key: session.Keys.AES.Key,\n                                    iv: session.Keys.AES.IV\n                                },\n                                rsa: {\n                                    exponent: session.Keys.RSA.Exponent,\n                                    modulus: session.Keys.RSA.Modulus\n                                }\n                            };\n                            AppCrypto.initKeys(AppData.Configuration.session.keys);\n                        }\n                        if (AppUtility.isNotEmpty(session.JWT)) {\n                            AppData.Configuration.session.jwt = AppCrypto.jwtDecode(session.JWT, AppUtility.isObject(AppData.Configuration.session.keys, true) ? AppData.Configuration.session.keys.jwt : AppData.Configuration.app.name);\n                        }\n                        return [4 /*yield*/, this.saveSessionAsync(onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Loads the session from storage */\n    ConfigurationService.prototype.loadSessionAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.get(\"VIEApps-Session\")];\n                    case 1:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data) && data != \"{}\") {\n                            AppData.Configuration.session = JSON.parse(data);\n                            if (AppData.Configuration.session.account != null && AppData.Configuration.session.account.profile != null) {\n                                AppData.Configuration.session.account.profile == AppModels.Account.deserialize(AppData.Configuration.session.account.profile);\n                            }\n                            AppEvents.broadcast(\"SessionIsLoaded\", AppData.Configuration.session);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_3 = _a.sent();\n                        console.error(\"[Configuration]: Error occurred while loading the saved/offline session\", e_3);\n                        return [3 /*break*/, 3];\n                    case 3:\n                        onCompleted != undefined && onCompleted();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Saves the session into storage */\n    ConfigurationService.prototype.saveSessionAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.set(\"VIEApps-Session\", JSON.stringify(AppUtility.clone(AppData.Configuration.session, [\"captcha\"])))];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_4 = _a.sent();\n                        console.error(\"[Configuration]: Error occurred while saving/storing the session\", e_4);\n                        return [3 /*break*/, 3];\n                    case 3:\n                        onCompleted != undefined && onCompleted();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Deletes the session from storage */\n    ConfigurationService.prototype.deleteSessionAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        AppData.Configuration.session.id = null;\n                        AppData.Configuration.session.jwt = null;\n                        AppData.Configuration.session.keys = null;\n                        AppData.Configuration.session.account = this.getAccount(true);\n                        return [4 /*yield*/, this.storage.remove(\"VIEApps-Session\")];\n                    case 1:\n                        _a.sent();\n                        onCompleted != undefined && onCompleted();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Gets the information of the current/default account */\n    ConfigurationService.prototype.getAccount = function (getDefault) {\n        return AppUtility.isTrue(getDefault) || AppData.Configuration.session.account == null\n            ? {\n                id: null,\n                roles: null,\n                privileges: null,\n                status: null,\n                profile: null,\n                facebook: {\n                    id: null,\n                    name: null,\n                    pictureUrl: null,\n                    profileUrl: null\n                }\n            }\n            : AppData.Configuration.session.account;\n    };\n    /** Prepares account information */\n    ConfigurationService.prototype.prepareAccount = function (data) {\n        var account = {\n            Roles: undefined,\n            Privileges: undefined,\n            Status: undefined\n        };\n        if (data.Roles && AppUtility.isArray(data.Roles)) {\n            account.Roles = new List(data.Roles)\n                .Select(function (r) { return r.trim(); })\n                .Distinct()\n                .ToArray();\n        }\n        if (data.Privileges && AppUtility.isArray(data.Privileges)) {\n            account.Privileges = new List(data.Privileges)\n                .Select(function (p) { return AppModels.Privilege.deserialize(p); })\n                .ToArray();\n        }\n        if (AppUtility.isNotEmpty(data.Status)) {\n            account.Status = data.Status;\n        }\n        return account;\n    };\n    /**\n     * Updates information of the account\n     * @param data\n     * @param onCompleted\n     */\n    ConfigurationService.prototype.updateAccount = function (data, onCompleted) {\n        var info = this.prepareAccount(data);\n        if (info.Roles) {\n            AppData.Configuration.session.account.roles = info.Roles;\n        }\n        if (info.Privileges) {\n            AppData.Configuration.session.account.privileges = info.Privileges;\n        }\n        if (info.Status) {\n            AppData.Configuration.session.account.status = info.Status;\n        }\n        onCompleted != undefined && onCompleted();\n    };\n    /**\n     * Call the service to patch information of the account\n     * @param onNext\n     * @param defer\n     */\n    ConfigurationService.prototype.patchAccount = function (onNext, defer) {\n        var _this = this;\n        AppUtility.setTimeout(function () {\n            AppRTU.send({\n                ServiceName: \"users\",\n                ObjectName: \"account\",\n                Verb: \"GET\",\n                Query: {\n                    \"x-status\": \"\"\n                },\n                Extra: {\n                    \"x-status\": \"\"\n                }\n            }, function () {\n                onNext != undefined && onNext();\n            }, function (observable) {\n                observable.map(function (response) { return response.json(); }).subscribe(function (data) {\n                    _this.updateAccount(data.Data);\n                    onNext != undefined && onNext();\n                }, function (error) {\n                    console.error(\"[Configuration]: Error occurred while patching an account\", error);\n                });\n            });\n        }, defer || 345);\n    };\n    /** Loads the reading options from storage */\n    ConfigurationService.prototype.loadOptionsAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, e_5;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.get(\"VIEApps-Reading-Options\")];\n                    case 1:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data) && data != \"{}\") {\n                            AppData.Configuration.reading.options = JSON.parse(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_5 = _a.sent();\n                        console.error(\"[Books]: Error occurred while loading the reading options\", e_5);\n                        return [3 /*break*/, 3];\n                    case 3:\n                        onCompleted != undefined && onCompleted(AppData.Configuration.reading.options);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Saves the reading options into storage */\n    ConfigurationService.prototype.saveOptionsAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_6;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.set(\"VIEApps-Reading-Options\", JSON.stringify(AppData.Configuration.reading.options))];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_6 = _a.sent();\n                        console.error(\"[Books]: Error occurred while saving the reading options into storage\", e_6);\n                        return [3 /*break*/, 3];\n                    case 3:\n                        onCompleted != undefined && onCompleted(AppData.Configuration.reading.options);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Loads the bookmarks from storage */\n    ConfigurationService.prototype.loadBookmarksAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, e_7;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        AppData.Configuration.reading.bookmarks = new Collections.Dictionary();\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.storage.get(\"VIEApps-Bookmarks\")];\n                    case 2:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data) && data != \"{}\" && data != \"[]\") {\n                            new List(JSON.parse(data)).ForEach(function (b) {\n                                var bookmark = AppModels.Bookmark.deserialize(b);\n                                AppData.Configuration.reading.bookmarks.setValue(bookmark.ID, bookmark);\n                            });\n                            onCompleted != undefined && onCompleted();\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_7 = _a.sent();\n                        console.error(\"[Books]: Error occurred while loading the bookmarks\", e_7);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Saves the bookmarks into storage */\n    ConfigurationService.prototype.saveBookmarksAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var bookmarks, e_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        bookmarks = new List(AppData.Configuration.reading.bookmarks.values())\n                            .OrderByDescending(function (b) { return b.Time; })\n                            .Take(30)\n                            .ToArray();\n                        return [4 /*yield*/, this.storage.set(\"VIEApps-Bookmarks\", JSON.stringify(bookmarks))];\n                    case 1:\n                        _a.sent();\n                        onCompleted != undefined && onCompleted();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_8 = _a.sent();\n                        console.error(\"[Books]: Error occurred while saving the bookmarks into storage\", e_8);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Updates a bookmark */\n    ConfigurationService.prototype.updateBookmarksAsync = function (id, chapter, offset, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var bookmark;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        bookmark = new AppModels.Bookmark();\n                        bookmark.ID = id;\n                        bookmark.Chapter = chapter;\n                        bookmark.Position = offset;\n                        AppData.Configuration.reading.bookmarks.setValue(bookmark.ID, bookmark);\n                        return [4 /*yield*/, this.saveBookmarksAsync(onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Sends the request to get bookmarks from APIs */\n    ConfigurationService.prototype.getBookmarks = function (onCompleted) {\n        AppRTU.send({\n            ServiceName: \"books\",\n            ObjectName: \"bookmarks\",\n            Verb: \"GET\"\n        });\n        onCompleted != undefined && onCompleted();\n    };\n    /** Syncs the bookmarks with APIs */\n    ConfigurationService.prototype.sendBookmarks = function (onCompleted) {\n        if (this.isAuthenticated()) {\n            AppRTU.send({\n                ServiceName: \"books\",\n                ObjectName: \"bookmarks\",\n                Verb: \"POST\",\n                Body: JSON.stringify(new List(AppData.Configuration.reading.bookmarks.values())\n                    .OrderByDescending(function (b) { return b.Time; })\n                    .Take(30)\n                    .ToArray())\n            });\n            onCompleted != undefined && onCompleted();\n        }\n    };\n    /** Merges the bookmarks with APIs */\n    ConfigurationService.prototype.syncBookmarks = function (data, onCompleted) {\n        var _this = this;\n        if (AppData.Configuration.session.account && AppData.Configuration.session.account.profile) {\n            AppData.Configuration.session.account.profile.LastSync = new Date();\n        }\n        if (AppUtility.isTrue(data.Sync)) {\n            AppData.Configuration.reading.bookmarks.clear();\n        }\n        new List(data.Objects)\n            .ForEach(function (b) {\n            var bookmark = AppModels.Bookmark.deserialize(b);\n            if (!AppData.Configuration.reading.bookmarks.containsKey(bookmark.ID)) {\n                AppData.Configuration.reading.bookmarks.setValue(bookmark.ID, bookmark);\n            }\n            else if (bookmark.Time > AppData.Configuration.reading.bookmarks.getValue(bookmark.ID).Time) {\n                AppData.Configuration.reading.bookmarks.setValue(bookmark.ID, bookmark);\n            }\n        });\n        new List(AppData.Configuration.reading.bookmarks.values())\n            .ForEach(function (b, i) {\n            AppUtility.setTimeout(function () {\n                if (!AppData.Books.getValue(b.ID)) {\n                    AppRTU.send({\n                        ServiceName: \"books\",\n                        ObjectName: \"book\",\n                        Verb: \"GET\",\n                        Query: {\n                            \"object-identity\": b.ID\n                        }\n                    });\n                }\n            }, 456 + (i * 10));\n        });\n        AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        AppEvents.broadcast(\"BookmarksAreUpdated\");\n                        return [4 /*yield*/, this.saveBookmarksAsync(onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    /** Sends the request to delete a bookmark from APIs */\n    ConfigurationService.prototype.deleteBookmark = function (id, onCompleted) {\n        AppRTU.send({\n            ServiceName: \"books\",\n            ObjectName: \"bookmarks\",\n            Verb: \"DELETE\",\n            Query: {\n                \"object-identity\": id\n            }\n        });\n        AppData.Configuration.reading.bookmarks.remove(id);\n        onCompleted != undefined && onCompleted();\n    };\n    /** Gets the state that determines the app is ready to go */\n    ConfigurationService.prototype.isReady = function () {\n        return AppUtility.isObject(AppData.Configuration.session.keys, true) && AppUtility.isObject(AppData.Configuration.session.jwt, true);\n    };\n    /** Gets the state that determines the current account is authenticated or not */\n    ConfigurationService.prototype.isAuthenticated = function () {\n        return AppUtility.isObject(AppData.Configuration.session.jwt, true) && AppUtility.isNotEmpty(AppData.Configuration.session.jwt.uid);\n    };\n    return ConfigurationService;\n}());\nConfigurationService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object, typeof (_b = typeof Platform !== \"undefined\" && Platform) === \"function\" && _b || Object, typeof (_c = typeof Device !== \"undefined\" && Device) === \"function\" && _c || Object, typeof (_d = typeof Storage !== \"undefined\" && Storage) === \"function\" && _d || Object])\n], ConfigurationService);\nexport { ConfigurationService };\nvar _a, _b, _c, _d;\n//# sourceMappingURL=configuration.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/configuration.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { List } from \"linqts\";\nimport \"rxjs/add/operator/toPromise\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppCrypto } from \"../helpers/crypto\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppRTU } from \"../helpers/rtu\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppData } from \"../models/data\";\nimport { AppModels } from \"../models/objects\";\nimport { ConfigurationService } from \"./configuration\";\nvar AuthenticationService = (function () {\n    function AuthenticationService(http, configSvc) {\n        var _this = this;\n        this.http = http;\n        this.configSvc = configSvc;\n        AppAPI.setHttp(this.http);\n        AppRTU.register(\"Users\", function (message) { return _this.processRTU(message); });\n    }\n    /** Checks to see the account is administrator or not */\n    AuthenticationService.prototype.isSystemAdministrator = function (account) {\n        account = account || this.configSvc.getAccount();\n        return account && AppUtility.isNotEmpty(account.id) && AppUtility.isArray(account.roles)\n            && new List(account.roles).FirstOrDefault(function (r) { return r == \"SystemAdministrator\"; }) != undefined;\n    };\n    /** Checks to see the account is has a specific role of the app */\n    AuthenticationService.prototype.isInAppRole = function (objectName, role, privileges) {\n        objectName = AppUtility.isNotEmpty(objectName) ? objectName : \"\";\n        role = AppUtility.isNotEmpty(role) ? role : \"Viewer\";\n        privileges = privileges || this.configSvc.getAccount().privileges;\n        var privilege = new List(privileges).FirstOrDefault(function (p) { return p.ServiceName == \"books\" && p.ObjectName == objectName; });\n        return privilege != undefined && privilege.Role == role;\n    };\n    /** Registers a captcha with REST API */\n    AuthenticationService.prototype.registerCaptchaAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, data, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/captcha\"\n                            + \"?register=\" + AppData.Configuration.session.id;\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            AppData.Configuration.session.captcha = {\n                                code: data.Data.Code,\n                                uri: data.Data.Uri\n                            };\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while registering a captcha\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_1 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while registering a session captcha\", e_1);\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Registers an account with APIs */\n    AuthenticationService.prototype.registerAccountAsync = function (info, captcha, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var body, path, response, data, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        body = AppUtility.clone(info);\n                        delete body.ConfirmEmail;\n                        delete body.ConfirmPassword;\n                        body.ReferID = AppData.Configuration.app.refer.id;\n                        body.ReferSection = AppData.Configuration.app.refer.section;\n                        body.Email = AppCrypto.rsaEncrypt(body.Email);\n                        body.Password = AppCrypto.rsaEncrypt(body.Password);\n                        body.Captcha = AppCrypto.aesEncrypt(JSON.stringify({ Registered: AppData.Configuration.session.captcha.code, Input: captcha }));\n                        path = \"users/account\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name)\n                            + \"&uri=\" + AppCrypto.urlEncode(AppUtility.getUri() + \"#?prego=activate&mode={mode}&code={code}\");\n                        return [4 /*yield*/, AppAPI.PostAsync(path, body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while registering an account\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_2 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while registering new account\", e_2);\n                        onError != undefined && onError(e_2);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Signs an account in with APIs */\n    AuthenticationService.prototype.signInAsync = function (email, password, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var body, response, data, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        body = {\n                            Email: AppCrypto.rsaEncrypt(email),\n                            Password: AppCrypto.rsaEncrypt(password)\n                        };\n                        return [4 /*yield*/, AppAPI.PostAsync(\"users/session\", body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.configSvc.updateSessionAsync(data.Data)];\n                    case 2:\n                        _a.sent();\n                        if (AppData.Configuration.session.account == null) {\n                            AppData.Configuration.session.account = this.configSvc.getAccount(true);\n                        }\n                        AppData.Configuration.session.account.id = AppData.Configuration.session.jwt.uid;\n                        console.info(\"[Authentication]: Sign-in successful\", AppUtility.isDebug() ? AppData.Configuration.session : \"\");\n                        AppEvents.broadcast(\"SessionIsRegistered\");\n                        this.patchSession(function () {\n                            _this.configSvc.patchAccount(function () {\n                                _this.getProfile();\n                                _this.configSvc.getBookmarks();\n                            });\n                        }, 123);\n                        onNext != undefined && onNext(data);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        console.error(\"[Authentication]: Error occurred while signing-in\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_3 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while signing-in\", e_3);\n                        onError != undefined && onError(e_3);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Signs an account out with REST API */\n    AuthenticationService.prototype.signOutAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var response, data, e_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 6, , 7]);\n                        return [4 /*yield*/, AppAPI.DeleteAsync(\"users/session\")];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.configSvc.updateSessionAsync(data.Data)];\n                    case 2:\n                        _a.sent();\n                        AppEvents.broadcast(\"AccountIsUpdated\");\n                        return [4 /*yield*/, this.configSvc.registerSessionAsync(function () {\n                                console.info(\"[Authentication]: Sign-out successful\", AppUtility.isDebug() ? AppData.Configuration.session : \"\");\n                                _this.patchSession();\n                                onNext != undefined && onNext(AppData.Configuration.session);\n                            }, onError)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        console.error(\"[Authentication]: Error occurred while signing-out\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        e_4 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while signing-out\", e_4);\n                        onError != undefined && onError(e_4);\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AuthenticationService.prototype.patchSession = function (onNext, defer) {\n        AppUtility.setTimeout(function () {\n            AppRTU.send({\n                ServiceName: \"users\",\n                ObjectName: \"session\",\n                Verb: \"PATCH\",\n                Extra: {\n                    \"x-session\": AppData.Configuration.session.id\n                }\n            }, function () {\n                onNext != undefined && onNext();\n            }, function () {\n                onNext != undefined && onNext();\n            });\n        }, defer || 456);\n    };\n    /** Get profile information */\n    AuthenticationService.prototype.getProfile = function (id, onCompleted) {\n        var _this = this;\n        var request = {\n            ServiceName: \"users\",\n            ObjectName: \"profile\",\n            Verb: \"GET\",\n            Query: {\n                \"related-service\": \"books\",\n                \"language\": \"vi-VN\",\n                \"host\": (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name)\n            }\n        };\n        if (AppUtility.isNotEmpty(id)) {\n            request.Query[\"object-identity\"] = id;\n        }\n        AppRTU.send(request, function () {\n            onCompleted != undefined && onCompleted();\n        }, function (observable) {\n            observable.map(function (response) { return response.json(); }).subscribe(function (data) {\n                if (data.Status == \"OK\") {\n                    _this.updateProfileAsync(data.Data, onCompleted);\n                }\n                else {\n                    console.error(\"[Authentication]: Error occurred while fetching account profile\");\n                    AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                }\n            }, function (error) {\n                console.error(\"[Authentication]: Error occurred while fetching a profile\", error);\n            });\n        });\n    };\n    /** Get profile information of an account */\n    AuthenticationService.prototype.getProfileAsync = function (dontUseRTU, id, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var useRTU, path, response, data, e_5;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        useRTU = AppUtility.isFalse(dontUseRTU) && id == undefined && AppRTU.isReady();\n                        if (!useRTU) return [3 /*break*/, 1];\n                        this.getProfile(id, onCompleted);\n                        AppUtility.setTimeout(function () {\n                            AppData.Configuration.session.account != null\n                                && (AppData.Configuration.session.account.profile == null || !(AppData.Configuration.session.account.profile instanceof AppModels.Account))\n                                && _this.getProfileAsync(true, id, onCompleted);\n                        }, 1234);\n                        return [3 /*break*/, 4];\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        path = \"users/profile\" + (AppUtility.isNotEmpty(id) ? \"/\" + id : \"\")\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            this.updateProfileAsync(data.Data, onCompleted);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while fetching account profile\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_5 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while fetching account profile\", e_5);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Update the information of an account profile */\n    AuthenticationService.prototype.updateProfileAsync = function (profile, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // update profile into collection of accounts\n                        AppModels.Account.update(profile);\n                        if (!(AppData.Configuration.session.jwt != null && AppData.Configuration.session.jwt.uid == profile.ID)) return [3 /*break*/, 2];\n                        AppData.Configuration.session.account.id = profile.ID;\n                        AppData.Configuration.session.account.profile = AppData.Accounts.getValue(profile.ID);\n                        return [4 /*yield*/, this.storeProfileAsync(function () {\n                                AppUtility.isDebug() && console.info(\"[Authentication]: Account profile is updated\", AppData.Configuration.session.account);\n                                onCompleted != undefined && onCompleted(AppData.Configuration.session.account);\n                            })];\n                    case 1:\n                        _a.sent();\n                        AppData.Configuration.facebook.token != null && AppData.Configuration.facebook.id != null && this.getFacebookProfile();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        onCompleted != undefined && onCompleted(profile);\n                        _a.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Store the information of current account profile into storage */\n    AuthenticationService.prototype.storeProfileAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.configSvc.saveSessionAsync()];\n                    case 1:\n                        _a.sent();\n                        AppEvents.broadcast(\"AccountIsUpdated\");\n                        onCompleted != undefined && onCompleted(AppData.Configuration.session);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Perform save profile information (with REST API) */\n    AuthenticationService.prototype.saveProfileAsync = function (info, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, data, e_6;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        path = \"users/profile\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\";\n                        return [4 /*yield*/, AppAPI.PutAsync(path, info)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.updateProfileAsync(data.Data, onNext)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        console.error(\"[Authentication]: Error occurred while updating account profile\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_6 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while updating account profile\", e_6);\n                        onError != undefined && onError(e_6);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Watch the connection of Facebook */\n    AuthenticationService.prototype.watchFacebookConnect = function () {\n        var _this = this;\n        FB.Event.subscribe(\"auth.authResponseChange\", function (response) {\n            if (response.status === \"connected\") {\n                AppData.Configuration.facebook.token = response.authResponse.accessToken;\n                AppData.Configuration.facebook.id = response.authResponse.userID;\n                console.info(\"[Authentication]: Facebook is connected\", !AppUtility.isDebug() ? \"\" : AppData.Configuration.facebook);\n                if (AppData.Configuration.session.account.facebook != null) {\n                    _this.getFacebookProfile();\n                }\n            }\n            else {\n                AppData.Configuration.facebook.token = null;\n            }\n        });\n    };\n    /** Get the information of Facebook profile */\n    AuthenticationService.prototype.getFacebookProfile = function () {\n        var _this = this;\n        FB.api(\"/\" + AppData.Configuration.facebook.version + \"/me?fields=id,name,picture&access_token=\" + AppData.Configuration.facebook.token, function (response) {\n            AppData.Configuration.session.account.facebook = {\n                id: response.id,\n                name: response.name,\n                profileUrl: \"https://www.facebook.com/app_scoped_user_id/\" + response.id,\n                pictureUrl: undefined\n            };\n            _this.storeProfileAsync(function () {\n                console.info(\"[Authentication]: Account profile is updated with information of Facebook profile\", !AppUtility.isDebug() ? \"\" : AppData.Configuration.session.account);\n            });\n            _this.getFacebookAvatar();\n        });\n    };\n    /** Get the avatar picture (large picture) of Facebook profile */\n    AuthenticationService.prototype.getFacebookAvatar = function () {\n        var _this = this;\n        if (AppData.Configuration.session.account.facebook != null && AppData.Configuration.session.account.facebook.id != null && AppData.Configuration.session.jwt != null && AppData.Configuration.session.jwt.oauths != null\n            && AppData.Configuration.session.jwt.oauths[\"facebook\"] && AppData.Configuration.session.jwt.oauths[\"facebook\"] == AppData.Configuration.session.account.facebook.id) {\n            FB.api(\"/\" + AppData.Configuration.facebook.version + \"/\" + AppData.Configuration.session.account.facebook.id + \"/picture?type=large&redirect=false&access_token=\" + AppData.Configuration.facebook.token, function (response) {\n                AppData.Configuration.session.account.facebook.pictureUrl = response.data.url;\n                _this.storeProfileAsync(function () {\n                    console.info(\"[Authentication]: Account is updated with information of Facebook profile (large profile picture)\", !AppUtility.isDebug() ? \"\" : response);\n                });\n            });\n        }\n    };\n    // privileges\n    AuthenticationService.prototype.getPrivilegesAsync = function (id, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, data, e_7;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/\" + id\n                            + \"?related-service=books\"\n                            + \"&languague=vi-VN\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while fetching privileges of an user\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_7 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while fetching privileges of an user\", e_7);\n                        onError != undefined && onError(e_7);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AuthenticationService.prototype.setPrivilegesAsync = function (id, privileges, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, data, e_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/\" + id\n                            + \"?related-service=books\"\n                            + \"&languague=vi-VN\";\n                        return [4 /*yield*/, AppAPI.PutAsync(path, privileges)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while updating privileges of an user\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_8 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while updating privileges of an user\", e_8);\n                        onError != undefined && onError(e_8);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // invitation\n    AuthenticationService.prototype.sendInvitationAsync = function (name, email, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, body, response, data, e_9;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/invite\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name)\n                            + \"&uri=\" + AppCrypto.urlEncode(AppUtility.getUri() + \"#?prego=activate&mode={mode}&code={code}\");\n                        body = {\n                            Name: name,\n                            Email: AppCrypto.rsaEncrypt(email),\n                            Campaign: \"Books-Email-Invitation\"\n                        };\n                        return [4 /*yield*/, AppAPI.PostAsync(path, body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while sending an invitation\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_9 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while sending an invitation\", e_9);\n                        onError != undefined && onError(e_9);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** Send the request to reset password */\n    AuthenticationService.prototype.resetPasswordAsync = function (email, captcha, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, body, response, data, e_10;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/reset\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name)\n                            + \"&uri=\" + AppCrypto.urlEncode(AppUtility.getUri() + \"#?prego=activate&mode={mode}&code={code}\");\n                        body = {\n                            Email: AppCrypto.rsaEncrypt(email),\n                            Captcha: AppCrypto.aesEncrypt(JSON.stringify({ Registered: AppData.Configuration.session.captcha.code, Input: captcha }))\n                        };\n                        return [4 /*yield*/, AppAPI.PutAsync(path, body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            console.info(\"[Authentication]: Send the request to reset password successful\");\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while sending a request to reset password\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_10 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while sending a request to reset password\", e_10);\n                        onError != undefined && onError(e_10);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // update password\n    AuthenticationService.prototype.updatePasswordAsync = function (oldPassword, password, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, body, response, data, e_11;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/password\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name);\n                        body = {\n                            OldPassword: AppCrypto.rsaEncrypt(oldPassword),\n                            Password: AppCrypto.rsaEncrypt(password)\n                        };\n                        return [4 /*yield*/, AppAPI.PutAsync(path, body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while updating password\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_11 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while updating password\", e_11);\n                        onError != undefined && onError(e_11);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // update email\n    AuthenticationService.prototype.updateEmailAsync = function (oldPassword, email, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, body, response, data, e_12;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"users/account/email\"\n                            + \"?related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name);\n                        body = {\n                            OldPassword: AppCrypto.rsaEncrypt(oldPassword),\n                            Email: AppCrypto.rsaEncrypt(email)\n                        };\n                        return [4 /*yield*/, AppAPI.PutAsync(path, body)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Authentication]: Error occurred while updating email\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_12 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while updating email\", e_12);\n                        onError != undefined && onError(e_12);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // activate (account, password, email)\n    AuthenticationService.prototype.activateAsync = function (mode, code, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var path, response, data, e_13;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        if (AppData.Configuration.app.mode == \"\") {\n                            this.configSvc.prepare();\n                        }\n                        path = \"users/activate\"\n                            + \"?mode=\" + mode\n                            + \"&code=\" + code\n                            + \"&related-service=books\"\n                            + \"&language=vi-VN\"\n                            + \"&host=\" + (AppUtility.isWebApp() ? AppUtility.getHost() : AppData.Configuration.app.name);\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 3];\n                        AppData.Configuration.session.account = this.configSvc.getAccount(true);\n                        return [4 /*yield*/, this.configSvc.updateSessionAsync(data.Data, function () {\n                                AppData.Configuration.session.account.id = AppData.Configuration.session.jwt.uid;\n                                _this.configSvc.saveSessionAsync();\n                                console.info(\"Activated...\", AppUtility.isDebug() ? AppData.Configuration.session : \"\");\n                            })];\n                    case 2:\n                        _a.sent();\n                        onNext != undefined && onNext(data);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        console.error(\"[Authentication]: Error occurred while activating (\" + mode + \")\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_13 = _a.sent();\n                        console.error(\"[Authentication]: Error occurred while activating (\" + mode + \")\", e_13);\n                        onError != undefined && onError(e_13);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // process RTU message\n    AuthenticationService.prototype.processRTU = function (message) {\n        var _this = this;\n        // check status\n        if (message.Type == \"Error\") {\n            console.warn(\"[Authentication]: got an error message from RTU\", message);\n            return;\n        }\n        // parse\n        var info = AppRTU.parse(message.Type);\n        // update account\n        if (info.ObjectName == \"Account\") {\n            if (AppData.Configuration.session.account != null && AppData.Configuration.session.account.id == message.Data.ID) {\n                this.configSvc.updateAccount(message.Data);\n            }\n        }\n        else if ((info.ObjectName == \"Session\")\n            && AppData.Configuration.session.id == message.Data.ID\n            && AppData.Configuration.session.account != null && AppData.Configuration.session.account.id == message.Data.UserID) {\n            this.configSvc.updateSessionAsync(message.Data, function () {\n                AppUtility.isDebug() && console.warn(\"[Authentication]: Update session with the new token\", AppData.Configuration.session);\n                _this.configSvc.patchAccount();\n                _this.patchSession();\n            });\n        }\n        else if (info.ObjectName == \"Profile\") {\n            if (AppData.Configuration.session.account != null && AppData.Configuration.session.account.id == message.Data.ID) {\n                this.updateProfileAsync(message.Data);\n            }\n            else {\n                AppModels.Account.update(message.Data);\n            }\n        }\n        else if (info.ObjectName == \"Status\") {\n            var account = AppData.Accounts.getValue(message.Data.UserID);\n            if (account != undefined) {\n                account.IsOnline = message.Data.IsOnline;\n                account.LastAccess = new Date();\n            }\n            if (AppData.Configuration.session.account != null\n                && AppData.Configuration.session.account.id == message.Data.UserID\n                && AppData.Configuration.session.account.profile != null) {\n                AppData.Configuration.session.account.profile.LastAccess = new Date();\n            }\n        }\n    };\n    return AuthenticationService;\n}());\nAuthenticationService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object, typeof (_b = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _b || Object])\n], AuthenticationService);\nexport { AuthenticationService };\nvar _a, _b;\n//# sourceMappingURL=authentication.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/authentication.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { Storage } from \"@ionic/storage\";\nimport { List } from \"linqts\";\nimport \"rxjs/add/operator/toPromise\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppRTU } from \"../helpers/rtu\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppData } from \"../models/data\";\nimport { AppModels } from \"../models/objects\";\nimport { ConfigurationService } from \"./configuration\";\nvar StatisticsService = (function () {\n    function StatisticsService(http, storage, configSvc) {\n        this.http = http;\n        this.storage = storage;\n        this.configSvc = configSvc;\n        // working with authors\n        this.Authors = null;\n        AppAPI.setHttp(this.http);\n    }\n    // working with status\n    StatisticsService.prototype.loadStatusAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.storage.get(\"VIEApps-Status\")];\n                    case 1:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data)) {\n                            AppData.Statistics.Status = new List(JSON.parse(data))\n                                .Select(function (d) { return AppModels.StatisticBase.deserialize(d); })\n                                .ToArray();\n                            AppEvents.broadcast(\"StatusAreUpdated\");\n                        }\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Status);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.saveStatusAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var status;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        status = new List(AppData.Statistics.Status)\n                            .Where(function (s) { return s.Name != \"OnlineUsers\"; })\n                            .ToArray();\n                        return [4 /*yield*/, this.storage.set(\"VIEApps-Status\", JSON.stringify(status))];\n                    case 1:\n                        _a.sent();\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Status);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.updateStatusAsync = function (data, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var online;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (AppUtility.isArray(data)) {\n                            AppData.Statistics.Status = new List(data)\n                                .Select(function (d) { return AppModels.StatisticBase.deserialize(d); })\n                                .ToArray();\n                        }\n                        else {\n                            online = new List(AppData.Statistics.Status)\n                                .Where(function (s) { return s.Name == \"OnlineUsers\"; })\n                                .FirstOrDefault();\n                            if (online != undefined) {\n                                online.Counters = data;\n                            }\n                            else {\n                                AppData.Statistics.Status.push(AppModels.StatisticBase.deserialize({ Name: \"OnlineUsers\", Counters: data }));\n                            }\n                        }\n                        return [4 /*yield*/, this.saveStatusAsync(onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.fetchStatusAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, data, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!AppRTU.isReady()) return [3 /*break*/, 1];\n                        AppRTU.call(\"books\", \"statistic\", \"GET\", { \"object-identity\": \"status\" });\n                        return [3 /*break*/, 7];\n                    case 1:\n                        _a.trys.push([1, 6, , 7]);\n                        return [4 /*yield*/, AppAPI.GetAsync(\"books/statistic/status\")];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.updateStatusAsync(data.Data.Objects)];\n                    case 3:\n                        _a.sent();\n                        onNext != undefined && onNext(data);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        console.error(\"[Statistics]: Error occurred while fetching status\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        e_1 = _a.sent();\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // working with categories\n    StatisticsService.prototype.loadCategoriesAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.storage.get(\"VIEApps-Categories\")];\n                    case 1:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data)) {\n                            AppData.Statistics.Categories = new List(JSON.parse(data))\n                                .Select(function (c) { return AppModels.StatisticInfo.deserialize(c); })\n                                .ToArray();\n                            if (AppData.Statistics.Categories.length > 0) {\n                                AppEvents.broadcast(\"CategoriesAreUpdated\");\n                            }\n                        }\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Categories);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.saveCategoriesAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.storage.set(\"VIEApps-Categories\", JSON.stringify(AppData.Statistics.Categories))];\n                    case 1:\n                        _a.sent();\n                        AppEvents.broadcast(\"CategoriesAreUpdated\");\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Categories);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.updateCategoriesAsync = function (categories, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        AppData.Statistics.Categories = new List(categories)\n                            .Select(function (c) { return AppModels.StatisticInfo.deserialize(c); })\n                            .ToArray();\n                        return [4 /*yield*/, this.saveCategoriesAsync(onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.fetchCategoriesAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, data, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!AppRTU.isReady()) return [3 /*break*/, 1];\n                        AppRTU.call(\"books\", \"statistic\", \"GET\", { \"object-identity\": \"categories\" });\n                        return [3 /*break*/, 7];\n                    case 1:\n                        _a.trys.push([1, 6, , 7]);\n                        return [4 /*yield*/, AppAPI.GetAsync(\"books/statistic/categories\")];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.updateCategoriesAsync(data.Data.Objects)];\n                    case 3:\n                        _a.sent();\n                        onNext != undefined && onNext(data);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        console.error(\"[Statistics]: Error occurred while fetching categories\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        onError != undefined && onError(data);\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        e_2 = _a.sent();\n                        onError != undefined && onError(e_2);\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.loadAuthorsAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var tasks;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tasks = [];\n                        new List(AppUtility.getChars()).ForEach(function (c) {\n                            tasks.push(_this.storage.get(\"VIEApps-Authors-\" + c).then(function (data) {\n                                if (AppUtility.isNotEmpty(data)) {\n                                    AppData.Statistics.Authors.setValue(c, new List(JSON.parse(data))\n                                        .Select(function (a) { return AppModels.StatisticBase.deserialize(a); })\n                                        .ToArray());\n                                }\n                            }));\n                        });\n                        return [4 /*yield*/, Promise.all(tasks)];\n                    case 1:\n                        _a.sent();\n                        AppEvents.broadcast(\"AuthorsAreUpdated\");\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Authors);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.saveAuthorsAsync = function (char, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.storage.set(\"VIEApps-Authors-\" + char, JSON.stringify(AppData.Statistics.Authors.getValue(char)))];\n                    case 1:\n                        _a.sent();\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Authors.getValue(char));\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.updateAuthorsAsync = function (char, authors, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        AppData.Statistics.Authors.setValue(char, new List(authors)\n                            .Select(function (a) { return AppModels.StatisticBase.deserialize(a); })\n                            .ToArray());\n                        return [4 /*yield*/, this.saveAuthorsAsync(char, onCompleted)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StatisticsService.prototype.fetchAuthorsAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var path, response, data, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.Authors == null) {\n                            this.Authors = {\n                                Index: -1,\n                                Chars: AppUtility.getChars()\n                            };\n                        }\n                        this.Authors.Index++;\n                        if (!(this.Authors.Index < this.Authors.Chars.length)) return [3 /*break*/, 8];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, , 7]);\n                        path = \"books/statistic/authors\"\n                            + \"?char=\" + this.Authors.Chars[this.Authors.Index];\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (!(data.Status == \"OK\")) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.updateAuthorsAsync(this.Authors.Chars[this.Authors.Index], data.Data.Objects)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        console.error(\"[Statistics]: Error occurred while fetching authors [\" + this.Authors.Chars[this.Authors.Index] + \"]\");\n                        AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                        _a.label = 5;\n                    case 5:\n                        window.setTimeout(function () {\n                            _this.fetchAuthorsAsync(onCompleted);\n                        }, 13);\n                        return [3 /*break*/, 7];\n                    case 6:\n                        e_3 = _a.sent();\n                        console.error(\"[Statistics]: Error occurred while fetching authors [\" + this.Authors.Chars[this.Authors.Index] + \"]\", e_3);\n                        return [3 /*break*/, 7];\n                    case 7: return [3 /*break*/, 9];\n                    case 8:\n                        AppEvents.broadcast(\"AuthorsAreUpdated\");\n                        onCompleted != undefined && onCompleted(AppData.Statistics.Authors);\n                        _a.label = 9;\n                    case 9: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // load all statistics\n    StatisticsService.prototype.loadStatisticsAsync = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, Promise.all([\n                            this.loadCategoriesAsync(),\n                            this.loadAuthorsAsync(),\n                            this.loadStatusAsync()\n                        ])];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // fetch all statistics\n    StatisticsService.prototype.fetchStatistics = function () {\n        var _this = this;\n        // fetch statistics\n        if (AppRTU.isReady()) {\n            AppRTU.send({\n                ServiceName: \"books\",\n                ObjectName: \"statistic\",\n                Verb: \"GET\",\n                Query: {\n                    \"object-identity\": \"all\"\n                }\n            });\n        }\n        else {\n            AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, Promise.all([\n                                this.fetchCategoriesAsync(),\n                                this.fetchAuthorsAsync(),\n                                this.fetchStatusAsync()\n                            ])];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        }\n    };\n    // process RTU message\n    StatisticsService.prototype.processRTU = function (message) {\n        // parse\n        var info = AppRTU.parse(message.Type);\n        // status\n        if (info.ObjectName == \"Statistic#Status\") {\n            this.updateStatusAsync(message.Data.Objects);\n        }\n        else if (info.ObjectName == \"Statistic#Categories\") {\n            this.updateCategoriesAsync(message.Data.Objects);\n        }\n        else if (info.ObjectName == \"Statistic#Authors\") {\n            this.updateAuthorsAsync(message.Data.Char, message.Data.Objects);\n        }\n    };\n    return StatisticsService;\n}());\nStatisticsService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object, typeof (_b = typeof Storage !== \"undefined\" && Storage) === \"function\" && _b || Object, typeof (_c = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _c || Object])\n], StatisticsService);\nexport { StatisticsService };\nvar _a, _b, _c;\n//# sourceMappingURL=statistics.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/statistics.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { List } from \"linqts\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppCrypto } from \"../helpers/crypto\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppRTU } from \"../helpers/rtu\";\nimport { AppData } from \"../models/data\";\nimport { AppModels } from \"../models/objects\";\nimport { ConfigurationService } from \"./configuration\";\nimport { StatisticsService } from \"./statistics\";\nvar BooksService = (function () {\n    function BooksService(http, configSvc, statisticsSvc) {\n        var _this = this;\n        this.http = http;\n        this.configSvc = configSvc;\n        this.statisticsSvc = statisticsSvc;\n        AppAPI.setHttp(this.http);\n        AppRTU.register(\"Books\", function (message) { return _this.processRTU(message); });\n    }\n    BooksService.prototype.search = function (request, onNext, onError) {\n        request.Pagination.PageNumber++;\n        var path = \"books/book/search\"\n            + \"?x-request=\" + AppUtility.getBase64UrlParam(request);\n        var searcher = AppAPI.Get(path);\n        if (!onNext) {\n            return searcher;\n        }\n        searcher.map(function (response) { return response.json(); }).subscribe(function (data) {\n            if (data.Status == \"OK\") {\n                new List(data.Data.Objects).ForEach(function (b) { return AppModels.Book.update(b); });\n                !AppUtility.isNotEmpty(request.FilterBy.Query) && AppData.Paginations.set(data.Data, \"B\");\n                onNext(data);\n            }\n            else {\n                console.error(\"[Books]: Error occurred while searching books\");\n                AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                onError != undefined && onError(data);\n            }\n        }, function (error) {\n            console.error(\"[Books]: Error occurred while searching books\", error);\n            onError != undefined && onError(error);\n        });\n    };\n    BooksService.prototype.fetchAsync = function (request, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var pagination, path, response, data, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        pagination = AppData.Paginations.get(request, \"B\");\n                        if (AppUtility.isObject(pagination, true) && pagination.TotalPages && pagination.PageNumber && pagination.PageNumber >= pagination.TotalPages) {\n                            onNext != undefined && onNext();\n                            return [2 /*return*/];\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        request.Pagination.PageNumber++;\n                        path = \"books/book/search\"\n                            + \"?x-request=\" + AppUtility.getBase64UrlParam(request);\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            new List(data.Data.Objects).ForEach(function (b) { return AppModels.Book.update(b); });\n                            AppData.Paginations.set(data.Data, \"B\");\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while fetching books\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        console.error(\"[Books]: Error occurred while fetching books\", e_1);\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.getAsync = function (id, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var book, response, data, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        book = AppData.Books.getValue(id);\n                        if (book != undefined && (book.TOCs.length > 0 || book.Body != \"\")) {\n                            this.updateCounters(id);\n                            onNext != undefined && onNext();\n                            return [2 /*return*/];\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, AppAPI.GetAsync(\"books/book/\" + id)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            AppModels.Book.update(data.Data);\n                            this.updateCounters(id);\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while getting a book\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _a.sent();\n                        console.error(\"[Books]: Error occurred while getting a book\", e_2);\n                        onError != undefined && onError(e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.getChapterAsync = function (id, chapter, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var book, path, response, data, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        book = AppData.Books.getValue(id);\n                        if (book == undefined || book.TOCs.length < 1) {\n                            onError != undefined && onError();\n                            return [2 /*return*/];\n                        }\n                        else if (chapter < 1 || chapter > book.Chapters.length || book.Chapters[chapter - 1] != \"\") {\n                            onNext != undefined && onNext();\n                            return [2 /*return*/];\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        path = \"books/book/\" + id\n                            + \"?chapter=\" + chapter;\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            book.Chapters[chapter - 1] = data.Data.Content;\n                            this.updateCounters(id);\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while fetching chapter of a book\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_3 = _a.sent();\n                        console.error(\"[Books]: Error occurred while fetching a chapter of a book\", e_3);\n                        onError != undefined && onError(e_3);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.fetchChapterAsync = function (id, chapter, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var book;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        book = AppData.Books.getValue(id);\n                        while (chapter < book.TotalChapters && book.Chapters[chapter - 1] != \"\")\n                            chapter += 1;\n                        if (!(book.Chapters[chapter - 1] == \"\")) return [3 /*break*/, 4];\n                        if (!AppRTU.isReady()) return [3 /*break*/, 1];\n                        AppRTU.call(\"books\", \"book\", \"GET\", {\n                            \"object-identity\": \"chapter\",\n                            \"id\": id,\n                            \"chapter\": chapter\n                        }, undefined, undefined, undefined, function () {\n                            AppUtility.setTimeout(function () {\n                                _this.updateCounters(id, \"View\", onCompleted);\n                            }, 123);\n                        });\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, this.getChapterAsync(id, chapter, onCompleted)];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3: return [3 /*break*/, 5];\n                    case 4:\n                        if (chapter <= book.TotalChapters) {\n                            this.updateCounters(id, \"View\", onCompleted);\n                        }\n                        _a.label = 5;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.updateCounters = function (id, action, onCompleted) {\n        AppData.Books.getValue(id) != undefined\n            && AppRTU.isReady()\n            && AppRTU.call(\"books\", \"book\", \"GET\", {\n                \"object-identity\": \"counters\",\n                \"id\": id,\n                \"action\": action || \"View\"\n            });\n        onCompleted != undefined && onCompleted();\n    };\n    BooksService.prototype.setCounters = function (info, onCompleted) {\n        var book = AppUtility.isObject(info, true)\n            ? AppData.Books.getValue(info.ID)\n            : undefined;\n        if (book != undefined && AppUtility.isArray(info.Counters)) {\n            new List(info.Counters).ForEach(function (c) { return book.Counters.setValue(c.Type, AppModels.CounterInfo.deserialize(c)); });\n            AppEvents.broadcast(\"BookStatisticsAreUpdated\", { ID: book.ID });\n        }\n        onCompleted != undefined && onCompleted();\n    };\n    BooksService.prototype.generateFiles = function (id, onCompleted) {\n        AppData.Books.getValue(id) != undefined\n            && AppRTU.send({\n                ServiceName: \"books\",\n                ObjectName: \"book\",\n                Verb: \"GET\",\n                Query: {\n                    \"object-identity\": \"files\",\n                    \"id\": id\n                }\n            });\n    };\n    BooksService.prototype.updateFiles = function (data) {\n        var book = data.ID != undefined\n            ? AppData.Books.getValue(data.ID)\n            : undefined;\n        if (book != undefined && AppUtility.isObject(data.Files, true)) {\n            book.Files = data.Files;\n            AppEvents.broadcast(\"BookFilesAreUpdated\", { ID: book.ID });\n        }\n    };\n    BooksService.prototype.requestUpdateAsync = function (info, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, data, e_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, AppAPI.PostAsync(\"books/book/\" + AppCrypto.urlEncode(info.ID) + \"/\" + AppUtility.getBase64UrlParam({ ID: info.ID }), info)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while sending request to update an e-book\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_4 = _a.sent();\n                        console.error(\"[Books]: Error occurred while sending request to update an e-book\", e_4);\n                        onError != undefined && onError(e_4);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.updateAsync = function (info, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, data, e_5;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, AppAPI.PutAsync(\"ebooks/\" + AppCrypto.urlEncode(info.ID) + \"/\" + AppUtility.getBase64UrlParam({ ID: info.ID }), info)];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while updating an e-book\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_5 = _a.sent();\n                        console.error(\"[Books]: Error occurred while updating an e-book\", e_5);\n                        onError != undefined && onError(e_5);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.deleteAsync = function (info, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, data, e_6;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, AppAPI.DeleteAsync(\"ebooks/\" + AppCrypto.urlEncode(info.BookID) + \"/\" + AppUtility.getBase64UrlParam({ ID: info.BookID }))];\n                    case 1:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            AppData.Books.remove(info.BookID);\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Books]: Error occurred while deleting an e-book\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_6 = _a.sent();\n                        console.error(\"[Books]: Error occurred while deleting an e-book\", e_6);\n                        onError != undefined && onError(e_6);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BooksService.prototype.processRTU = function (message) {\n        // stop on error message\n        if (message.Type == \"Error\") {\n            console.warn(\"[Books]: got an error message from RTU\", message);\n            return;\n        }\n        // parse\n        var info = AppRTU.parse(message.Type);\n        // book information\n        if (info.ObjectName == \"Book\") {\n            AppModels.Book.update(message.Data);\n        }\n        else if (info.ObjectName == \"Book#Counters\") {\n            this.setCounters(message.Data);\n        }\n        else if (info.ObjectName == \"Book#Chapter\") {\n            var book = AppData.Books.getValue(message.Data.ID);\n            if (book != undefined) {\n                book.Chapters[message.Data.Chapter - 1] = message.Data.Content;\n            }\n        }\n        else if (info.ObjectName == \"Book#Files\") {\n            this.updateFiles(message.Data);\n        }\n        else if (info.ObjectName == \"Book#Delete\") {\n            AppData.Books.remove(message.Data.ID);\n            AppEvents.broadcast(\"BooksAreUpdated\");\n        }\n        else if (info.ObjectName == \"Bookmarks\") {\n            if (this.configSvc.isAuthenticated() && AppData.Configuration.session.account.id == message.Data.ID) {\n                this.configSvc.syncBookmarks(message.Data);\n            }\n        }\n        else if (AppUtility.indexOf(info.ObjectName, \"Statistic#\") == 0) {\n            this.statisticsSvc.processRTU(message);\n        }\n    };\n    return BooksService;\n}());\nBooksService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object, typeof (_b = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _b || Object, typeof (_c = typeof StatisticsService !== \"undefined\" && StatisticsService) === \"function\" && _c || Object])\n], BooksService);\nexport { BooksService };\nvar _a, _b, _c;\n//# sourceMappingURL=books.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/books.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { Storage } from \"@ionic/storage\";\nimport \"rxjs/add/operator/toPromise\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppData } from \"../models/data\";\nvar ResourcesService = (function () {\n    function ResourcesService(http, storage) {\n        this.http = http;\n        this.storage = storage;\n        AppAPI.setHttp(this.http);\n    }\n    // working with remote resources\n    ResourcesService.prototype.fetchResourceAsync = function (onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        path = \"statics/services/books.json\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        AppData.Configuration.resources = response.json();\n                        onNext != undefined && onNext();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_1 = _a.sent();\n                        console.error(\"[Resources]: Error occurred while fetching the remote resource\", e_1);\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // working with geo-meta\n    ResourcesService.prototype.loadGeoMetaAsync = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.storage.get(\"VIEApps-GeoMeta\")];\n                    case 1:\n                        data = _a.sent();\n                        if (AppUtility.isNotEmpty(data)) {\n                            AppData.Configuration.meta = JSON.parse(data);\n                        }\n                        if (!AppUtility.isNotEmpty(AppData.Configuration.meta.country)) {\n                            AppData.Configuration.meta.country = \"VN\";\n                        }\n                        if (!!AppData.Configuration.meta.provinces[AppData.Configuration.meta.country]) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.loadGeoProvincesAsync(AppData.Configuration.meta.country, function () {\n                                AppData.Configuration.meta.countries.length < 1 && window.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                                    return __generator(this, function (_a) {\n                                        switch (_a.label) {\n                                            case 0: return [4 /*yield*/, this.loadGeoCountriesAsync()];\n                                            case 1:\n                                                _a.sent();\n                                                return [2 /*return*/];\n                                        }\n                                    });\n                                }); }, 123);\n                            })];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        AppEvents.broadcast(\"GeoMetaIsLoaded\", AppData.Configuration.meta);\n                        AppData.Configuration.meta.countries.length < 1 && window.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0: return [4 /*yield*/, this.loadGeoCountriesAsync()];\n                                    case 1:\n                                        _a.sent();\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); }, 123);\n                        _a.label = 4;\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ResourcesService.prototype.loadGeoCountriesAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 3, , 4]);\n                        path = \"statics/geo/countries.json\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        return [4 /*yield*/, this.saveGeoMetaAsync(response.json(), onCompleted)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _a.sent();\n                        console.error(\"[Resources]: Error occurred while fetching the meta countries\", e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ResourcesService.prototype.loadGeoProvincesAsync = function (country, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var path, response, e_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 3, , 4]);\n                        path = \"statics/geo/provinces/\" + (country || AppData.Configuration.meta.country) + \".json\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 1:\n                        response = _a.sent();\n                        return [4 /*yield*/, this.saveGeoMetaAsync(response.json(), onCompleted)];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_3 = _a.sent();\n                        console.error(\"[Resources]: Error occurred while fetching the meta provinces\", e_3);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ResourcesService.prototype.saveGeoMetaAsync = function (data, onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (AppUtility.isObject(data, true) && AppUtility.isNotEmpty(data.code) && AppUtility.isArray(data.provinces)) {\n                            AppData.Configuration.meta.provinces[data.code] = data;\n                        }\n                        else if (AppUtility.isObject(data, true) && AppUtility.isArray(data.countries)) {\n                            AppData.Configuration.meta.countries = data.countries;\n                        }\n                        return [4 /*yield*/, this.storage.set(\"VIEApps-GeoMeta\", JSON.stringify(AppData.Configuration.meta))];\n                    case 1:\n                        _b.sent();\n                        AppEvents.broadcast(\"GeoMetaIsLoaded\", AppData.Configuration.meta);\n                        _a = onCompleted != undefined;\n                        if (!_a) return [3 /*break*/, 3];\n                        return [4 /*yield*/, onCompleted()];\n                    case 2:\n                        _a = (_b.sent());\n                        _b.label = 3;\n                    case 3:\n                        _a;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return ResourcesService;\n}());\nResourcesService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object, typeof (_b = typeof Storage !== \"undefined\" && Storage) === \"function\" && _b || Object])\n], ResourcesService);\nexport { ResourcesService };\nvar _a, _b;\n//# sourceMappingURL=resources.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/resources.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { NavController, NavParams, Searchbar } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../../helpers/utility\";\nimport { AppData } from \"../../models/data\";\nimport { AppModels } from \"../../models/objects\";\nimport { BooksService } from \"../../providers/books\";\nimport { ReadBookPage } from \"../books/read/read\";\nvar SearchPage = (function () {\n    function SearchPage(navCtrl, navParams, keyboard, booksSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.keyboard = keyboard;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            filterBy: {\n                Query: undefined,\n                And: {\n                    Category: {\n                        Equals: undefined\n                    },\n                    Author: {\n                        Equals: undefined\n                    }\n                }\n            },\n            pagination: AppData.Paginations.default(),\n            totalRecords: 0,\n            pageNumber: 0,\n            title: \"Searching...\"\n        };\n        this.books = null;\n        this.ratings = {};\n        this.infiniteScrollCtrl = undefined;\n    }\n    // page events\n    SearchPage.prototype.ionViewDidLoad = function () {\n        var filterBy = this.navParams.get(\"And\");\n        if (AppUtility.isObject(filterBy, true)) {\n            this.info.filterBy.And.Category.Equals = filterBy.Category.Equals;\n            this.info.filterBy.And.Author.Equals = filterBy.Author.Equals;\n        }\n        this.info.filterBy.And.Category.Equals = this.info.filterBy.And.Category.Equals || \"\";\n        this.info.filterBy.And.Author.Equals = this.info.filterBy.And.Author.Equals || \"\";\n        this.info.title = \"Tìm kiếm\" + (this.info.filterBy.And.Category.Equals != \"\"\n            ? \" chỉ trong [\" + this.info.filterBy.And.Category.Equals + \"]\"\n            : this.info.filterBy.And.Author.Equals != \"\"\n                ? \" chỉ của [\" + this.info.filterBy.And.Author.Equals + \"]\"\n                : \"\");\n    };\n    SearchPage.prototype.ionViewDidEnter = function () {\n        AppUtility.focus(this.searchBarCtrl, this.keyboard);\n    };\n    // event handlers\n    SearchPage.prototype.onSearch = function () {\n        var _this = this;\n        this.books = [];\n        this.doSearch(function () {\n            if (_this.infiniteScrollCtrl != undefined) {\n                _this.infiniteScrollCtrl.enable(true);\n                _this.infiniteScrollCtrl.complete();\n            }\n        });\n    };\n    SearchPage.prototype.onInfiniteScroll = function (infiniteScroll) {\n        var _this = this;\n        // capture\n        if (this.infiniteScrollCtrl == undefined) {\n            this.infiniteScrollCtrl = infiniteScroll;\n        }\n        // next page\n        if (this.info.pagination.PageNumber < this.info.pagination.TotalPages) {\n            this.doSearch(function () {\n                _this.infiniteScrollCtrl.complete();\n            });\n        }\n        else {\n            this.infiniteScrollCtrl.enable(false);\n        }\n    };\n    // search and show the listing of books\n    SearchPage.prototype.doSearch = function (onCompleted) {\n        var _this = this;\n        // check\n        if (this.info.filterBy.Query == \"\") {\n            onCompleted != undefined && onCompleted();\n            return;\n        }\n        // build well-formed request\n        var request = AppData.buildRequest(this.info.filterBy, undefined, this.info.pagination, function (r) {\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Category.Equals)) {\n                r.FilterBy.And.Category.Equals = undefined;\n            }\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Author.Equals)) {\n                r.FilterBy.And.Author.Equals = undefined;\n            }\n        });\n        // search e-books\n        this.booksSvc.search(request, function (data) {\n            _this.doBuild(data);\n            if (onCompleted != undefined) {\n                onCompleted();\n            }\n        });\n    };\n    SearchPage.prototype.doBuild = function (results) {\n        var _this = this;\n        // get pagination\n        var request = AppData.buildRequest(this.info.filterBy, undefined, this.info.pagination, function (r) {\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Category.Equals)) {\n                r.FilterBy.And.Category.Equals = undefined;\n            }\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Author.Equals)) {\n                r.FilterBy.And.Author.Equals = undefined;\n            }\n        });\n        this.info.pagination = results != undefined && AppUtility.isNotEmpty(this.info.filterBy.Query)\n            ? AppData.Paginations.default(results.Data)\n            : AppData.Paginations.get(request, \"B\");\n        this.info.pageNumber = this.info.pagination.PageNumber;\n        this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n        // initialize\n        var books = AppUtility.isNotEmpty(this.info.filterBy.Query) && results != undefined\n            ? new List(results.Data.Objects).Select(function (b) { return AppData.Books.containsKey(b.ID) ? AppData.Books.getValue(b.ID) : AppModels.Book.deserialize(b); })\n            : new List(AppData.Books.values());\n        // filter\n        if (!AppUtility.isNotEmpty(this.info.filterBy.Query)) {\n            var filterbyCategory = AppUtility.isNotEmpty(this.info.filterBy.And.Category.Equals);\n            var filterbyAuthor = AppUtility.isNotEmpty(this.info.filterBy.And.Author.Equals);\n            if (filterbyCategory) {\n                books = books.Where(function (b) { return AppUtility.indexOf(b.Category, _this.info.filterBy.And.Category.Equals) == 0; });\n            }\n            else if (filterbyAuthor) {\n                books = books.Where(function (b) { return b.Author == _this.info.filterBy.And.Author.Equals; });\n            }\n        }\n        // update the listing of books\n        this.books = AppUtility.isNotEmpty(this.info.filterBy.Query)\n            ? this.books.concat(books.ToArray())\n            : books.ToArray();\n        // prepare ratings & stocks\n        new List(this.books).ForEach(function (b) {\n            if (!_this.ratings[b.ID]) {\n                var rating = b.RatingPoints.getValue(\"General\");\n                _this.ratings[b.ID] = rating != undefined\n                    ? rating.Average\n                    : 0;\n            }\n        });\n    };\n    SearchPage.prototype.trackBy = function (index, book) {\n        return book.ID;\n    };\n    SearchPage.prototype.openBook = function (book) {\n        this.navCtrl.push(ReadBookPage, { ID: book.ID });\n    };\n    return SearchPage;\n}());\n__decorate([\n    ViewChild(Searchbar),\n    __metadata(\"design:type\", typeof (_a = typeof Searchbar !== \"undefined\" && Searchbar) === \"function\" && _a || Object)\n], SearchPage.prototype, \"searchBarCtrl\", void 0);\nSearchPage = __decorate([\n    Component({\n        selector: \"page-search\",\n        templateUrl: \"search.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_b = typeof NavController !== \"undefined\" && NavController) === \"function\" && _b || Object, typeof (_c = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _c || Object, typeof (_d = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _d || Object, typeof (_e = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _e || Object])\n], SearchPage);\nexport { SearchPage };\nvar _a, _b, _c, _d, _e;\n//# sourceMappingURL=search.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/search/search.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { NavController, NavParams, ActionSheetController, AlertController, Searchbar, Content } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppData } from \"../../../models/data\";\nimport { AuthenticationService } from \"../../../providers/authentication\";\nimport { BooksService } from \"../../../providers/books\";\nimport { SearchPage } from \"../../search/search\";\nimport { ReadBookPage } from \"../read/read\";\nvar SurfBooksPage = SurfBooksPage_1 = (function () {\n    function SurfBooksPage(navCtrl, navParams, actionSheetCtrl, alertCtrl, keyboard, authSvc, booksSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.actionSheetCtrl = actionSheetCtrl;\n        this.alertCtrl = alertCtrl;\n        this.keyboard = keyboard;\n        this.authSvc = authSvc;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            filterBy: {\n                Query: undefined,\n                And: {\n                    Category: {\n                        Equals: undefined\n                    },\n                    Author: {\n                        Equals: undefined\n                    }\n                }\n            },\n            sortBy: \"\",\n            pagination: AppData.Paginations.default(),\n            title: \"Loading...\",\n            processing: false,\n            filtering: false,\n            totalRecords: 0,\n            pageNumber: 0,\n            displayPages: 3,\n            offset: 96,\n            mode: \"auto\",\n            isAppleOS: AppUtility.isAppleOS()\n        };\n        this.sorts = [];\n        this.books = [];\n        this.ratings = {};\n    }\n    // when the page has loaded (only once)\n    SurfBooksPage.prototype.ionViewDidLoad = function () {\n        this.sorts = [\n            {\n                label: \"Tiêu đề (A - Z)\",\n                value: \"Title\"\n            },\n            {\n                label: \"Mới cập nhật\",\n                value: \"LastUpdated\"\n            },\n            {\n                label: \"Nhiều chương/phần\",\n                value: \"Chapters\"\n            }\n        ];\n        this.info.sortBy = this.sorts[1].value;\n        this.info.filterBy.And.Category.Equals = this.navParams.get(\"Category\");\n        this.info.filterBy.And.Category.Equals = this.info.filterBy.And.Category.Equals || \"\";\n        this.info.filterBy.And.Author.Equals = this.navParams.get(\"Author\");\n        this.info.filterBy.And.Author.Equals = this.info.filterBy.And.Author.Equals || \"\";\n        this.info.title = this.info.filterBy.And.Category.Equals != \"\"\n            ? \"Thể loại: \" + this.info.filterBy.And.Category.Equals\n            : \"Tác giả: \" + this.info.filterBy.And.Author.Equals;\n    };\n    // when the page has active\n    SurfBooksPage.prototype.ionViewDidEnter = function () {\n        // set active page\n        AppEvents.broadcast(\"UpdateActiveNav\", { name: \"SurfBooksPage\", component: SurfBooksPage_1, params: this.navParams.data });\n        // books\n        if (this.books.length < 1) {\n            var request = AppData.buildRequest(this.info.filterBy, undefined, this.info.pagination, function (r) {\n                if (!AppUtility.isNotEmpty(r.FilterBy.And.Category.Equals)) {\n                    r.FilterBy.And.Category.Equals = undefined;\n                }\n                if (!AppUtility.isNotEmpty(r.FilterBy.And.Author.Equals)) {\n                    r.FilterBy.And.Author.Equals = undefined;\n                }\n            });\n            this.info.pagination = AppData.Paginations.get(request, \"B\");\n            if (this.info.pagination == undefined) {\n                this.search();\n            }\n            else {\n                this.info.pageNumber = 1;\n                this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                this.build();\n            }\n        }\n    };\n    // books\n    SurfBooksPage.prototype.get = function (onepage, pageNumber) {\n        var _this = this;\n        if (onepage === void 0) { onepage = true; }\n        // initialize\n        var books = new List(AppData.Books.values());\n        // filter\n        var query = this.info.filtering && AppUtility.isNotEmpty(this.info.filterBy.Query)\n            ? AppUtility.toANSI(this.info.filterBy.Query).trim().toLowerCase()\n            : \"\";\n        var filterByCategory = this.info.filterBy.And.Category.Equals != \"\";\n        var filterByAuthor = this.info.filterBy.And.Author.Equals != \"\";\n        if (query != \"\" || filterByCategory || filterByAuthor) {\n            books = books.Where(function (b) {\n                return (query != \"\" ? AppUtility.indexOf(b.ANSITitle, query) > -1 : true)\n                    && (filterByCategory ? AppUtility.indexOf(b.Category, _this.info.filterBy.And.Category.Equals) == 0 : true)\n                    && (filterByAuthor ? b.Author == _this.info.filterBy.And.Author.Equals : true);\n            });\n        }\n        // sort\n        switch (this.info.sortBy) {\n            case \"LastUpdated\":\n                books = books.OrderByDescending(function (b) { return b.LastUpdated; });\n                break;\n            case \"Chapters\":\n                books = books.OrderByDescending(function (b) { return b.TotalChapters; }).ThenBy(function (a) { return a.LastUpdated; });\n                break;\n            default:\n                books = books.OrderBy(function (b) { return b.Title; }).ThenByDescending(function (a) { return a.LastUpdated; });\n                break;\n        }\n        // pagination\n        pageNumber = pageNumber || this.info.pageNumber;\n        if (onepage) {\n            if (pageNumber > 1) {\n                books = books.Skip((pageNumber - 1) * this.info.pagination.PageSize);\n            }\n            books = books.Take(this.info.pagination.PageSize);\n        }\n        else if (!this.info.filtering) {\n            books = books.Take(pageNumber * this.info.pagination.PageSize);\n        }\n        // return the array of books\n        return books.ToArray();\n    };\n    SurfBooksPage.prototype.search = function (onPreCompleted, onPostCompleted) {\n        var _this = this;\n        var request = AppData.buildRequest(this.info.filterBy, undefined, this.info.pagination, function (r) {\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Category.Equals)) {\n                r.FilterBy.And.Category.Equals = undefined;\n            }\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Author.Equals)) {\n                r.FilterBy.And.Author.Equals = undefined;\n            }\n        });\n        this.booksSvc.fetchAsync(request, function (data) {\n            _this.info.pagination = AppData.Paginations.get(request, \"B\");\n            _this.info.pageNumber = _this.info.pagination.PageNumber;\n            _this.info.totalRecords = AppData.Paginations.computeTotal(_this.info.pageNumber, _this.info.pagination);\n            _this.build(\"down\", onPreCompleted, onPostCompleted);\n        });\n    };\n    SurfBooksPage.prototype.build = function (direction, onPreCompleted, onPostCompleted) {\n        var _this = this;\n        if (direction === void 0) { direction = \"down\"; }\n        // pre handler\n        onPreCompleted != undefined && onPreCompleted();\n        // books\n        /*\n        if (direction == \"up\") {\n            let books = new Array<AppModels.Book>();\n            if (this.info.pageNumber > 1) {\n                books = this.get(true, this.info.pageNumber - 1).concat(books);\n            }\n            if (this.info.pageNumber > 2) {\n                books = this.get(true, this.info.pageNumber - 2).concat(books);\n            }\n            this.books = new List(books.concat(this.books)).Distinct().ToArray();\n            AppUtility.setTimeout(() => {\n                if (this.books.length > this.info.displayPages * this.info.pagination.PageSize) {\n                    AppUtility.splice(this.books, this.books.length - (this.info.displayPages * this.info.pagination.PageSize));\n                }\n            }, 678);\n        }\n        else {\n            this.books = this.books.concat(this.get());\n            AppUtility.setTimeout(() => {\n                if (this.books.length > this.info.displayPages * this.info.pagination.PageSize) {\n                    this.books.splice(0, this.books.length - (this.info.displayPages * this.info.pagination.PageSize));\n                }\n            }, 678);\n        }\n        */\n        this.books = this.get(false);\n        // ratings & stocks\n        new List(this.books).ForEach(function (b) {\n            if (!_this.ratings[b.ID]) {\n                var rating = b.RatingPoints.getValue(\"General\");\n                _this.ratings[b.ID] = rating != undefined ? rating.Average : 0;\n            }\n        });\n        // post handler\n        onPostCompleted != undefined && onPostCompleted();\n    };\n    // actions\n    SurfBooksPage.prototype.trackBy = function (index, book) {\n        return book.ID;\n    };\n    SurfBooksPage.prototype.openBook = function (book) {\n        this.navCtrl.push(ReadBookPage, { ID: book.ID });\n    };\n    SurfBooksPage.prototype.showActions = function () {\n        var _this = this;\n        var actionSheet = this.actionSheetCtrl.create({\n            enableBackdropDismiss: true,\n            buttons: [\n                {\n                    text: \"Mở tìm kiếm\",\n                    icon: this.info.isAppleOS ? undefined : \"search\",\n                    handler: function () {\n                        AppEvents.broadcast(\"OpenPage\", { component: SearchPage, params: _this.info.filterBy, doPush: true });\n                    }\n                },\n                {\n                    text: \"Lọc/Tìm nhanh\",\n                    icon: this.info.isAppleOS ? undefined : \"funnel\",\n                    handler: function () {\n                        _this.showFilter();\n                    }\n                },\n                {\n                    text: \"Thay đổi cách sắp xếp\",\n                    icon: this.info.isAppleOS ? undefined : \"list-box\",\n                    handler: function () {\n                        _this.showSorts();\n                    }\n                }\n            ]\n        });\n        if (this.info.pagination != null && this.info.pageNumber < this.info.pagination.PageNumber) {\n            actionSheet.addButton({\n                text: \"Hiển thị toàn bộ \" + AppData.Paginations.computeTotal(this.info.pagination.PageNumber, this.info.pagination) + \" kết quả\",\n                icon: this.info.isAppleOS ? undefined : \"eye\",\n                handler: function () {\n                    _this.info.pageNumber = _this.info.pagination.PageNumber;\n                    _this.info.totalRecords = AppData.Paginations.computeTotal(_this.info.pageNumber, _this.info.pagination);\n                    _this.build();\n                }\n            });\n        }\n        actionSheet.addButton({\n            text: \"Huỷ bỏ\",\n            icon: this.info.isAppleOS ? undefined : \"close\",\n            role: \"cancel\"\n        });\n        actionSheet.present();\n    };\n    SurfBooksPage.prototype.showFilter = function () {\n        this.info.filtering = true;\n        AppUtility.focus(this.searchBarCtrl, this.keyboard);\n    };\n    SurfBooksPage.prototype.showSorts = function () {\n        var _this = this;\n        var alert = this.alertCtrl.create({\n            title: \"Sắp xếp theo\",\n            enableBackdropDismiss: true,\n            buttons: [\n                {\n                    text: \"Huỷ\",\n                    role: \"cancel\"\n                },\n                {\n                    text: \"Đặt\",\n                    handler: function (sortBy) {\n                        _this.onSort(sortBy);\n                    }\n                }\n            ]\n        });\n        new List(this.sorts).ForEach(function (o) { return alert.addInput({ type: \"radio\", label: o.label, value: o.value, checked: _this.info.sortBy == o.value }); });\n        alert.present();\n    };\n    // event handlers\n    SurfBooksPage.prototype.onFilter = function () {\n        this.books = this.get(false);\n    };\n    SurfBooksPage.prototype.onCancel = function () {\n        var _this = this;\n        this.info.filterBy.Query = \"\";\n        var request = AppData.buildRequest(this.info.filterBy, undefined, this.info.pagination, function (r) {\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Category.Equals)) {\n                r.FilterBy.And.Category.Equals = undefined;\n            }\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Author.Equals)) {\n                r.FilterBy.And.Author.Equals = undefined;\n            }\n        });\n        this.info.pagination = AppData.Paginations.get(request, \"B\");\n        this.info.pageNumber = 1;\n        this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n        this.books = this.get();\n        AppUtility.setTimeout(function () {\n            _this.info.filtering = false;\n        }, 234);\n    };\n    SurfBooksPage.prototype.onSort = function (sortBy) {\n        var _this = this;\n        if (this.info.sortBy == sortBy) {\n            return;\n        }\n        this.info.processing = true;\n        this.info.sortBy = sortBy;\n        this.contentCtrl.scrollTo(0, this.info.offset / 2).then(function () {\n            _this.info.pageNumber = 1;\n            _this.info.totalRecords = AppData.Paginations.computeTotal(_this.info.pageNumber, _this.info.pagination);\n            _this.books = _this.get();\n            AppUtility.setTimeout(function () {\n                _this.info.processing = false;\n            }, 234);\n        });\n    };\n    // handle the scroll\n    SurfBooksPage.prototype.onInfiniteScroll = function (infiniteScroll) {\n        var _this = this;\n        if (this.info.filtering) {\n            infiniteScroll.complete();\n        }\n        else if (!this.info.processing) {\n            // update state\n            this.info.processing = true;\n            /*\n            // scroll up\n            if (infiniteScroll._position != \"bottom\") {\n                this.info.pageNumber = this.info.pageNumber > this.info.displayPages\n                    ? this.info.pageNumber - 1\n                    : this.info.displayPages;\n                this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                \n                this.build(\"up\",\n                    () => { },\n                    () => {\n                        infiniteScroll.complete();\n                        this.info.processing = false;\n                    }\n                );\n            }\n\n            // scroll down\n            else {\n                // data is avalable\n                if (this.info.pageNumber < this.info.pagination.PageNumber) {\n                    this.info.pageNumber++;\n                    this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                    \n                    this.build(\"down\",\n                        () => {\n                            if (AppUtility.isAppleSafari()) {\n                                this.scrollDown();\n                            }\n                        },\n                        () => {\n                            infiniteScroll.complete();\n                            this.info.processing = false;\n                        }\n                    );\n                }\n\n                // data is not available, then search next page\n                else if (this.info.pagination.PageNumber < this.info.pagination.TotalPages) {\n                    this.search(\n                        () => {\n                            if (AppUtility.isAppleSafari()) {\n                                this.scrollDown();\n                            }\n                        },\n                        () => {\n                            infiniteScroll.complete();\n                            this.info.processing = false;\n                        }\n                    );\n                }\n\n                // all data are fetched\n                else {\n                    infiniteScroll.complete();\n                    this.info.processing = false;\n                }\n            }\n            */\n            // data is avalable\n            if (this.info.pageNumber < this.info.pagination.PageNumber) {\n                this.info.pageNumber++;\n                this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                this.build(\"down\", function () { }, function () {\n                    infiniteScroll.complete();\n                    _this.info.processing = false;\n                });\n            }\n            else if (this.info.pagination.PageNumber < this.info.pagination.TotalPages) {\n                this.search(function () { }, function () {\n                    infiniteScroll.complete();\n                    _this.info.processing = false;\n                });\n            }\n            else {\n                infiniteScroll.complete();\n                this.info.processing = false;\n            }\n        }\n    };\n    SurfBooksPage.prototype.scrollDown = function () {\n        try {\n            if (this.info.pageNumber > this.info.displayPages) {\n                this.contentCtrl.scrollTo(0, this.contentCtrl.scrollTop - (this.info.offset * this.info.pagination.PageSize), 567);\n            }\n        }\n        catch (e) { }\n    };\n    return SurfBooksPage;\n}());\n__decorate([\n    ViewChild(Searchbar),\n    __metadata(\"design:type\", typeof (_a = typeof Searchbar !== \"undefined\" && Searchbar) === \"function\" && _a || Object)\n], SurfBooksPage.prototype, \"searchBarCtrl\", void 0);\n__decorate([\n    ViewChild(Content),\n    __metadata(\"design:type\", typeof (_b = typeof Content !== \"undefined\" && Content) === \"function\" && _b || Object)\n], SurfBooksPage.prototype, \"contentCtrl\", void 0);\nSurfBooksPage = SurfBooksPage_1 = __decorate([\n    Component({\n        selector: \"page-surf-books\",\n        templateUrl: \"surf.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_c = typeof NavController !== \"undefined\" && NavController) === \"function\" && _c || Object, typeof (_d = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _d || Object, typeof (_e = typeof ActionSheetController !== \"undefined\" && ActionSheetController) === \"function\" && _e || Object, typeof (_f = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _f || Object, typeof (_g = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _g || Object, typeof (_h = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _h || Object, typeof (_j = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _j || Object])\n], SurfBooksPage);\nexport { SurfBooksPage };\nvar SurfBooksPage_1, _a, _b, _c, _d, _e, _f, _g, _h, _j;\n//# sourceMappingURL=surf.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/books/surf/surf.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component } from \"@angular/core\";\nimport { NavController, NavParams, AlertController, ModalController } from \"ionic-angular\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppAPI } from \"../../../helpers/api\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppData } from \"../../../models/data\";\nimport { AppModels } from \"../../../models/objects\";\nimport { ConfigurationService } from \"../../../providers/configuration\";\nimport { BooksService } from \"../../../providers/books\";\nvar BookInfoPage = (function () {\n    function BookInfoPage(navCtrl, navParams, alertCtrl, modalCtrl, configSvc, booksSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.alertCtrl = alertCtrl;\n        this.modalCtrl = modalCtrl;\n        this.configSvc = configSvc;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            book: new AppModels.Book(),\n            view: undefined,\n            download: undefined,\n            title: \"Thông tin\",\n            rating: 0.0,\n            limit: 260,\n            uri: \"\",\n            qrcode: \"\",\n            processByApp: AppUtility.isNativeApp()\n        };\n    }\n    // events\n    BookInfoPage.prototype.ionViewDidLoad = function () {\n        var _this = this;\n        var id = this.navParams.get(\"ID\");\n        var existed = AppData.Books.containsKey(id);\n        if (existed) {\n            this.prepare(true);\n        }\n        else {\n            this.booksSvc.getAsync(id, function () {\n                _this.prepare(true);\n            });\n        }\n        AppEvents.on(\"BookStatisticsAreUpdated\", function (info) {\n            if (_this.info.book != undefined && _this.info.book.ID == info.args.ID) {\n                _this.prepare();\n            }\n        }, \"EventHandlerToUpdateBookStatistics\");\n        AppEvents.on(\"BookFilesAreUpdated\", function (info) {\n            if (_this.info.book != undefined && _this.info.book.ID == info.args.ID) {\n                _this.prepare();\n            }\n        }, \"EventHandlerToUpdateBookFiles\");\n    };\n    BookInfoPage.prototype.ionViewWillUnload = function () {\n        AppEvents.off(\"BookStatisticsAreUpdated\", \"EventHandlerToUpdateBookStatistics\");\n        AppEvents.off(\"BookFilesAreUpdated\", \"EventHandlerToUpdateBookFiles\");\n    };\n    BookInfoPage.prototype.prepare = function (checkFiles) {\n        this.info.book = AppData.Books.getValue(this.navParams.get(\"ID\"));\n        this.info.view = this.info.book.Counters.getValue(\"View\");\n        this.info.download = this.info.book.Counters.getValue(\"Download\");\n        var rating = this.info.book.RatingPoints.getValue(\"General\");\n        this.info.rating = rating != undefined\n            ? rating.Average\n            : 0.0;\n        this.info.uri = AppUtility.getUri() + \"#?book=\" + AppUtility.getBase64UrlParam({ ID: this.info.book.ID });\n        this.info.qrcode = this.info.processByApp\n            ? \"vieapps-books://\" + this.info.book.ID\n            : this.info.uri;\n        if (AppUtility.isTrue(checkFiles) && AppUtility.isObject(this.info.book.Files, true)\n            && (this.info.book.Files.Epub.Size == \"generating...\" || this.info.book.Files.Mobi.Size == \"generating...\")) {\n            this.booksSvc.generateFiles(this.info.book.ID);\n        }\n    };\n    BookInfoPage.prototype.download = function (type) {\n        if (this.configSvc.isAuthenticated()) {\n            window.open(this.info.book.Files[type].Url + \"?\" + AppUtility.getQuery(AppAPI.getAuthHeaders()));\n        }\n        else {\n            this.showAlert(\"Chú ý\", \"Cần đăng nhập để có thể tải được file e-book\");\n        }\n    };\n    BookInfoPage.prototype.showAlert = function (title, message, button, func) {\n        this.alertCtrl.create({\n            title: title,\n            message: message,\n            enableBackdropDismiss: true,\n            buttons: [{\n                    text: button != undefined ? button : \"Đóng\",\n                    handler: function () {\n                        func != undefined && func();\n                    }\n                }]\n        }).present();\n    };\n    return BookInfoPage;\n}());\nBookInfoPage = __decorate([\n    Component({\n        selector: \"page-book-info\",\n        templateUrl: \"info.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof NavController !== \"undefined\" && NavController) === \"function\" && _a || Object, typeof (_b = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _b || Object, typeof (_c = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _c || Object, typeof (_d = typeof ModalController !== \"undefined\" && ModalController) === \"function\" && _d || Object, typeof (_e = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _e || Object, typeof (_f = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _f || Object])\n], BookInfoPage);\nexport { BookInfoPage };\nvar _a, _b, _c, _d, _e, _f;\n//# sourceMappingURL=info.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/books/info/info.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Component } from \"@angular/core\";\nimport { NavController, NavParams } from \"ionic-angular\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppData } from \"../../../models/data\";\nimport { ConfigurationService } from \"../../../providers/configuration\";\nvar ReadingOptionsPage = (function () {\n    function ReadingOptionsPage(navCtrl, navParams, configSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.configSvc = configSvc;\n        // attributes\n        this.info = {\n            title: \"Tuỳ chọn đọc\",\n            options: AppData.Configuration.reading.options\n        };\n        this.options = {\n            colors: [\n                {\n                    label: \"Trắng\",\n                    value: \"white\"\n                },\n                {\n                    label: \"Đen\",\n                    value: \"black\"\n                },\n                {\n                    label: \"Ngả vàng\",\n                    value: \"sepia\"\n                }\n            ],\n            fonts: [\n                {\n                    label: \"Mặc định\",\n                    value: \"default\"\n                },\n                {\n                    label: \"Gần mặc định\",\n                    value: \"like-default\"\n                },\n                {\n                    label: \"Tròn\",\n                    value: \"plump\"\n                },\n                {\n                    label: \"Béo\",\n                    value: \"fat\"\n                },\n                {\n                    label: \"Khác lạ\",\n                    value: \"fancy\"\n                }\n            ],\n            sizes: [\n                {\n                    label: \"Nhỏ nhất\",\n                    value: \"smallest\"\n                },\n                {\n                    label: \"Nhỏ hơn\",\n                    value: \"smaller\"\n                },\n                {\n                    label: \"Nhỏ\",\n                    value: \"small\"\n                },\n                {\n                    label: \"Trung bình\",\n                    value: \"normal\"\n                },\n                {\n                    label: \"To\",\n                    value: \"big\"\n                },\n                {\n                    label: \"To hơn\",\n                    value: \"bigger\"\n                },\n                {\n                    label: \"Rất là bự\",\n                    value: \"huge\"\n                }\n            ],\n            paragraphs: [\n                {\n                    label: \"Bình thường\",\n                    value: \"one\"\n                },\n                {\n                    label: \"Thưa\",\n                    value: \"two\"\n                },\n                {\n                    label: \"Rất thưa\",\n                    value: \"three\"\n                }\n            ],\n            aligns: [\n                {\n                    label: \"Trái\",\n                    value: \"align-left\"\n                },\n                {\n                    label: \"Đều hai bên\",\n                    value: \"align-justify\"\n                },\n                {\n                    label: \"Phải\",\n                    value: \"align-right\"\n                }\n            ]\n        };\n    }\n    // events\n    ReadingOptionsPage.prototype.ionViewWillUnload = function () {\n        var _this = this;\n        window.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.configSvc.saveOptionsAsync(function () {\n                            AppEvents.broadcast(\"ReadingOptionsAreUpdated\");\n                        })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    return ReadingOptionsPage;\n}());\nReadingOptionsPage = __decorate([\n    Component({\n        selector: \"page-book-options\",\n        templateUrl: \"options.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof NavController !== \"undefined\" && NavController) === \"function\" && _a || Object, typeof (_b = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _b || Object, typeof (_c = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _c || Object])\n], ReadingOptionsPage);\nexport { ReadingOptionsPage };\nvar _a, _b, _c;\n//# sourceMappingURL=options.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/books/options/options.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { NavController, NavParams, ActionSheetController, Content, LoadingController, Platform, MenuController } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppData } from \"../../../models/data\";\nimport { AppModels } from \"../../../models/objects\";\nimport { ConfigurationService } from \"../../../providers/configuration\";\nimport { AuthenticationService } from \"../../../providers/authentication\";\nimport { BooksService } from \"../../../providers/books\";\nimport { SurfBooksPage } from \"../surf/surf\";\nimport { BookInfoPage } from \"../info/info\";\nimport { ReadingOptionsPage } from \"../options/options\";\nvar ReadBookPage = (function () {\n    function ReadBookPage(navCtrl, navParams, menuCtrl, actionSheetCtrl, keyboard, platform, loadingCtrl, configSvc, authSvc, booksSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.menuCtrl = menuCtrl;\n        this.actionSheetCtrl = actionSheetCtrl;\n        this.keyboard = keyboard;\n        this.platform = platform;\n        this.loadingCtrl = loadingCtrl;\n        this.configSvc = configSvc;\n        this.authSvc = authSvc;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            book: new AppModels.Book(),\n            title: \"Loading...\",\n            rating: 0.0,\n            chapter: 0,\n            offset: 0,\n            isAppleOS: AppUtility.isAppleOS()\n        };\n        this.options = {\n            color: AppData.Configuration.reading.options.color,\n            style: AppData.Configuration.reading.options.font + \" \" + AppData.Configuration.reading.options.size + \" \" + AppData.Configuration.reading.options.paragraph + \" \" + AppData.Configuration.reading.options.align\n        };\n        this.loading = undefined;\n    }\n    // page events\n    ReadBookPage.prototype.ionViewDidLoad = function () {\n        var _this = this;\n        this.showLoading();\n        var id = this.navParams.get(\"ID\");\n        var chapter = this.navParams.get(\"Chapter\");\n        if (AppData.Books.containsKey(id)) {\n            this.info.book = AppData.Books.getValue(id);\n        }\n        this.booksSvc.getAsync(id, function () {\n            _this.info.book = AppData.Books.getValue(id);\n            _this.info.chapter = chapter || 0;\n            _this.prepare();\n        }, function () {\n            _this.hideLoading();\n        });\n        AppEvents.on(\"OpenChapter\", function (info) {\n            if (_this.info.book.ID == info.args.ID) {\n                _this.goChapter(info.args.Chapter);\n            }\n        }, \"OpenBookChapterEventHandler\");\n        AppEvents.on(\"ReadingOptionsAreUpdated\", function (info) {\n            _this.options = {\n                color: AppData.Configuration.reading.options.color,\n                style: AppData.Configuration.reading.options.font + \" \" + AppData.Configuration.reading.options.size + \" \" + AppData.Configuration.reading.options.paragraph + \" \" + AppData.Configuration.reading.options.align\n            };\n        }, \"UpdateReadingOptionsEventHandler\");\n    };\n    ReadBookPage.prototype.ionViewDidLeave = function () {\n        AppEvents.off(\"OpenChapter\", \"OpenBookChapterEventHandler\");\n        AppEvents.off(\"ReadingOptionsAreUpdated\", \"UpdateReadingOptionsEventHandler\");\n        AppEvents.broadcast(\"CloseBook\", { ID: this.info.book.ID });\n    };\n    // prepare\n    ReadBookPage.prototype.prepare = function () {\n        this.info.title = this.info.book.Title + \" - \" + this.info.book.Author;\n        var rating = this.info.book.RatingPoints.getValue(\"General\");\n        this.info.rating = rating != undefined ? rating.Average : 0.0;\n        if (this.info.chapter == 0) {\n            var bookmark = AppData.Configuration.reading.bookmarks.getValue(this.info.book.ID);\n            if (bookmark != undefined) {\n                this.info.chapter = bookmark.Chapter;\n                this.info.offset = bookmark.Position;\n            }\n        }\n        if (this.info.chapter > 0) {\n            this.goChapter(this.info.chapter);\n        }\n        else if (this.info.book.TotalChapters > 1 && this.info.chapter < this.info.book.TotalChapters) {\n            this.hideLoading();\n            this.booksSvc.fetchChapterAsync(this.info.book.ID, this.info.chapter + 1);\n            AppEvents.broadcast(\"OpenBook\", { ID: this.info.book.ID, Chapter: this.info.chapter });\n        }\n        else {\n            this.hideLoading();\n        }\n    };\n    // go to a specified chapter\n    ReadBookPage.prototype.goChapter = function (chapter) {\n        var _this = this;\n        if (chapter < 1) {\n            this.info.chapter = 0;\n        }\n        else if (chapter > this.info.book.TotalChapters) {\n            this.info.chapter = this.info.book.TotalChapters;\n        }\n        else {\n            this.info.chapter = chapter;\n        }\n        if (this.info.chapter > 0) {\n            if (this.info.book.Chapters[this.info.chapter - 1] == \"\") {\n                this.showLoading();\n                this.booksSvc.getChapterAsync(this.info.book.ID, this.info.chapter, function () {\n                    _this.info.title = _this.info.book.Title + \" - \" + _this.info.book.TOCs[_this.info.chapter - 1];\n                    AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                        var _this = this;\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0: return [4 /*yield*/, this.scrollAsync(function () {\n                                        _this.hideLoading();\n                                        AppEvents.broadcast(\"OpenBook\", { ID: _this.info.book.ID, Chapter: _this.info.chapter });\n                                        _this.booksSvc.fetchChapterAsync(_this.info.book.ID, _this.info.chapter + 1);\n                                    })];\n                                case 1:\n                                    _a.sent();\n                                    return [2 /*return*/];\n                            }\n                        });\n                    }); });\n                });\n            }\n            else {\n                this.info.title = this.info.book.Title + \" - \" + this.info.book.TOCs[this.info.chapter - 1];\n                AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                    var _this = this;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0: return [4 /*yield*/, this.scrollAsync(function () {\n                                    _this.hideLoading();\n                                    AppEvents.broadcast(\"OpenBook\", { ID: _this.info.book.ID, Chapter: _this.info.chapter });\n                                    _this.booksSvc.fetchChapterAsync(_this.info.book.ID, _this.info.chapter + 1);\n                                })];\n                            case 1:\n                                _a.sent();\n                                return [2 /*return*/];\n                        }\n                    });\n                }); });\n            }\n        }\n        else {\n            this.info.title = this.info.book.Title + \" - \" + this.info.book.Author;\n            AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                var _this = this;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.scrollAsync(function () {\n                                AppEvents.broadcast(\"OpenBook\", { ID: _this.info.book.ID, Chapter: _this.info.chapter });\n                                _this.contentCtrl.scrollTop = 0;\n                                _this.onEndScroll();\n                            })];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        }\n    };\n    // event handlers\n    ReadBookPage.prototype.goPrevious = function () {\n        this.info.offset = 0;\n        if (this.info.book.TotalChapters > 1) {\n            this.goPreviousChapter();\n        }\n        else {\n            this.goPreviousBook();\n        }\n    };\n    ReadBookPage.prototype.goNext = function () {\n        this.info.offset = 0;\n        if (this.info.book.TotalChapters > 1) {\n            this.goNextChapter();\n        }\n        else {\n            this.goNextBook();\n        }\n    };\n    ReadBookPage.prototype.goPreviousChapter = function () {\n        this.goChapter(this.info.chapter - 1);\n    };\n    ReadBookPage.prototype.goNextChapter = function () {\n        this.goChapter(this.info.chapter + 1);\n    };\n    ReadBookPage.prototype.goPreviousBook = function () {\n        this.showLoading();\n        this.goBook(this.getBook(true));\n    };\n    ReadBookPage.prototype.goNextBook = function () {\n        this.showLoading();\n        this.goBook(this.getBook(false));\n    };\n    ReadBookPage.prototype.goBook = function (book) {\n        this.hideLoading();\n        if (book != undefined) {\n            this.info.book = book;\n            this.info.chapter = 0;\n            this.prepare();\n        }\n    };\n    ReadBookPage.prototype.getBook = function (isPrevious) {\n        var _this = this;\n        var books = new List(AppData.Books.values());\n        var index = books\n            .Where(function (b) { return b.ID == _this.info.book.ID; })\n            .Select(function (b, index) { return index; })\n            .FirstOrDefault();\n        return index != undefined && index > 0 && index < books.Count() - 1\n            ? books.FirstOrDefault(function (b, index) { return index == (isPrevious ? index - 1 : index + 1); })\n            : undefined;\n    };\n    ReadBookPage.prototype.showInfo = function () {\n        this.navCtrl.push(BookInfoPage, { ID: this.info.book.ID });\n    };\n    ReadBookPage.prototype.showOptions = function () {\n        this.navCtrl.push(ReadingOptionsPage);\n    };\n    ReadBookPage.prototype.onEndScroll = function () {\n        var _this = this;\n        (this.info.book.TotalChapters > 1 || this.info.book.Body != \"\") && AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.configSvc.updateBookmarksAsync(this.info.book.ID, this.info.chapter, this.contentCtrl.scrollTop)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        }); });\n    };\n    ReadBookPage.prototype.showActions = function () {\n        var _this = this;\n        var actionSheet = this.actionSheetCtrl.create({\n            enableBackdropDismiss: true,\n            buttons: [\n                {\n                    text: \"Cùng tác giả\",\n                    icon: this.info.isAppleOS ? undefined : \"search\",\n                    handler: function () {\n                        AppEvents.broadcast(\"OpenPage\", { component: SurfBooksPage, params: { Author: _this.info.book.Author } });\n                    }\n                },\n                {\n                    text: \"Thông tin\",\n                    icon: this.info.isAppleOS ? undefined : \"information-circle\",\n                    handler: function () {\n                        _this.showInfo();\n                    }\n                }\n            ]\n        });\n        if (this.info.book.TOCs.length > 1 && this.platform.width() < 992) {\n            actionSheet.addButton({\n                text: \"Mục lục\",\n                icon: this.info.isAppleOS ? undefined : \"list\",\n                handler: function () {\n                    _this.menuCtrl.open();\n                }\n            });\n        }\n        actionSheet.addButton({\n            text: \"Tuỳ chọn đọc\",\n            icon: this.info.isAppleOS ? undefined : \"options\",\n            handler: function () {\n                _this.showOptions();\n            }\n        });\n        if (this.authSvc.isSystemAdministrator() || this.authSvc.isInAppRole(\"book\", \"Administrator\") || this.authSvc.isInAppRole(\"book\", \"Moderator\")) {\n            actionSheet.addButton({\n                text: \"Cập nhật\",\n                icon: this.info.isAppleOS ? undefined : \"create\",\n                handler: function () {\n                }\n            });\n            actionSheet.addButton({\n                text: \"Xoá\",\n                icon: this.info.isAppleOS ? undefined : \"trash\",\n                handler: function () {\n                }\n            });\n        }\n        actionSheet.addButton({\n            text: \"Huỷ bỏ\",\n            icon: this.info.isAppleOS ? undefined : \"close\",\n            role: \"cancel\"\n        });\n        actionSheet.present();\n    };\n    ReadBookPage.prototype.showLoading = function () {\n        if (this.loading == undefined) {\n            this.loading = this.loadingCtrl.create({\n                content: \"Tải dữ liệu....\"\n            });\n            this.loading.present();\n        }\n    };\n    ReadBookPage.prototype.hideLoading = function () {\n        if (this.loading != undefined) {\n            this.loading.dismiss();\n            this.loading = undefined;\n        }\n    };\n    ReadBookPage.prototype.scrollAsync = function (onCompleted) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.contentCtrl.scrollTo(0, this.info.offset)];\n                    case 1:\n                        _a.sent();\n                        onCompleted != undefined && onCompleted();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return ReadBookPage;\n}());\n__decorate([\n    ViewChild(Content),\n    __metadata(\"design:type\", typeof (_a = typeof Content !== \"undefined\" && Content) === \"function\" && _a || Object)\n], ReadBookPage.prototype, \"contentCtrl\", void 0);\nReadBookPage = __decorate([\n    Component({\n        selector: \"page-read-book\",\n        templateUrl: \"read.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_b = typeof NavController !== \"undefined\" && NavController) === \"function\" && _b || Object, typeof (_c = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _c || Object, typeof (_d = typeof MenuController !== \"undefined\" && MenuController) === \"function\" && _d || Object, typeof (_e = typeof ActionSheetController !== \"undefined\" && ActionSheetController) === \"function\" && _e || Object, typeof (_f = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _f || Object, typeof (_g = typeof Platform !== \"undefined\" && Platform) === \"function\" && _g || Object, typeof (_h = typeof LoadingController !== \"undefined\" && LoadingController) === \"function\" && _h || Object, typeof (_j = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _j || Object, typeof (_k = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _k || Object, typeof (_l = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _l || Object])\n], ReadBookPage);\nexport { ReadBookPage };\nvar _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n//# sourceMappingURL=read.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/books/read/read.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component } from \"@angular/core\";\nimport { NavController, NavParams } from \"ionic-angular\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../../helpers/utility\";\nimport { AppEvents } from \"../../helpers/events\";\nimport { AppData } from \"../../models/data\";\nimport { ConfigurationService } from \"../../providers/configuration\";\nimport { ResourcesService } from \"../../providers/resources\";\nimport { BooksService } from \"../../providers/books\";\nimport { ReadBookPage } from \"../books/read/read\";\nvar HomePage = (function () {\n    function HomePage(navCtrl, navParams, configSvc, resourcesSvc, booksSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.configSvc = configSvc;\n        this.resourcesSvc = resourcesSvc;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            title: \"Trang nhất\",\n            introduction: \"\",\n            books: undefined,\n            isAppleOS: AppUtility.isAppleOS()\n        };\n    }\n    // events\n    HomePage.prototype.ionViewDidLoad = function () {\n        var _this = this;\n        AppEvents.on(\"AppIsInitialized\", function () {\n            _this.prepare();\n        }, \"UpdateHomePageWhenAppIsInitializedEventHandler\");\n    };\n    HomePage.prototype.ionViewDidEnter = function () {\n        if (this.info.books != undefined) {\n            this.update();\n        }\n        else if (this.configSvc.isReady()) {\n            this.prepare();\n        }\n    };\n    HomePage.prototype.ionViewWillUnload = function () {\n        AppEvents.off(\"AppIsInitialized\", \"UpdateHomePageWhenAppIsInitializedEventHandler\");\n    };\n    // helpers\n    HomePage.prototype.prepare = function () {\n        var _this = this;\n        // introduction\n        if (!AppData.Configuration.resources[\"introduction\"]) {\n            this.resourcesSvc.fetchResourceAsync(function () {\n                _this.info.introduction = AppData.Configuration.resources[\"introduction\"];\n            });\n        }\n        // newest books\n        if (this.info.books != undefined) {\n            this.update();\n        }\n        else {\n            if (AppData.Books.size() < 1) {\n                this.booksSvc.fetchAsync({\n                    FilterBy: {},\n                    SortBy: {},\n                    Pagination: AppData.Paginations.default()\n                }, function () {\n                    _this.update();\n                });\n            }\n            else {\n                this.update();\n            }\n        }\n    };\n    HomePage.prototype.update = function () {\n        // introduction\n        if (AppData.Configuration.resources[\"introduction\"]) {\n            this.info.introduction = AppData.Configuration.resources[\"introduction\"];\n        }\n        // newest books\n        this.info.books = new List(AppData.Books.values())\n            .OrderByDescending(function (b) { return b.LastUpdated; })\n            .Take(20)\n            .ToArray();\n        this.info.books = AppUtility.getTopScores(this.info.books, 12);\n    };\n    HomePage.prototype.trackBy = function (index, book) {\n        return book.ID;\n    };\n    HomePage.prototype.openBook = function (book) {\n        this.navCtrl.push(ReadBookPage, { ID: book.ID });\n    };\n    return HomePage;\n}());\nHomePage = __decorate([\n    Component({\n        selector: \"page-home\",\n        templateUrl: \"home.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof NavController !== \"undefined\" && NavController) === \"function\" && _a || Object, typeof (_b = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _b || Object, typeof (_c = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _c || Object, typeof (_d = typeof ResourcesService !== \"undefined\" && ResourcesService) === \"function\" && _d || Object, typeof (_e = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _e || Object])\n], HomePage);\nexport { HomePage };\nvar _a, _b, _c, _d, _e;\n//# sourceMappingURL=home.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { NavController, NavParams, ViewController, AlertController, LoadingController } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppData } from \"../../../models/data\";\nimport { AuthenticationService } from \"../../../providers/authentication\";\nvar SignInPage = (function () {\n    function SignInPage(navCtrl, navParams, viewCtrl, alertCtrl, loadingCtrl, keyboard, authSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.viewCtrl = viewCtrl;\n        this.alertCtrl = alertCtrl;\n        this.loadingCtrl = loadingCtrl;\n        this.keyboard = keyboard;\n        this.authSvc = authSvc;\n        // attributes\n        this.info = {\n            state: {\n                processing: true,\n                mode: \"SignIn\",\n                title: \"Đăng nhập\",\n                valid: true\n            },\n            account: {\n                email: \"\",\n                password: \"\",\n            },\n            captcha: {\n                code: \"\",\n                uri: \"\"\n            }\n        };\n        this.loading = undefined;\n    }\n    // page events\n    SignInPage.prototype.ionViewDidLoad = function () {\n        this.info.state.processing = false;\n    };\n    SignInPage.prototype.ionViewDidEnter = function () {\n        this.info.account.email = this.navParams.get(\"email\") || \"\";\n        this.navParams.get(\"mode\") && this.openRenewPassword();\n        AppUtility.focus(this.emailCtrl, this.keyboard);\n    };\n    SignInPage.prototype.ionViewDidLeave = function () {\n        AppEvents.broadcast(\"SetPreviousPageActive\", { current: \"SignInPage\" });\n    };\n    // helpers\n    SignInPage.prototype.renewCaptcha = function (dontFocus) {\n        var _this = this;\n        this.authSvc.registerCaptchaAsync(function () {\n            _this.info.captcha = {\n                code: \"\",\n                uri: AppData.Configuration.session.captcha.uri\n            };\n            if (AppUtility.isFalse(dontFocus)) {\n                AppUtility.focus(!AppUtility.isValidEmail(_this.info.account.email)\n                    ? _this.emailCtrl\n                    : _this.info.state.mode == \"SignIn\" && !AppUtility.isNotEmpty(_this.info.account.password)\n                        ? _this.passwordCtrl\n                        : _this.captchaCtrl, _this.keyboard);\n            }\n        });\n    };\n    SignInPage.prototype.isValidEmail = function (email) {\n        return AppUtility.isValidEmail(email);\n    };\n    SignInPage.prototype.isNotEmpty = function (value) {\n        return AppUtility.isNotEmpty(value);\n    };\n    SignInPage.prototype.isValidInfo = function (form) {\n        if (!form.valid) {\n            if (!form.controls.email.valid) {\n                AppUtility.focus(this.emailCtrl, this.keyboard);\n            }\n            else if (form.controls.password && !form.controls.password.valid) {\n                AppUtility.focus(this.passwordCtrl, this.keyboard);\n            }\n            else if (this.info.state.mode != \"SignIn\") {\n                AppUtility.focus(this.captchaCtrl, this.keyboard);\n            }\n            return false;\n        }\n        else {\n            if (!AppUtility.isValidEmail(this.info.account.email)) {\n                AppUtility.focus(this.emailCtrl, this.keyboard);\n                return false;\n            }\n            else if (this.info.state.mode == \"Password\" && !AppUtility.isNotEmpty(this.info.captcha.code)) {\n                AppUtility.focus(this.captchaCtrl, this.keyboard);\n                return false;\n            }\n            else {\n                return form.valid;\n            }\n        }\n    };\n    SignInPage.prototype.showLoading = function (msg) {\n        this.loading = this.loadingCtrl.create({ content: msg });\n        this.loading.present();\n    };\n    SignInPage.prototype.hideLoading = function () {\n        if (this.loading != undefined) {\n            this.loading.dismiss();\n            this.loading = undefined;\n        }\n    };\n    SignInPage.prototype.exit = function () {\n        this.hideLoading();\n        this.navCtrl.pop();\n    };\n    SignInPage.prototype.showError = function (data) {\n        var _this = this;\n        var message = \"\", ctrl = null;\n        if (AppUtility.isGotWrongAccountOrPasswordException(data.Error)) {\n            message = \"Email hoặc mật khẩu không đúng!\";\n            ctrl = this.emailCtrl;\n        }\n        else {\n            if (AppUtility.isGotCaptchaException(data.Error)) {\n                message = \"Mã xác thực không đúng\";\n            }\n            else if (AppUtility.isObject(data.Error, true)) {\n                message = data.Error.Message;\n            }\n            else {\n                message = \"Đã xảy ra lỗi!\";\n            }\n            ctrl = this.info.state.mode == \"SignIn\" ? this.passwordCtrl : this.captchaCtrl;\n        }\n        this.hideLoading();\n        if (this.info.state.mode != \"SignIn\") {\n            this.renewCaptcha(true);\n        }\n        this.alertCtrl.create({\n            title: \"Lỗi\",\n            message: message,\n            enableBackdropDismiss: false,\n            buttons: [{\n                    text: \"Đóng\",\n                    handler: function () {\n                        _this.info.state.processing = false;\n                        _this.info.account.password = \"\";\n                        AppUtility.focus(ctrl, _this.keyboard);\n                    }\n                }]\n        }).present();\n    };\n    // sign in\n    SignInPage.prototype.doSignIn = function (form) {\n        var _this = this;\n        this.info.state.valid = this.isValidInfo(form);\n        if (this.info.state.valid) {\n            this.showLoading(\"Đăng nhập...\");\n            this.info.state.processing = true;\n            this.authSvc.signInAsync(this.info.account.email, this.info.account.password, function () {\n                _this.exit();\n            }, function (error) {\n                _this.showError(error);\n            });\n        }\n    };\n    // renew password\n    SignInPage.prototype.openRenewPassword = function () {\n        this.renewCaptcha();\n        this.info.state.mode = \"Password\";\n        this.info.state.title = \"Lấy mật khẩu mới\";\n    };\n    SignInPage.prototype.doRenewPassword = function (form) {\n        var _this = this;\n        this.info.state.valid = this.isValidInfo(form);\n        if (this.info.state.valid) {\n            this.showLoading(\"Lấy mật khẩu...\");\n            this.info.state.processing = true;\n            this.authSvc.resetPasswordAsync(this.info.account.email, this.info.captcha.code, function () {\n                _this.alertCtrl.create({\n                    title: \"Mật khẩu mới\",\n                    message: \"Vui lòng kiểm tra email và làm theo hướng dẫn để lấy mật khẩu mới!\",\n                    enableBackdropDismiss: false,\n                    buttons: [{\n                            text: \"Đóng\",\n                            handler: function () {\n                                _this.exit();\n                            }\n                        }]\n                }).present();\n            }, function (error) {\n                _this.showError(error);\n            });\n        }\n    };\n    return SignInPage;\n}());\n__decorate([\n    ViewChild(\"email\"),\n    __metadata(\"design:type\", Object)\n], SignInPage.prototype, \"emailCtrl\", void 0);\n__decorate([\n    ViewChild(\"password\"),\n    __metadata(\"design:type\", Object)\n], SignInPage.prototype, \"passwordCtrl\", void 0);\n__decorate([\n    ViewChild(\"captcha\"),\n    __metadata(\"design:type\", Object)\n], SignInPage.prototype, \"captchaCtrl\", void 0);\nSignInPage = __decorate([\n    Component({\n        selector: \"page-signin\",\n        templateUrl: \"signin.html\",\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof NavController !== \"undefined\" && NavController) === \"function\" && _a || Object, typeof (_b = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _b || Object, typeof (_c = typeof ViewController !== \"undefined\" && ViewController) === \"function\" && _c || Object, typeof (_d = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _d || Object, typeof (_e = typeof LoadingController !== \"undefined\" && LoadingController) === \"function\" && _e || Object, typeof (_f = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _f || Object, typeof (_g = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _g || Object])\n], SignInPage);\nexport { SignInPage };\nvar _a, _b, _c, _d, _e, _f, _g;\n//# sourceMappingURL=signin.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/accounts/signin/signin.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { NavController, NavParams, ViewController, ActionSheetController, AlertController, LoadingController, TextInput, Content } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { CompleterService, CompleterCmp } from \"ng2-completer\";\nimport { ImageCropperComponent, CropperSettings } from \"ng2-img-cropper\";\nimport { List } from \"linqts\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppEvents } from \"../../../helpers/events\";\nimport { AppAPI } from \"../../../helpers/api\";\nimport { AppData } from \"../../../models/data\";\nimport { AppModels } from \"../../../models/objects\";\nimport { ConfigurationService } from \"../../../providers/configuration\";\nimport { AuthenticationService } from \"../../../providers/authentication\";\nimport { SignInPage } from \"../signin/signin\";\nimport { HomePage } from \"../../home/home\";\nimport { ReadBookPage } from \"../../books/read/read\";\nvar ProfilePage = (function () {\n    function ProfilePage(http, navCtrl, navParams, viewCtrl, actionSheetCtrl, alertCtrl, loadingCtrl, completerSvc, keyboard, configSvc, authSvc) {\n        this.http = http;\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.viewCtrl = viewCtrl;\n        this.actionSheetCtrl = actionSheetCtrl;\n        this.alertCtrl = alertCtrl;\n        this.loadingCtrl = loadingCtrl;\n        this.completerSvc = completerSvc;\n        this.keyboard = keyboard;\n        this.configSvc = configSvc;\n        this.authSvc = authSvc;\n        // attributes\n        this.info = {\n            title: \"Thông tin tài khoản\",\n            state: {\n                mode: \"Profile\",\n                processing: true,\n                valid: true,\n                css: \"\"\n            },\n            id: \"\",\n            profile: undefined,\n            avatar: {\n                mode: \"Avatar\",\n                current: \"\",\n                uploaded: \"\"\n            },\n            rating: 0.0,\n            bookmarks: [],\n            captcha: {\n                code: \"\",\n                uri: \"\"\n            },\n            address: {\n                current: undefined,\n                addresses: undefined\n            },\n            validBirthDay: {\n                min: ((new Date()).getFullYear() - 120) + \"-12-31\",\n                max: ((new Date()).getFullYear() - 16) + \"-01-01\"\n            },\n            change: {\n                OldPassword: \"\",\n                Password: \"\",\n                ConfirmPassword: \"\",\n                Email: \"\",\n                ConfirmEmail: \"\"\n            },\n            invitation: {\n                name: undefined,\n                email: undefined,\n                url: undefined\n            },\n            privileges: null,\n            permissions: null,\n            appMode: AppData.Configuration.app.mode,\n            canSeeOthers: false,\n            isAppleOS: AppUtility.isAppleOS()\n        };\n        this.completerData = undefined;\n        this.cropper = {\n            settings: new CropperSettings(),\n            data: {\n                image: \"\",\n                original: undefined\n            }\n        };\n        // controls\n        this.loading = undefined;\n        // initialize\n        this.info.state.mode = !this.configSvc.isAuthenticated() && AppUtility.isTrue(this.navParams.get(\"Register\"))\n            ? \"Register\"\n            : \"Profile\";\n        this.initialize();\n        // image cropper\n        this.cropper.settings.width = 100;\n        this.cropper.settings.height = 100;\n        this.cropper.settings.croppedWidth = 300;\n        this.cropper.settings.croppedHeight = 300;\n        this.cropper.settings.canvasWidth = 272;\n        this.cropper.settings.canvasHeight = 272;\n        this.cropper.settings.noFileInput = true;\n    }\n    // page events\n    ProfilePage.prototype.ionViewDidLoad = function () {\n        var _this = this;\n        this.info.state.processing = false;\n        this.info.state.css = \"text-input \"\n            + (AppUtility.isAppleOS()\n                ? \"text-input-ios\"\n                : AppUtility.isWindowsPhoneOS()\n                    ? \"text-input-wp\"\n                    : \"text-input-md\");\n        AppEvents.on(\"BookmarksAreUpdated\", function (info) {\n            _this.buildBookmakrs();\n        }, \"UpdateBookmarksEventHandler\");\n    };\n    ProfilePage.prototype.ionViewCanEnter = function () {\n        return this.isAdministrator() || this.info.id == \"\";\n    };\n    ProfilePage.prototype.ionViewDidEnter = function () {\n        var _this = this;\n        if (this.info.state.mode == \"Register\") {\n            this.setBackButton(false);\n            this.renewCaptcha(function () {\n                AppUtility.focus(_this.nameCtrl, _this.keyboard);\n            });\n        }\n    };\n    ProfilePage.prototype.ionViewDidLeave = function () {\n        AppEvents.off(\"BookmarksAreUpdated\", \"UpdateBookmarksEventHandler\");\n        AppEvents.broadcast(\"SetPreviousPageActive\", { current: \"ProfilePage\" });\n    };\n    // run initialize\n    ProfilePage.prototype.initialize = function () {\n        var _this = this;\n        if (this.info.state.mode == \"Register\") {\n            this.info.title = \"Đăng ký tài khoản\";\n            this.info.profile = {\n                Name: \"\",\n                Email: \"\",\n                ConfirmEmail: \"\",\n                Password: \"\",\n                ConfirmPassword: \"\",\n                Gender: \"NotProvided\",\n                BirthDay: \"\",\n                Address: \"\",\n                County: \"\",\n                Province: \"\",\n                Country: \"\",\n                Mobile: \"\"\n            };\n        }\n        else {\n            this.info.id = this.navParams.get(\"ID\");\n            this.info.id = AppUtility.isNotEmpty(this.info.id) ? this.info.id : \"\";\n            this.info.canSeeOthers = this.info.id == \"\" || this.info.id == AppData.Configuration.session.account.id || this.isAdministrator();\n            this.info.profile = this.info.id == \"\" || this.info.id == AppData.Configuration.session.account.id\n                ? AppModels.Account.deserialize(this.configSvc.getAccount().profile)\n                : AppData.Accounts.getValue(this.info.id);\n            this.info.avatar.current = AppUtility.getAvatarImage(this.info.profile);\n            this.info.avatar.mode = this.info.avatar.current == this.info.profile.Gravatar\n                ? \"Gravatar\"\n                : \"Avatar\";\n            this.info.title = this.info.id != \"\" && this.info.id != AppData.Configuration.session.account.id\n                ? this.info.profile.Name\n                : \"Thông tin tài khoản\";\n            var rating = this.info.profile.RatingPoints.getValue(\"General\");\n            this.info.rating = rating != undefined ? rating.Average : 0;\n            if (this.info.profile.ID == AppData.Configuration.session.account.id) {\n                this.buildBookmakrs();\n            }\n            else if (this.authSvc.isSystemAdministrator()) {\n                this.authSvc.getPrivilegesAsync(this.info.profile.ID, function (data) {\n                    _this.preparePrivileges(data);\n                });\n            }\n        }\n        this.info.address = AppUtility.initializeAddress(this.info.profile);\n        this.completerData = this.completerSvc.local(this.info.address.addresses, \"title,titleANSI\", \"title\");\n    };\n    // event handlers\n    ProfilePage.prototype.showActions = function () {\n        var _this = this;\n        var actionSheet = this.actionSheetCtrl.create({\n            enableBackdropDismiss: true\n        });\n        if (this.info.profile.ID == AppData.Configuration.session.account.id) {\n            actionSheet.addButton({\n                text: \"Cập nhật\",\n                icon: this.info.isAppleOS ? undefined : \"create\",\n                handler: function () {\n                    _this.openUpdate();\n                }\n            });\n            actionSheet.addButton({\n                text: \"Đổi mật khẩu\",\n                icon: this.info.isAppleOS ? undefined : \"key\",\n                handler: function () {\n                    _this.openChangePassword();\n                }\n            });\n            actionSheet.addButton({\n                text: \"Đổi email đăng nhập\",\n                icon: this.info.isAppleOS ? undefined : \"mail\",\n                handler: function () {\n                    _this.openChangeEmail();\n                }\n            });\n        }\n        else if (this.isAdministrator() && this.info.id != \"\" && this.info.id != AppData.Configuration.session.account.id) {\n            actionSheet.addButton({\n                text: \"Đặt quyền truy cập\",\n                icon: this.info.isAppleOS ? undefined : \"settings\",\n                handler: function () {\n                    _this.openPrivileges();\n                }\n            });\n        }\n        if (this.info.id == \"\") {\n            actionSheet.addButton({\n                text: \"Đăng xuất\",\n                icon: this.info.isAppleOS ? undefined : \"log-out\",\n                handler: function () {\n                    _this.doSignOut();\n                }\n            });\n        }\n        actionSheet.addButton({\n            text: \"Huỷ bỏ\",\n            icon: this.info.isAppleOS ? undefined : \"close\",\n            role: \"cancel\"\n        });\n        actionSheet.present();\n    };\n    ProfilePage.prototype.openInvitation = function () {\n        this.setBackButton(false);\n        this.info.state.mode = \"Invite\";\n        this.info.title = \"Mời bạn bè\";\n        this.info.invitation.url = AppUtility.getUri() + \"#?refer=\" + AppUtility.getBase64UrlParam({ uid: this.info.profile.ID, section: \"WPA\" }) + \"&utm_campaign=WPA-Direct-Invitation&utm_medium=Direct-Invitation-Link\";\n        AppUtility.focus(this.guestnameCtrl, this.keyboard);\n    };\n    ProfilePage.prototype.openUpdate = function () {\n        this.setBackButton(false);\n        this.info.state.mode = \"Update\";\n        this.info.title = \"Cập nhật tài khoản\";\n        this.cropper.data.image = this.info.avatar.current;\n        AppUtility.focus(this.nameCtrl, this.keyboard);\n    };\n    ProfilePage.prototype.openChangePassword = function () {\n        this.setBackButton(false);\n        this.info.state.mode = \"ChangePassword\";\n        this.info.title = \"Đổi mật khẩu\";\n        AppUtility.focus(this.oldPasswordCtrl, this.keyboard);\n    };\n    ProfilePage.prototype.openChangeEmail = function () {\n        this.setBackButton(false);\n        this.renewCaptcha();\n        this.info.state.mode = \"ChangeEmail\";\n        this.info.title = \"Đổi email\";\n        AppUtility.focus(this.oldPasswordCtrl, this.keyboard);\n    };\n    ProfilePage.prototype.preparePrivileges = function (data) {\n        this.info.privileges = this.configSvc.prepareAccount(data).Privileges;\n    };\n    ProfilePage.prototype.openPrivileges = function () {\n        var _this = this;\n        this.setBackButton(false);\n        this.info.state.mode = \"SetPrivileges\";\n        this.info.title = \"Đặt quyền truy cập\";\n        this.info.permissions = {\n            roles: [\n                { label: \"Người quản trị\", value: \"Administrator\" },\n                { label: \"Người kiểm duyệt\", value: \"Moderator\" },\n                { label: \"Người dùng\", value: \"Viewer\" }\n            ],\n            objects: [\n                { label: \"Sách điện tử\", value: \"book\" },\n                { label: \"Thể loại\", value: \"category\" },\n                { label: \"Thông tin thống kê\", value: \"statistic\" }\n            ],\n            privileges: {}\n        };\n        new List(this.info.permissions.objects)\n            .ForEach(function (o) {\n            var privilege = new List(_this.info.privileges).FirstOrDefault(function (p) { return p.ServiceName == \"books\" && p.ObjectName == o.value; });\n            _this.info.permissions.privileges[o.value] = privilege\n                ? privilege.Role\n                : _this.authSvc.isInAppRole(o.value, \"Administrator\")\n                    ? \"Administrator\"\n                    : _this.authSvc.isInAppRole(o.value, \"Moderator\")\n                        ? \"Moderator\"\n                        : \"Viewer\";\n        });\n    };\n    // helpers\n    ProfilePage.prototype.renewCaptcha = function (onCompleted) {\n        var _this = this;\n        this.authSvc.registerCaptchaAsync(function () {\n            _this.info.captcha = {\n                code: \"\",\n                uri: AppData.Configuration.session.captcha.uri\n            };\n            if (onCompleted != undefined) {\n                onCompleted();\n            }\n        });\n    };\n    ProfilePage.prototype.selectAddress = function (item) {\n        if (AppUtility.isObject(item, null) && AppUtility.isObject(item.originalObject, null)) {\n            this.info.address.current = item.originalObject;\n        }\n    };\n    ProfilePage.prototype.setBackButton = function (state) {\n        this.viewCtrl.showBackButton(state);\n    };\n    ProfilePage.prototype.cancel = function () {\n        if (this.info.state.mode == \"Register\") {\n            this.exit();\n        }\n        else {\n            this.cancelUpdate();\n        }\n    };\n    ProfilePage.prototype.cancelUpdate = function () {\n        var _this = this;\n        this.hideLoading();\n        this.contentCtrl.scrollToTop().then(function () {\n            _this.info.state.processing = false;\n            _this.setBackButton(true);\n            _this.info.state.mode = \"Profile\";\n            _this.info.title = \"Thông tin tài khoản\";\n        });\n    };\n    ProfilePage.prototype.exit = function () {\n        this.navCtrl.pop();\n    };\n    ProfilePage.prototype.openGoogleMaps = function () {\n        AppUtility.openGoogleMaps(this.info.profile.FullAddress);\n    };\n    ProfilePage.prototype.isAdministrator = function () {\n        return this.authSvc.isSystemAdministrator();\n    };\n    ProfilePage.prototype.isNotNull = function (value) {\n        return AppUtility.isNotNull(value);\n    };\n    ProfilePage.prototype.isNotEmpty = function (value) {\n        return AppUtility.isNotEmpty(value);\n    };\n    ProfilePage.prototype.isValidEmail = function (email) {\n        return AppUtility.isValidEmail(email);\n    };\n    ProfilePage.prototype.isValidInfo = function (form) {\n        if (!form.valid) {\n            if (!form.controls.name.valid) {\n                AppUtility.focus(this.nameCtrl, this.keyboard);\n            }\n            else if (form.controls.email && !form.controls.email.valid) {\n                AppUtility.focus(this.emailCtrl, this.keyboard);\n            }\n            else if (form.controls.confirmEmail && (!form.controls.confirmEmail.valid || !this.isValidEmail(this.info.profile.ConfirmEmail) || this.info.profile.ConfirmEmail != this.info.profile.Email)) {\n                AppUtility.focus(this.confirmEmailCtrl, this.keyboard);\n            }\n            else if (form.controls.password && !form.controls.password.valid) {\n                AppUtility.focus(this.passwordCtrl, this.keyboard);\n            }\n            else if (form.controls.confirmPassword && (!form.controls.confirmPassword.valid || this.info.profile.ConfirmPassword != this.info.profile.Password)) {\n                AppUtility.focus(this.confirmPasswordCtrl, this.keyboard);\n            }\n            else if (this.genderCtrl && !form.controls.gender.valid) {\n                AppUtility.focus(this.genderCtrl, this.keyboard);\n            }\n            else if (this.birthDayCtrl && !form.controls.birthYear.valid) {\n                AppUtility.focus(this.birthDayCtrl, this.keyboard);\n            }\n            else if (this.addressCtrl && !form.controls.address.valid) {\n                AppUtility.focus(this.addressCtrl, this.keyboard);\n            }\n            else if (this.addressesCtrl && !this.info.address.current) {\n                AppUtility.focus(this.addressesCtrl.ctrInput, this.keyboard);\n            }\n            else if (this.mobileCtrl && !form.controls.mobile.valid) {\n                AppUtility.focus(this.mobileCtrl, this.keyboard);\n            }\n            else if (this.captchaCtrl && !form.controls.captcha.valid) {\n                AppUtility.focus(this.captchaCtrl, this.keyboard);\n            }\n            return false;\n        }\n        else {\n            if (this.emailCtrl && !this.isValidEmail(this.info.profile.Email)) {\n                AppUtility.focus(this.emailCtrl, this.keyboard);\n                return false;\n            }\n            else if (this.confirmEmailCtrl && (!this.isValidEmail(this.info.profile.ConfirmEmail) || this.info.profile.ConfirmEmail != this.info.profile.Email)) {\n                AppUtility.focus(this.confirmEmailCtrl, this.keyboard);\n                return false;\n            }\n            else if (this.confirmPasswordCtrl && this.info.profile.ConfirmPassword != this.info.profile.Password) {\n                AppUtility.focus(this.confirmPasswordCtrl, this.keyboard);\n                return false;\n            }\n            else if (this.genderCtrl && !this.info.profile.Gender) {\n                AppUtility.focus(this.genderCtrl, this.keyboard);\n                return false;\n            }\n            else if (this.birthDayCtrl && !this.info.profile.BirthDay) {\n                AppUtility.focus(this.birthDayCtrl, this.keyboard);\n                return false;\n            }\n            else {\n                return form.valid;\n            }\n        }\n    };\n    ProfilePage.prototype.showLoading = function (msg) {\n        this.loading = this.loadingCtrl.create({ content: msg });\n        this.loading.present();\n    };\n    ProfilePage.prototype.hideLoading = function () {\n        if (this.loading != undefined) {\n            this.loading.dismiss();\n            this.loading = undefined;\n        }\n    };\n    ProfilePage.prototype.showError = function (data, setFocus) {\n        var _this = this;\n        this.hideLoading();\n        this.info.state.processing = false;\n        var message = \"\", ctrl = null;\n        if (AppUtility.isGotWrongAccountOrPasswordException(data.Error)) {\n            message = \"Mật khẩu hiện tại không đúng!\";\n            ctrl = this.oldPasswordCtrl;\n        }\n        else if (AppUtility.isGotCaptchaException(data.Error)) {\n            message = \"Mã xác thực không đúng\";\n            ctrl = this.info.state.mode == \"Register\" ? this.captchaCtrl : this.changeCaptchaCtrl;\n        }\n        else {\n            message = AppUtility.isObject(data.Error) && AppUtility.isNotEmpty(data.Error.Message)\n                ? data.Error.Message\n                : \"Đã xảy ra lỗi!\";\n        }\n        if (this.info.state.mode != \"Update\" && this.info.state.mode != \"SetPrivileges\") {\n            this.renewCaptcha();\n        }\n        this.showAlert(\"Lỗi!\", message, setFocus != undefined\n            ? setFocus\n            : function () {\n                AppUtility.focus(ctrl, _this.keyboard);\n            });\n    };\n    ProfilePage.prototype.showAlert = function (title, message, handler) {\n        this.hideLoading();\n        this.alertCtrl.create({\n            title: title,\n            message: message,\n            enableBackdropDismiss: false,\n            buttons: [{\n                    text: \"Đóng\",\n                    handler: handler\n                }]\n        }).present();\n    };\n    // register\n    ProfilePage.prototype.doRegister = function (form) {\n        var _this = this;\n        this.info.state.valid = this.isValidInfo(form);\n        if (this.info.state.valid) {\n            this.info.state.processing = true;\n            this.authSvc.registerAccountAsync(this.info.profile, this.info.captcha.code, function () {\n                _this.showAlert(\"Đăng ký\", \"Vui lòng kiểm tra email và làm theo hướng dẫn để kích hoạt tài khoản\", function () {\n                    _this.exit();\n                });\n            }, function (error) {\n                if (AppUtility.isObject(error.Error, true) && \"InformationExistedException\" == error.Error.Type) {\n                    _this.renewCaptcha();\n                    _this.hideLoading();\n                    _this.info.state.processing = false;\n                    _this.alertCtrl.create({\n                        title: \"Chú ý\",\n                        message: \"Địa chỉ email (\" + _this.info.profile.Email + \") đã được sử dụng để đăng ký tài khoản.\\nCó muốn lấy mật khẩu mới cho địa chỉ email này?\",\n                        enableBackdropDismiss: false,\n                        buttons: [{\n                                text: \"Không\",\n                                role: \"cancel\"\n                            },\n                            {\n                                text: \"Lấy mật khẩu mới\",\n                                handler: function () {\n                                    AppEvents.broadcast(\"OpenPage\", {\n                                        name: \"SignInPage\",\n                                        component: SignInPage,\n                                        params: {\n                                            mode: \"Password\",\n                                            email: _this.info.profile.Email\n                                        },\n                                        doPush: true,\n                                        popIfContains: \"ProfilePage,SignInPage\",\n                                        noNestedStack: true\n                                    });\n                                }\n                            }]\n                    }).present();\n                }\n                else {\n                    _this.showError(error);\n                }\n            });\n        }\n    };\n    // send an invitation\n    ProfilePage.prototype.sendInvitation = function () {\n        var _this = this;\n        var setFocus = function () {\n            AppUtility.focus(!AppUtility.isNotEmpty(_this.info.invitation.name)\n                ? _this.guestnameCtrl\n                : _this.guestemailCtrl, _this.keyboard);\n        };\n        if (AppUtility.isNotEmpty(this.info.invitation.name) && AppUtility.isValidEmail(this.info.invitation.email)) {\n            this.showLoading(\"Gửi lời mời...\");\n            this.info.state.processing = true;\n            this.authSvc.sendInvitationAsync(this.info.invitation.name, this.info.invitation.email, function () {\n                _this.showAlert(\"Mời bạn\", \"Email lời mời đã được gửi thành công!\", function () {\n                    _this.cancelUpdate();\n                });\n            }, function (error) {\n                _this.showError(error, setFocus);\n            });\n        }\n        else {\n            setFocus();\n        }\n    };\n    // update\n    ProfilePage.prototype.doUpdate = function (form) {\n        var _this = this;\n        this.info.state.valid = this.isValidInfo(form);\n        if (this.info.state.valid) {\n            this.showLoading(\"Cập nhật hồ sơ...\");\n            this.info.state.processing = true;\n            this.info.profile.County = this.info.address.current.county;\n            this.info.profile.Province = this.info.address.current.province;\n            this.info.profile.Country = this.info.address.current.country;\n            this.uploadAvatar(function () {\n                _this.info.profile.Avatar = _this.info.avatar.mode == \"Avatar\" && _this.info.avatar.uploaded != \"\"\n                    ? _this.info.avatar.uploaded\n                    : \"\";\n                _this.authSvc.saveProfileAsync(_this.info.profile, function () {\n                    _this.info.profile = AppUtility.clone(_this.configSvc.getAccount().profile);\n                    _this.info.avatar.current = AppUtility.getAvatarImage(_this.info.profile);\n                    _this.info.avatar.uploaded = \"\";\n                    _this.cancelUpdate();\n                }, function (error) {\n                    _this.showError(error);\n                });\n            });\n        }\n    };\n    ProfilePage.prototype.uploadAvatar = function (onCompleted) {\n        var _this = this;\n        if (this.info.avatar.mode == \"Avatar\" && this.cropper.data.image != \"\" && this.info.avatar.current) {\n            this.http.post(AppData.Configuration.app.uris.files + \"avatars\", JSON.stringify({ \"Data\": this.cropper.data.image }), {\n                headers: AppAPI.getHeaders({\n                    \"content-type\": \"application/json\",\n                    \"x-as-base64\": \"yes\"\n                })\n            })\n                .map(function (response) { return response.json(); })\n                .subscribe(function (data) {\n                _this.info.avatar.uploaded = data.Uri;\n                _this.cropper.data = {\n                    image: data.Uri,\n                    original: undefined\n                };\n                onCompleted && onCompleted();\n            }, function (error) {\n                console.error(\"Error occurred while uploading avatar image\", error);\n                onCompleted && onCompleted();\n            });\n        }\n        else {\n            onCompleted && onCompleted();\n        }\n    };\n    ProfilePage.prototype.changeAvatar = function (event) {\n        var _this = this;\n        var image = new Image();\n        var file = event.target.files[0];\n        var reader = new FileReader();\n        reader.onloadend = function (loadEvent) {\n            image.src = loadEvent.target.result;\n            _this.cropperCtrl.setImage(image);\n        };\n        reader.readAsDataURL(file);\n    };\n    ProfilePage.prototype.doChangePassword = function () {\n        var _this = this;\n        var setFocus = function () {\n            AppUtility.focus(!AppUtility.isNotEmpty(_this.info.change.OldPassword)\n                ? _this.oldPasswordCtrl\n                : !AppUtility.isNotEmpty(_this.info.change.Password)\n                    ? _this.newPasswordCtrl\n                    : _this.confirmNewPasswordCtrl, _this.keyboard);\n        };\n        this.info.state.valid = AppUtility.isNotEmpty(this.info.change.OldPassword)\n            && AppUtility.isNotEmpty(this.info.change.Password) && AppUtility.isNotEmpty(this.info.change.ConfirmPassword)\n            && this.info.change.ConfirmPassword == this.info.change.Password;\n        if (this.info.state.valid) {\n            this.showLoading(\"Đổi mật khẩu đăng nhập...\");\n            this.info.state.processing = true;\n            this.authSvc.updatePasswordAsync(this.info.change.OldPassword, this.info.change.Password, function () {\n                _this.showAlert(\"Đổi mật khẩu\", \"Mật khẩu đăng nhập mới đã được cập nhật thành công!\", function () {\n                    _this.info.change.OldPassword = \"\";\n                    _this.info.change.Password = \"\";\n                    _this.info.change.ConfirmPassword = \"\";\n                    _this.cancelUpdate();\n                });\n            }, function (error) {\n                _this.showError(error, setFocus);\n            });\n        }\n        else {\n            setFocus();\n        }\n    };\n    ProfilePage.prototype.doChangeEmail = function () {\n        var _this = this;\n        var setFocus = function () {\n            AppUtility.focus(!AppUtility.isNotEmpty(_this.info.change.OldPassword)\n                ? _this.oldPasswordCtrl\n                : !AppUtility.isNotEmpty(_this.info.change.Email)\n                    ? _this.newEmailCtrl\n                    : _this.confirmNewEmailCtrl, _this.keyboard);\n        };\n        this.info.state.valid = AppUtility.isNotEmpty(this.info.change.OldPassword)\n            && AppUtility.isNotEmpty(this.info.change.Email) && AppUtility.isNotEmpty(this.info.change.ConfirmEmail)\n            && this.info.change.ConfirmEmail == this.info.change.Email;\n        if (this.info.state.valid) {\n            this.showLoading(\"Đổi email đăng nhập...\");\n            this.info.state.processing = true;\n            this.authSvc.updateEmailAsync(this.info.change.OldPassword, this.info.change.Email, function () {\n                _this.showAlert(\"Đổi email\", \"Email đăng nhập mới đã được cập nhật thành công!\", function () {\n                    _this.info.change.OldPassword = \"\";\n                    _this.info.change.Email = \"\";\n                    _this.info.change.ConfirmEmail = \"\";\n                    _this.cancelUpdate();\n                });\n            }, function (error) {\n                _this.showError(error, setFocus);\n            });\n        }\n        else {\n            setFocus();\n        }\n    };\n    ProfilePage.prototype.doSetPrivileges = function () {\n        var _this = this;\n        var info = {\n            Privileges: new List(this.info.permissions.objects)\n                .Select(function (o) { return AppModels.Privilege.deserialize({\n                ServiceName: \"books\",\n                ObjectName: o.value,\n                Role: _this.info.permissions.privileges[o.value]\n            }); })\n                .ToArray()\n        };\n        this.showLoading(\"Đặt quyền truy cập...\");\n        this.info.state.processing = true;\n        this.authSvc.setPrivilegesAsync(this.info.profile.ID, info, function (data) {\n            _this.preparePrivileges(data);\n            _this.cancelUpdate();\n        }, function (error) {\n            _this.showError(error);\n        });\n    };\n    // sign-out\n    ProfilePage.prototype.doSignOut = function () {\n        var _this = this;\n        this.alertCtrl.create({\n            title: \"Đăng xuất\",\n            message: \"Đăng xuất khỏi hệ thống?\",\n            enableBackdropDismiss: false,\n            buttons: [\n                {\n                    text: \"Huỷ bỏ\",\n                    role: \"cancel\"\n                },\n                {\n                    text: \"Đăng xuất\",\n                    handler: function () {\n                        _this.authSvc.signOutAsync(function () {\n                            AppEvents.broadcast(\"OpenPage\", {\n                                name: \"HomePage\",\n                                component: HomePage,\n                                doPush: false\n                            });\n                        }, function (error) {\n                            _this.showError(error);\n                        });\n                    }\n                }\n            ]\n        }).present();\n    };\n    // bookmarks\n    ProfilePage.prototype.buildBookmakrs = function () {\n        this.info.bookmarks = new List(AppData.Configuration.reading.bookmarks.values())\n            .Where(function (b) { return AppData.Books.getValue(b.ID) != undefined; })\n            .Select(function (b) {\n            var book = AppData.Books.getValue(b.ID);\n            return {\n                id: b.ID,\n                title: book.Title + (book.Author != \"\" ? \" - \" + book.Author : \"\"),\n                position: (b.Chapter > 0 ? \"Chương: \" + b.Chapter + \" - \" : \"\") + \"Vị trí: \" + b.Position,\n                time: b.Time\n            };\n        })\n            .OrderByDescending(function (b) { return b.time; })\n            .ToArray();\n    };\n    ProfilePage.prototype.trackBookmark = function (index, bookmark) {\n        return bookmark.id;\n    };\n    ProfilePage.prototype.openBookmark = function (id) {\n        this.navCtrl.pop();\n        this.navCtrl.push(ReadBookPage, { ID: id });\n    };\n    ProfilePage.prototype.deleteBookmark = function (id) {\n        var _this = this;\n        this.configSvc.deleteBookmark(id, function () {\n            _this.buildBookmakrs();\n        });\n    };\n    return ProfilePage;\n}());\n__decorate([\n    ViewChild(\"name\"),\n    __metadata(\"design:type\", typeof (_a = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _a || Object)\n], ProfilePage.prototype, \"nameCtrl\", void 0);\n__decorate([\n    ViewChild(\"email\"),\n    __metadata(\"design:type\", typeof (_b = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _b || Object)\n], ProfilePage.prototype, \"emailCtrl\", void 0);\n__decorate([\n    ViewChild(\"confirmEmail\"),\n    __metadata(\"design:type\", typeof (_c = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _c || Object)\n], ProfilePage.prototype, \"confirmEmailCtrl\", void 0);\n__decorate([\n    ViewChild(\"password\"),\n    __metadata(\"design:type\", typeof (_d = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _d || Object)\n], ProfilePage.prototype, \"passwordCtrl\", void 0);\n__decorate([\n    ViewChild(\"confirmPassword\"),\n    __metadata(\"design:type\", typeof (_e = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _e || Object)\n], ProfilePage.prototype, \"confirmPasswordCtrl\", void 0);\n__decorate([\n    ViewChild(\"gender\"),\n    __metadata(\"design:type\", typeof (_f = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _f || Object)\n], ProfilePage.prototype, \"genderCtrl\", void 0);\n__decorate([\n    ViewChild(\"birthDay\"),\n    __metadata(\"design:type\", typeof (_g = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _g || Object)\n], ProfilePage.prototype, \"birthDayCtrl\", void 0);\n__decorate([\n    ViewChild(\"address\"),\n    __metadata(\"design:type\", typeof (_h = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _h || Object)\n], ProfilePage.prototype, \"addressCtrl\", void 0);\n__decorate([\n    ViewChild(\"addresses\"),\n    __metadata(\"design:type\", typeof (_j = typeof CompleterCmp !== \"undefined\" && CompleterCmp) === \"function\" && _j || Object)\n], ProfilePage.prototype, \"addressesCtrl\", void 0);\n__decorate([\n    ViewChild(\"mobile\"),\n    __metadata(\"design:type\", typeof (_k = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _k || Object)\n], ProfilePage.prototype, \"mobileCtrl\", void 0);\n__decorate([\n    ViewChild(\"captcha\"),\n    __metadata(\"design:type\", typeof (_l = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _l || Object)\n], ProfilePage.prototype, \"captchaCtrl\", void 0);\n__decorate([\n    ViewChild(\"oldPassword\"),\n    __metadata(\"design:type\", typeof (_m = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _m || Object)\n], ProfilePage.prototype, \"oldPasswordCtrl\", void 0);\n__decorate([\n    ViewChild(\"newPassword\"),\n    __metadata(\"design:type\", typeof (_o = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _o || Object)\n], ProfilePage.prototype, \"newPasswordCtrl\", void 0);\n__decorate([\n    ViewChild(\"confirmNewPassword\"),\n    __metadata(\"design:type\", typeof (_p = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _p || Object)\n], ProfilePage.prototype, \"confirmNewPasswordCtrl\", void 0);\n__decorate([\n    ViewChild(\"newEmail\"),\n    __metadata(\"design:type\", typeof (_q = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _q || Object)\n], ProfilePage.prototype, \"newEmailCtrl\", void 0);\n__decorate([\n    ViewChild(\"confirmNewEmail\"),\n    __metadata(\"design:type\", typeof (_r = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _r || Object)\n], ProfilePage.prototype, \"confirmNewEmailCtrl\", void 0);\n__decorate([\n    ViewChild(\"changeCaptcha\"),\n    __metadata(\"design:type\", typeof (_s = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _s || Object)\n], ProfilePage.prototype, \"changeCaptchaCtrl\", void 0);\n__decorate([\n    ViewChild(\"guestname\"),\n    __metadata(\"design:type\", typeof (_t = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _t || Object)\n], ProfilePage.prototype, \"guestnameCtrl\", void 0);\n__decorate([\n    ViewChild(\"guestemail\"),\n    __metadata(\"design:type\", typeof (_u = typeof TextInput !== \"undefined\" && TextInput) === \"function\" && _u || Object)\n], ProfilePage.prototype, \"guestemailCtrl\", void 0);\n__decorate([\n    ViewChild(\"avatarcropper\"),\n    __metadata(\"design:type\", typeof (_v = typeof ImageCropperComponent !== \"undefined\" && ImageCropperComponent) === \"function\" && _v || Object)\n], ProfilePage.prototype, \"cropperCtrl\", void 0);\n__decorate([\n    ViewChild(Content),\n    __metadata(\"design:type\", typeof (_w = typeof Content !== \"undefined\" && Content) === \"function\" && _w || Object)\n], ProfilePage.prototype, \"contentCtrl\", void 0);\nProfilePage = __decorate([\n    Component({\n        selector: \"page-profile\",\n        templateUrl: \"profile.html\",\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_x = typeof Http !== \"undefined\" && Http) === \"function\" && _x || Object, typeof (_y = typeof NavController !== \"undefined\" && NavController) === \"function\" && _y || Object, typeof (_z = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _z || Object, typeof (_0 = typeof ViewController !== \"undefined\" && ViewController) === \"function\" && _0 || Object, typeof (_1 = typeof ActionSheetController !== \"undefined\" && ActionSheetController) === \"function\" && _1 || Object, typeof (_2 = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _2 || Object, typeof (_3 = typeof LoadingController !== \"undefined\" && LoadingController) === \"function\" && _3 || Object, typeof (_4 = typeof CompleterService !== \"undefined\" && CompleterService) === \"function\" && _4 || Object, typeof (_5 = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _5 || Object, typeof (_6 = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _6 || Object, typeof (_7 = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _7 || Object])\n], ProfilePage);\nexport { ProfilePage };\nvar _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4, _5, _6, _7;\n//# sourceMappingURL=profile.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/accounts/profile/profile.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Injectable } from \"@angular/core\";\nimport { Http } from \"@angular/http\";\nimport { List } from \"linqts\";\nimport \"rxjs/add/operator/map\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppAPI } from \"../helpers/api\";\nimport { AppData } from \"../models/data\";\nimport { AppModels } from \"../models/objects\";\nvar AccountsService = (function () {\n    function AccountsService(http) {\n        this.http = http;\n        AppAPI.setHttp(this.http);\n    }\n    /** Checks to see the user is online or not */\n    AccountsService.prototype.isOnline = function (id) {\n        var account = AppUtility.isNotEmpty(id)\n            ? AppData.Accounts.getValue(id)\n            : undefined;\n        return account != undefined && account.IsOnline;\n    };\n    /** Performs a request to REST API to search account profiles */\n    AccountsService.prototype.search = function (request, onNext, onError) {\n        var pagination = AppData.Paginations.get(request, \"A\");\n        if (pagination != null && pagination.PageNumber >= pagination.TotalPages) {\n            onNext != undefined && onNext();\n            return;\n        }\n        request.Pagination.PageNumber++;\n        var path = \"users/profile/search\"\n            + \"?x-request=\" + AppUtility.getBase64UrlParam(request)\n            + \"&related-service=books\"\n            + \"&language=vi-VN\";\n        var searcher = AppAPI.Get(path);\n        if (!onNext) {\n            return searcher;\n        }\n        searcher.map(function (response) { return response.json(); }).subscribe(function (data) {\n            if (!AppUtility.isObject(data, true)) {\n                onError != undefined && onError(data);\n            }\n            else if (data.Status == \"OK\") {\n                AppData.Paginations.set(data.Data, \"A\");\n                new List(data.Data.Objects).ForEach(function (a) { return AppModels.Account.update(a); });\n                onNext(data);\n            }\n            else {\n                console.error(\"[Accounts]: Error occurred while searching accounts\");\n                AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                onError != undefined && onError(data);\n            }\n        }, function (error) {\n            console.error(\"[Accounts]: Error occurred while searching accounts\", error);\n            onError != undefined && onError(error);\n        });\n    };\n    AccountsService.prototype.fetchAsync = function (accountIDs, onNext, onError) {\n        return __awaiter(this, void 0, void 0, function () {\n            var ids, path, response, data, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        ids = new List(accountIDs).Except(new List(AppData.Accounts.keys())).ToArray();\n                        if (ids.length < 1) {\n                            onNext != undefined && onNext();\n                            return [2 /*return*/];\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        path = \"users/profile/fetch\"\n                            + \"?x-request=\" + AppUtility.getBase64UrlParam({ IDs: ids })\n                            + \"&related-service=books\"\n                            + \"&language=vi-VN\";\n                        return [4 /*yield*/, AppAPI.GetAsync(path)];\n                    case 2:\n                        response = _a.sent();\n                        data = response.json();\n                        if (data.Status == \"OK\") {\n                            new List(data.Data.Objects).ForEach(function (a) { return AppModels.Account.update(a); });\n                            onNext != undefined && onNext(data);\n                        }\n                        else {\n                            console.error(\"[Accounts]: Error occurred while searching accounts\");\n                            AppUtility.isObject(data.Error, true) && console.log(\"[\" + data.Error.Type + \"]: \" + data.Error.Message);\n                            onError != undefined && onError(data);\n                        }\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        console.error(\"[Accounts]: Error occurred while searching accounts\", e_1);\n                        onError != undefined && onError(e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return AccountsService;\n}());\nAccountsService = __decorate([\n    Injectable(),\n    __metadata(\"design:paramtypes\", [typeof (_a = typeof Http !== \"undefined\" && Http) === \"function\" && _a || Object])\n], AccountsService);\nexport { AccountsService };\nvar _a;\n//# sourceMappingURL=accounts.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/providers/accounts.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { NavController, NavParams, ActionSheetController, AlertController, Searchbar } from \"ionic-angular\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../../../helpers/utility\";\nimport { AppData } from \"../../../models/data\";\nimport { AppModels } from \"../../../models/objects\";\nimport { AuthenticationService } from \"../../../providers/authentication\";\nimport { AccountsService } from \"../../../providers/accounts\";\nimport { ProfilePage } from \"../profile/profile\";\nvar SearchProfilesPage = (function () {\n    function SearchProfilesPage(navCtrl, navParams, actionSheetCtrl, alertCtrl, keyboard, authSvc, accountsSvc) {\n        this.navCtrl = navCtrl;\n        this.navParams = navParams;\n        this.actionSheetCtrl = actionSheetCtrl;\n        this.alertCtrl = alertCtrl;\n        this.keyboard = keyboard;\n        this.authSvc = authSvc;\n        this.accountsSvc = accountsSvc;\n        // attributes\n        this.info = {\n            filterBy: {\n                Query: \"\",\n                And: {\n                    Province: {\n                        Equals: undefined\n                    }\n                }\n            },\n            sortBy: \"\",\n            pagination: AppData.Paginations.default(),\n            state: {\n                searching: false,\n                filtering: false,\n                cancel: \"Đóng\",\n                holder: \"Search\"\n            },\n            title: \"Tài khoản người dùng\",\n            totalRecords: 0,\n            pageNumber: 0,\n            isAppleOS: AppUtility.isAppleOS()\n        };\n        this.sorts = [];\n        this.accounts = undefined;\n        this.ratings = {};\n        this.infiniteScrollCtrl = undefined;\n    }\n    // page events\n    SearchProfilesPage.prototype.ionViewDidLoad = function () {\n        this.sorts = [\n            {\n                label: \"Tên (A - Z)\",\n                value: \"Name\"\n            },\n            {\n                label: \"Mới truy cập\",\n                value: \"LastAccess\"\n            },\n            {\n                label: \"Mới đăng ký\",\n                value: \"Registered\"\n            }\n        ];\n        this.info.sortBy = this.sorts[0].value;\n        this.info.filterBy.Query = this.navParams.get(\"Query\");\n        this.info.filterBy.And.Province.Equals = this.navParams.get(\"Province\");\n        this.info.filterBy.And.Province.Equals = this.info.filterBy.And.Province.Equals || \"\";\n    };\n    SearchProfilesPage.prototype.ionViewCanEnter = function () {\n        return this.authSvc.isSystemAdministrator();\n    };\n    SearchProfilesPage.prototype.ionViewDidEnter = function () {\n        if (!this.accounts) {\n            var request = AppData.buildRequest(this.info.filterBy, undefined, AppUtility.isNotEmpty(this.info.filterBy.Query) ? undefined : this.info.pagination, function (r) {\n                if (!AppUtility.isNotEmpty(r.FilterBy.And.Province.Equals)) {\n                    r.FilterBy.And.Province.Equals = undefined;\n                }\n            });\n            this.info.pagination = AppData.Paginations.get(request, \"A\");\n            if (this.info.pagination == undefined) {\n                this.doSearch();\n            }\n            else {\n                if (this.info.pageNumber < 1) {\n                    this.info.pageNumber = 1;\n                    this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                }\n                this.doBuild();\n            }\n        }\n    };\n    // search & build the listing of account profiles\n    SearchProfilesPage.prototype.doSearch = function (onCompleted) {\n        var _this = this;\n        var request = AppData.buildRequest(this.info.filterBy, undefined, AppUtility.isNotEmpty(this.info.filterBy.Query) ? undefined : this.info.pagination, function (r) {\n            if (!AppUtility.isNotEmpty(r.FilterBy.And.Province.Equals)) {\n                r.FilterBy.And.Province.Equals = undefined;\n            }\n        });\n        this.accountsSvc.search(request, function (data) {\n            _this.info.pagination = _this.info.state.searching && data != undefined\n                ? AppData.Paginations.default(data.Data)\n                : AppData.Paginations.get(request, \"A\");\n            if (!_this.info.state.searching && !_this.info.state.filtering) {\n                _this.info.pageNumber = _this.info.pagination.PageNumber;\n                _this.info.totalRecords = AppData.Paginations.computeTotal(_this.info.pageNumber, _this.info.pagination);\n            }\n            _this.doBuild(_this.info.state.searching && data != undefined ? data.Data.Objects : undefined);\n            onCompleted != undefined && onCompleted();\n        });\n    };\n    SearchProfilesPage.prototype.doBuild = function (searchResults) {\n        var _this = this;\n        // initialize the list\n        var accounts = new List(searchResults != undefined\n            ? searchResults\n            : AppData.Accounts.values());\n        // apply filter-by\n        if (this.info.state.filtering && AppUtility.isNotEmpty(this.info.filterBy.Query)) {\n            var query_1 = AppUtility.toANSI(this.info.filterBy.Query).trim().toLowerCase();\n            accounts = accounts.Where(function (a) { return AppUtility.indexOf(a.Title, query_1) > -1; });\n        }\n        // transform\n        if (searchResults != undefined) {\n            accounts = accounts.Select(function (a) { return AppModels.Account.deserialize(a); });\n        }\n        // apply order-by\n        switch (this.info.sortBy) {\n            case \"LastAccess\":\n                accounts = accounts.OrderByDescending(function (a) { return a.LastAccess; }).ThenBy(function (a) { return a.Name; });\n                break;\n            case \"Joined\":\n                accounts = accounts.OrderByDescending(function (a) { return a.Joined; }).ThenBy(function (a) { return a.Name; });\n                break;\n            default:\n                accounts = accounts.OrderBy(function (a) { return a.Name; }).ThenByDescending(function (a) { return a.LastAccess; });\n                break;\n        }\n        // paging\n        if (!this.info.state.searching && !this.info.state.filtering && this.info.pageNumber > 0) {\n            accounts = accounts.Take(this.info.pageNumber * (this.info.pagination != undefined ? this.info.pagination.PageSize : 20));\n        }\n        // convert the list of results to array\n        this.accounts = accounts.ToArray();\n        // prepare ratings\n        new List(this.accounts).ForEach(function (a) {\n            if (!_this.ratings[a.ID]) {\n                var rating = a.RatingPoints.getValue(\"General\");\n                _this.ratings[a.ID] = rating != undefined ? rating.Average : 0;\n            }\n        });\n    };\n    SearchProfilesPage.prototype.trackBy = function (index, account) {\n        return account.ID;\n    };\n    // event handlers\n    SearchProfilesPage.prototype.onInfiniteScroll = function (infiniteScroll) {\n        var _this = this;\n        // capture\n        if (this.infiniteScrollCtrl == undefined) {\n            this.infiniteScrollCtrl = infiniteScroll;\n        }\n        // searching\n        if (this.info.state.searching && AppUtility.isNotEmpty(this.info.filterBy.Query)) {\n            if (this.info.pagination.PageNumber < this.info.pagination.TotalPages) {\n                this.doSearch(function () {\n                    _this.infiniteScrollCtrl.complete();\n                });\n            }\n            else {\n                this.infiniteScrollCtrl.complete();\n                this.infiniteScrollCtrl.enable(false);\n            }\n        }\n        else if (this.info.state.filtering) {\n            this.infiniteScrollCtrl.complete();\n            this.infiniteScrollCtrl.enable(false);\n        }\n        else {\n            if (this.info.pageNumber < this.info.pagination.PageNumber) {\n                this.info.pageNumber++;\n                this.info.totalRecords = AppData.Paginations.computeTotal(this.info.pageNumber, this.info.pagination);\n                this.doBuild();\n                this.infiniteScrollCtrl.complete();\n            }\n            else if (this.info.pagination.PageNumber < this.info.pagination.TotalPages) {\n                this.doSearch(function () {\n                    _this.infiniteScrollCtrl.complete();\n                });\n            }\n            else {\n                this.infiniteScrollCtrl.complete();\n                this.infiniteScrollCtrl.enable(false);\n            }\n        }\n    };\n    SearchProfilesPage.prototype.onSearch = function () {\n        if (this.info.state.searching) {\n            this.accounts = [];\n            if (AppUtility.isNotEmpty(this.info.filterBy.Query)) {\n                this.doSearch();\n            }\n        }\n        else {\n            this.doBuild();\n        }\n    };\n    SearchProfilesPage.prototype.onCancel = function () {\n        this.info.state.searching = false;\n        this.info.state.filtering = false;\n        this.info.filterBy.Query = \"\";\n        this.info.pagination = AppData.Paginations.get(AppData.buildRequest(this.info.filterBy, null, this.info.pagination), \"A\");\n        this.doBuild();\n        if (this.infiniteScrollCtrl != undefined) {\n            this.infiniteScrollCtrl.enable(true);\n        }\n    };\n    // helpers\n    SearchProfilesPage.prototype.getAvatar = function (account) {\n        return AppUtility.getAvatarImage(account);\n    };\n    SearchProfilesPage.prototype.openProfile = function (account) {\n        this.navCtrl.push(ProfilePage, { ID: account.ID });\n    };\n    SearchProfilesPage.prototype.showSearch = function () {\n        this.accounts = [];\n        this.info.pagination = null;\n        this.info.state.searching = true;\n        this.info.state.holder = \"Tìm kiếm (không dấu cũng OK)\";\n        AppUtility.focus(this.searchBarCtrl, this.keyboard);\n    };\n    SearchProfilesPage.prototype.showActions = function () {\n        var _this = this;\n        var actionSheet = this.actionSheetCtrl.create({\n            enableBackdropDismiss: true,\n            buttons: [\n                {\n                    text: \"Tìm kiếm\",\n                    icon: this.info.isAppleOS ? undefined : \"search\",\n                    handler: function () {\n                        _this.showSearch();\n                    }\n                },\n                {\n                    text: \"Lọc/Tìm nhanh\",\n                    icon: this.info.isAppleOS ? undefined : \"funnel\",\n                    handler: function () {\n                        _this.info.state.filtering = true;\n                        _this.info.state.holder = \"Tìm nhanh (không dấu cũng OK)\";\n                        AppUtility.focus(_this.searchBarCtrl, _this.keyboard);\n                    }\n                },\n                {\n                    text: \"Thay đổi cách sắp xếp\",\n                    icon: this.info.isAppleOS ? undefined : \"list-box\",\n                    handler: function () {\n                        _this.showSorts();\n                    }\n                }\n            ]\n        });\n        if (this.info.pagination != null && this.info.pageNumber < this.info.pagination.PageNumber) {\n            actionSheet.addButton({\n                text: \"Hiển thị toàn bộ \" + AppData.Paginations.computeTotal(this.info.pagination.PageNumber, this.info.pagination) + \" kết quả\",\n                icon: this.info.isAppleOS ? undefined : \"eye\",\n                handler: function () {\n                    _this.info.pageNumber = _this.info.pagination.PageNumber;\n                    _this.info.totalRecords = AppData.Paginations.computeTotal(_this.info.pageNumber, _this.info.pagination);\n                    _this.doBuild();\n                }\n            });\n        }\n        actionSheet.addButton({\n            text: \"Huỷ bỏ\",\n            icon: this.info.isAppleOS ? undefined : \"close\",\n            role: \"cancel\"\n        });\n        actionSheet.present();\n    };\n    SearchProfilesPage.prototype.showSorts = function () {\n        var _this = this;\n        var alert = this.alertCtrl.create({\n            title: \"Sắp xếp theo\",\n            enableBackdropDismiss: true,\n            buttons: [\n                {\n                    text: \"Huỷ\",\n                    role: \"cancel\"\n                },\n                {\n                    text: \"Đặt\",\n                    handler: function (sortBy) {\n                        if (_this.info.sortBy != sortBy) {\n                            _this.info.sortBy = sortBy;\n                            _this.doBuild();\n                        }\n                    }\n                }\n            ]\n        });\n        new List(this.sorts).ForEach(function (o) {\n            alert.addInput({\n                type: \"radio\",\n                label: o.label,\n                value: o.value,\n                checked: _this.info.sortBy == o.value\n            });\n        });\n        alert.present();\n    };\n    return SearchProfilesPage;\n}());\n__decorate([\n    ViewChild(Searchbar),\n    __metadata(\"design:type\", typeof (_a = typeof Searchbar !== \"undefined\" && Searchbar) === \"function\" && _a || Object)\n], SearchProfilesPage.prototype, \"searchBarCtrl\", void 0);\nSearchProfilesPage = __decorate([\n    Component({\n        selector: \"page-search-accounts\",\n        templateUrl: \"search.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_b = typeof NavController !== \"undefined\" && NavController) === \"function\" && _b || Object, typeof (_c = typeof NavParams !== \"undefined\" && NavParams) === \"function\" && _c || Object, typeof (_d = typeof ActionSheetController !== \"undefined\" && ActionSheetController) === \"function\" && _d || Object, typeof (_e = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _e || Object, typeof (_f = typeof Keyboard !== \"undefined\" && Keyboard) === \"function\" && _f || Object, typeof (_g = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _g || Object, typeof (_h = typeof AccountsService !== \"undefined\" && AccountsService) === \"function\" && _h || Object])\n], SearchProfilesPage);\nexport { SearchProfilesPage };\nvar _a, _b, _c, _d, _e, _f, _g, _h;\n//# sourceMappingURL=search.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/pages/accounts/search/search.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Component, ViewChild } from \"@angular/core\";\nimport { Platform, MenuController, Nav, AlertController, LoadingController } from \"ionic-angular\";\nimport { StatusBar } from \"@ionic-native/status-bar\";\nimport { SplashScreen } from \"@ionic-native/splash-screen\";\nimport { Storage } from \"@ionic/storage\";\nimport { Device } from \"@ionic-native/device\";\nimport { List } from \"linqts\";\nimport { AppUtility } from \"../helpers/utility\";\nimport { AppEvents } from \"../helpers/events\";\nimport { AppRTU } from \"../helpers/rtu\";\nimport { AppCrypto } from \"../helpers/crypto\";\nimport { AppData } from \"../models/data\";\nimport { ConfigurationService } from \"../providers/configuration\";\nimport { AuthenticationService } from \"../providers/authentication\";\nimport { BooksService } from \"../providers/books\";\nimport { StatisticsService } from \"../providers/statistics\";\nimport { ResourcesService } from \"../providers/resources\";\nimport { HomePage } from \"../pages/home/home\";\nimport { SignInPage } from \"../pages/accounts/signin/signin\";\nimport { ProfilePage } from \"../pages/accounts/profile/profile\";\nimport { SearchProfilesPage } from \"../pages/accounts/search/search\";\nimport { SearchPage } from \"../pages/search/search\";\nimport { SurfBooksPage } from \"../pages/books/surf/surf\";\nimport { ReadBookPage } from \"../pages/books/read/read\";\nvar App = (function () {\n    function App(platform, device, menu, statusBar, splashScreen, alertCtrl, loadingCtrl, storage, configSvc, authSvc, statisticsSvc, resourcesSvc, booksSvc) {\n        var _this = this;\n        this.platform = platform;\n        this.device = device;\n        this.menu = menu;\n        this.statusBar = statusBar;\n        this.splashScreen = splashScreen;\n        this.alertCtrl = alertCtrl;\n        this.loadingCtrl = loadingCtrl;\n        this.storage = storage;\n        this.configSvc = configSvc;\n        this.authSvc = authSvc;\n        this.statisticsSvc = statisticsSvc;\n        this.resourcesSvc = resourcesSvc;\n        this.booksSvc = booksSvc;\n        // attributes\n        this.info = {\n            nav: {\n                start: HomePage,\n                previous: {\n                    name: \"\",\n                    component: undefined,\n                    params: undefined\n                },\n                active: {\n                    name: \"HomePage\",\n                    component: undefined,\n                    params: undefined\n                }\n            },\n            title: {\n                avatar: undefined,\n                top: \"Menu\",\n                main: \"Chính\",\n                sub: \"Thể loại\"\n            },\n            category: {\n                index: -1,\n                parent: {\n                    index: -1,\n                    title: \"\"\n                }\n            },\n            book: {\n                id: \"\",\n                title: \"\",\n                chapter: 0\n            },\n            iOSPWA: false,\n            startupURI: \"\",\n            attemps: 0\n        };\n        this.pages = [];\n        this.categories = [];\n        this.chapters = [];\n        this.loading = undefined;\n        // show loading\n        this.loading = this.loadingCtrl.create({\n            content: \"Tải dữ liệu...\"\n        });\n        this.loading.present();\n        // setup event handlers\n        this.setupEvents();\n        // run initialize process when ready\n        this.platform.ready().then(function () {\n            // prepare\n            _this.info.startupURI = _this.platform.url();\n            _this.statusBar.styleDefault();\n            _this.splashScreen.hide();\n            // make sure the storage is ready\n            _this.storage.ready().then(function () {\n                AppUtility.isDebug() && console.info(\"<Startup>: The storage is ready for serving...\");\n            });\n            // prepare environment\n            _this.configSvc.prepare();\n            _this.info.title.top = AppData.Configuration.app.name;\n            _this.info.iOSPWA = AppData.Configuration.app.platform == \"iOS PWA\";\n            // build the listing of pages\n            _this.buildPages();\n            // load statistics\n            _this.statisticsSvc.loadStatisticsAsync();\n            // run initialize process\n            var prego = AppUtility.isWebApp()\n                ? _this.platform.getQueryParam(\"prego\")\n                : \"\";\n            switch (prego) {\n                case \"activate\":\n                    _this.activate();\n                    break;\n                default:\n                    _this.initialize();\n                    break;\n            }\n        });\n    }\n    // set-up events\n    App.prototype.setupEvents = function () {\n        var _this = this;\n        // events of page/view navigation\n        AppEvents.on(\"OpenHomePage\", function () {\n            _this.navigateToHomePage();\n        });\n        AppEvents.on(\"OpenPreviousPage\", function () {\n            _this.navigateToPreviousPage();\n        });\n        AppEvents.on(\"OpenPage\", function (info) {\n            if (AppUtility.isObject(info, true) != null && AppUtility.isObject(info.args, true)) {\n                _this.navigate(info.args.name, info.args.component, info.args.params, info.args.doPush, info.args.popIfContains, info.args.noNestedStack);\n            }\n        });\n        AppEvents.on(\"UpdateActiveNav\", function (info) {\n            if (AppUtility.isObject(info, true) != null && AppUtility.isObject(info.args, true)) {\n                _this.updateActiveNav(info.args.name, info.args.component, info.args.params);\n            }\n        });\n        AppEvents.on(\"SetPreviousPageActive\", function (info) {\n            var previous = (AppUtility.isObject(info, true) != null && AppUtility.isObject(info.args, true))\n                ? info.args.current\n                : undefined;\n            if (_this.info.nav.previous.name != previous) {\n                _this.updateActiveNav(_this.info.nav.previous.name, _this.info.nav.previous.component, _this.info.nav.previous.params);\n            }\n        });\n        // events to update avatar/title of side menu\n        AppEvents.on(\"SessionIsRegistered\", function () {\n            _this.updateSidebar();\n            _this.buildPages();\n        });\n        AppEvents.on(\"AccountIsUpdated\", function () {\n            _this.updateSidebar();\n            _this.buildPages();\n        });\n        // events to show categories\n        AppEvents.on(\"CategoriesAreUpdated\", function (info) {\n            _this.showCategories();\n        });\n        AppEvents.on(\"CloseBook\", function () {\n            _this.info.book.id = \"\";\n            _this.chapters = [];\n        });\n        // events to show chapters of a book\n        AppEvents.on(\"OpenBook\", function (info) {\n            if (AppUtility.isObject(info, true) != null && AppUtility.isObject(info.args, true)) {\n                _this.info.book.id = info.args.ID;\n                _this.info.book.chapter = info.args.Chapter;\n                _this.info.book.id == info.args.ID && _this.showChapters();\n            }\n        });\n    };\n    // navigation\n    App.prototype.navigate = function (name, component, params, doPush, popIfContains, noNestedStack) {\n        if (AppUtility.isTrue(doPush)) {\n            if (this.info.nav.active.name != name || AppUtility.isFalse(noNestedStack)) {\n                if (AppUtility.indexOf(popIfContains, this.info.nav.active.name) > -1) {\n                    this.nav.pop();\n                }\n                else {\n                    this.updatePreviousNav(this.info.nav.active.name, this.nav.getActive().component, this.nav.getActive().getNavParams().data);\n                }\n                this.updateActiveNav(name, component, params);\n                this.nav.push(component, params);\n            }\n        }\n        else {\n            if (this.info.nav.active.name != name) {\n                this.updatePreviousNav(this.info.nav.active.name, this.nav.getActive().component, this.nav.getActive().getNavParams().data);\n            }\n            this.updateActiveNav(name, component, params);\n            this.nav.setRoot(component, params);\n        }\n    };\n    App.prototype.navigateToHomePage = function () {\n        this.updatePreviousNav(undefined, undefined);\n        this.updateActiveNav(\"HomePage\", this.info.nav.start);\n        this.nav.setRoot(this.info.nav.start);\n    };\n    App.prototype.navigateToPreviousPage = function () {\n        var name = AppUtility.isNotEmpty(this.info.nav.previous.name)\n            ? this.info.nav.previous.name\n            : \"HomePage\";\n        var component = AppUtility.isNotNull(this.info.nav.previous.component)\n            ? this.info.nav.previous.component\n            : this.info.nav.start;\n        var params = AppUtility.isNotNull(this.info.nav.previous.params)\n            ? this.info.nav.previous.params\n            : undefined;\n        this.updatePreviousNav(undefined, undefined);\n        this.updateActiveNav(name, component, params);\n        this.nav.setRoot(component, params);\n    };\n    App.prototype.updatePreviousNav = function (name, component, params) {\n        this.info.nav.previous = {\n            name: name,\n            component: component,\n            params: params\n        };\n    };\n    App.prototype.updateActiveNav = function (name, component, params) {\n        this.info.nav.active = {\n            name: name,\n            component: component,\n            params: params\n        };\n    };\n    // activate new account\n    App.prototype.activate = function () {\n        var _this = this;\n        var mode = this.platform.getQueryParam(\"mode\");\n        var code = this.platform.getQueryParam(\"code\");\n        if (AppUtility.isNotEmpty(mode) && AppUtility.isNotEmpty(code)) {\n            this.authSvc.activateAsync(mode, code, function (data) {\n                _this.initialize(function () {\n                    _this.showActivationResults({ Status: \"OK\", Mode: mode });\n                }, true);\n            }, function (data) {\n                _this.initialize(function () {\n                    _this.showActivationResults({ Status: \"Error\", Mode: mode, Error: data.Error });\n                });\n            });\n        }\n        else {\n            this.initialize();\n        }\n    };\n    App.prototype.showActivationResults = function (data) {\n        var _this = this;\n        var title = data.Status == \"OK\"\n            ? \"Kích hoạt thành công\"\n            : \"Lỗi kích hoạt\";\n        var message = data.Status == \"OK\"\n            ? data.Mode == \"account\"\n                ? \"Tài khoản đã được kích hoạt thành công\"\n                : \"Mật khẩu đã được kích hoạt thành công\"\n            : data.Error.Message;\n        this.alertCtrl.create({\n            title: title,\n            message: message,\n            enableBackdropDismiss: false,\n            buttons: [{\n                    text: \"Đóng\",\n                    handler: function () {\n                        if (_this.info.startupURI.indexOf(\"#\") > 0) {\n                            window.location.href = _this.info.startupURI.substring(0, _this.info.startupURI.indexOf(\"#\") + 1);\n                        }\n                    }\n                }]\n        }).present();\n    };\n    // initialize\n    App.prototype.initialize = function (onCompleted, noInitializeSession) {\n        var _this = this;\n        this.configSvc.initializeAsync(function (d) {\n            // got valid sessions, then run next step\n            if (_this.configSvc.isReady() && _this.configSvc.isAuthenticated()) {\n                console.info(\"<Startup>: The session is initialized & registered (user)\");\n                _this.prepare(onCompleted);\n                delete _this.info.attemps;\n            }\n            else {\n                console.info(\"<Startup>: Register the initialized session (anonymous)\", AppData.Configuration.session);\n                _this.configSvc.registerSessionAsync(function () {\n                    console.info(\"<Startup>: The session is registered (anonymous)\");\n                    _this.prepare(onCompleted);\n                    delete _this.info.attemps;\n                }, function (e) {\n                    _this.info.attemps++;\n                    if (AppUtility.isGotSecurityException(e.Error) && _this.info.attemps < 13) {\n                        console.warn(\"<Startup>: Cannot register, the session is need to be re-initialized (anonymous)\");\n                        AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                            var _this = this;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0: return [4 /*yield*/, this.configSvc.deleteSessionAsync(function () {\n                                            AppUtility.setTimeout(function () {\n                                                _this.initialize(onCompleted, noInitializeSession);\n                                            }, 234);\n                                        })];\n                                    case 1:\n                                        _a.sent();\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); });\n                    }\n                    else {\n                        console.error(\"<Startup>: Got an error while initializing\", e);\n                        delete _this.info.attemps;\n                    }\n                });\n            }\n        }, function (e) {\n            _this.info.attemps++;\n            if (AppUtility.isGotSecurityException(e.Error) && _this.info.attemps < 13) {\n                console.warn(\"<Startup>: Cannot initialize, the session is need to be re-initialized (anonymous)\");\n                AppUtility.setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\n                    var _this = this;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0: return [4 /*yield*/, this.configSvc.deleteSessionAsync(function () {\n                                    AppUtility.setTimeout(function () {\n                                        _this.initialize(onCompleted, noInitializeSession);\n                                    }, 234);\n                                })];\n                            case 1:\n                                _a.sent();\n                                return [2 /*return*/];\n                        }\n                    });\n                }); });\n            }\n            else {\n                console.error(\"<Startup>: Got an error while initializing\", e);\n                delete _this.info.attemps;\n            }\n        }, noInitializeSession);\n    };\n    // prepare the app\n    App.prototype.prepare = function (onCompleted) {\n        var _this = this;\n        // special for PWA (Progressive Web Apps) only\n        if (AppUtility.isWebApp()) {\n            // facebook\n            if (AppUtility.isNotEmpty(AppData.Configuration.facebook.id)) {\n                var fbVersion_1 = AppUtility.isNotEmpty(AppData.Configuration.facebook.version) ? AppData.Configuration.facebook.version : \"v2.8\";\n                if (!window.document.getElementById(\"facebook-jssdk\")) {\n                    var js = window.document.createElement(\"script\");\n                    js.id = \"facebook-jssdk\";\n                    js.async = true;\n                    js.src = \"https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=\" + fbVersion_1;\n                    var ref = window.document.getElementsByTagName(\"script\")[0];\n                    ref.parentNode.insertBefore(js, ref);\n                }\n                window[\"fbAsyncInit\"] = function () {\n                    FB.init({\n                        appId: AppData.Configuration.facebook.id,\n                        channelUrl: \"/assets/facebook.html\",\n                        status: true,\n                        cookie: true,\n                        xfbml: true,\n                        version: fbVersion_1\n                    });\n                    this.auth.watchFacebookConnect();\n                };\n            }\n            // scrollbars on Windows\n            if (/Windows/i.test(window.navigator.userAgent)) {\n                var css = window.document.createElement(\"style\");\n                css.type = \"text/css\";\n                css.innerText = \"::-webkit-scrollbar{height:14px;width:10px;background:#eee;border-left:solid1px#ddd;}::-webkit-scrollbar-thumb{background:#ddd;border:solid1px#cfcfcf;}::-webkit-scrollbar-thumb:hover{background:#b2b2b2;border:solid1px#b2b2b2;}::-webkit-scrollbar-thumb:active{background:#b2b2b2;border:solid1px#b2b2b2;}\";\n                var ref = window.document.getElementsByTagName(\"link\")[0];\n                ref.parentNode.insertBefore(css, ref);\n            }\n        }\n        // start the real-time updater\n        AppRTU.start(function () {\n            // get profile\n            if (_this.configSvc.isAuthenticated()) {\n                _this.configSvc.patchAccount(function () {\n                    _this.authSvc.getProfile();\n                }, 345);\n            }\n            // load & get/merge bookmarks\n            _this.configSvc.loadBookmarksAsync();\n            if (_this.configSvc.isAuthenticated()) {\n                _this.configSvc.getBookmarks();\n            }\n            // load reading options\n            _this.configSvc.loadOptionsAsync();\n            // load geo-meta\n            _this.resourcesSvc.loadGeoMetaAsync();\n            // load statistics\n            _this.statisticsSvc.fetchStatistics();\n            // raise an event when done\n            AppEvents.broadcast(\"AppIsInitialized\");\n            console.info(\"<Startup>: The app is initialized\", AppUtility.isDebug() ? AppData.Configuration : \"\");\n            // hide loading\n            _this.loading.dismiss();\n            // callback on completed\n            if (onCompleted != undefined) {\n                onCompleted();\n            }\n            else if (AppUtility.isWebApp() && _this.platform.getQueryParam(\"book\") != undefined) {\n                try {\n                    var params = JSON.parse(AppCrypto.urlDecode(_this.platform.getQueryParam(\"book\")));\n                    AppUtility.isDebug() && console.info(\"<Startup>: Open the requested book\", params);\n                    _this.navigate(\"ReadBookPage\", ReadBookPage, params, true);\n                }\n                catch (e) { }\n            }\n        });\n    };\n    // update side bar (avatar & title)\n    App.prototype.updateSidebar = function () {\n        this.info.title.top = AppData.Configuration.app.name;\n        this.info.title.avatar = undefined;\n        if (this.configSvc.isAuthenticated()) {\n            this.info.title.top = AppUtility.isObject(AppData.Configuration.session.account.profile, true)\n                ? AppData.Configuration.session.account.profile.Name\n                : AppData.Configuration.app.name;\n            this.info.title.avatar = AppUtility.getAvatarImage(AppData.Configuration.session.account.profile);\n        }\n    };\n    // main section (pages)\n    App.prototype.buildPages = function () {\n        this.pages = [\n            { name: \"HomePage\", component: HomePage, title: \"Trang nhất\", icon: \"home\" }\n        ];\n        if (this.configSvc.isAuthenticated()) {\n            this.pages.push({ name: \"ProfilePage\", component: ProfilePage, title: \"Thông tin tài khoản\", icon: \"person\", doPush: true, noNestedStack: true });\n            if (this.authSvc.isSystemAdministrator()) {\n                this.pages.push({ name: \"ProfileListPage\", component: SearchProfilesPage, title: \"Tài khoản người dùng\", icon: \"people\" });\n            }\n        }\n        else {\n            this.pages = this.pages.concat([\n                { name: \"SignInPage\", component: SignInPage, title: \"Đăng nhập\", icon: \"log-in\", doPush: true, popIfContains: \"ProfilePage\", noNestedStack: true },\n                { name: \"ProfilePage\", component: ProfilePage, title: \"Đăng ký tài khoản\", icon: \"person-add\", params: { Register: true }, doPush: true, popIfContains: \"SignInPage\", noNestedStack: true }\n            ]);\n        }\n        this.pages.push({ name: \"SearchPage\", component: SearchPage, title: \"Tìm kiếm\", icon: \"search\" });\n    };\n    App.prototype.isPageActive = function (page) {\n        return this.info.nav.active.name == page.name;\n    };\n    App.prototype.openPage = function (page) {\n        this.navigate(page.name, page.component, page.params, page.doPush, page.popIfContains, page.noNestedStack);\n    };\n    App.prototype.trackPage = function (index, page) {\n        return page.title;\n    };\n    // sub section: categories\n    App.prototype.showCategories = function () {\n        this.categories = new List(AppData.Statistics.Categories)\n            .Select(function (category, index) {\n            return { title: category.Name, index: index, gotChildren: category.Children.length > 0 };\n        })\n            .ToArray();\n    };\n    App.prototype.trackCategory = function (index, category) {\n        return category.index;\n    };\n    App.prototype.isCategoryActive = function (category) {\n        return this.info.category.index == category.index && this.info.nav.active.name == \"SurfBooksPage\";\n    };\n    App.prototype.openCategory = function (category) {\n        var title = category.title;\n        this.info.category.index = category.index;\n        this.navigate(\"SurfBooksPage\", SurfBooksPage, { Category: title });\n    };\n    // sub section: chapters\n    App.prototype.showChapters = function () {\n        var book = AppData.Books.getValue(this.info.book.id);\n        this.info.book.title = book.Title;\n        if (book.TotalChapters > 1) {\n            this.chapters = new List(book.TOCs)\n                .Select(function (toc, index) {\n                return { title: toc, index: index };\n            })\n                .ToArray();\n        }\n    };\n    App.prototype.trackChapter = function (index, chapter) {\n        return chapter.index;\n    };\n    App.prototype.isChapterActive = function (chapter) {\n        return this.info.book.chapter == chapter.index + 1;\n    };\n    App.prototype.openChapter = function (chapter) {\n        this.info.book.chapter = chapter.index + 1;\n        AppEvents.broadcast(\"OpenChapter\", { ID: this.info.book.id, Chapter: this.info.book.chapter });\n    };\n    return App;\n}());\n__decorate([\n    ViewChild(Nav),\n    __metadata(\"design:type\", typeof (_a = typeof Nav !== \"undefined\" && Nav) === \"function\" && _a || Object)\n], App.prototype, \"nav\", void 0);\nApp = __decorate([\n    Component({\n        templateUrl: \"app.html\"\n    }),\n    __metadata(\"design:paramtypes\", [typeof (_b = typeof Platform !== \"undefined\" && Platform) === \"function\" && _b || Object, typeof (_c = typeof Device !== \"undefined\" && Device) === \"function\" && _c || Object, typeof (_d = typeof MenuController !== \"undefined\" && MenuController) === \"function\" && _d || Object, typeof (_e = typeof StatusBar !== \"undefined\" && StatusBar) === \"function\" && _e || Object, typeof (_f = typeof SplashScreen !== \"undefined\" && SplashScreen) === \"function\" && _f || Object, typeof (_g = typeof AlertController !== \"undefined\" && AlertController) === \"function\" && _g || Object, typeof (_h = typeof LoadingController !== \"undefined\" && LoadingController) === \"function\" && _h || Object, typeof (_j = typeof Storage !== \"undefined\" && Storage) === \"function\" && _j || Object, typeof (_k = typeof ConfigurationService !== \"undefined\" && ConfigurationService) === \"function\" && _k || Object, typeof (_l = typeof AuthenticationService !== \"undefined\" && AuthenticationService) === \"function\" && _l || Object, typeof (_m = typeof StatisticsService !== \"undefined\" && StatisticsService) === \"function\" && _m || Object, typeof (_o = typeof ResourcesService !== \"undefined\" && ResourcesService) === \"function\" && _o || Object, typeof (_p = typeof BooksService !== \"undefined\" && BooksService) === \"function\" && _p || Object])\n], App);\nexport { App };\nvar _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n//# sourceMappingURL=app.component.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { BrowserModule } from \"@angular/platform-browser\";\nimport { ErrorHandler, NgModule } from \"@angular/core\";\nimport { HttpModule } from \"@angular/http\";\nimport { FormsModule } from \"@angular/forms\";\nimport { IonicApp, IonicErrorHandler, IonicModule } from \"ionic-angular\";\nimport { CloudModule } from \"@ionic/cloud-angular\";\nimport { Device } from \"@ionic-native/device\";\nimport { StatusBar } from \"@ionic-native/status-bar\";\nimport { SplashScreen } from \"@ionic-native/splash-screen\";\nimport { Keyboard } from \"@ionic-native/keyboard\";\nimport { IonicStorageModule } from \"@ionic/storage\";\nimport { FileTransfer } from \"@ionic-native/file-transfer\";\nimport { ImageCropperModule } from \"ng2-img-cropper\";\nimport { Ng2CompleterModule } from \"ng2-completer\";\nimport { RatingModule } from \"ngx-rating\";\nimport { QRCodeModule } from \"angular2-qrcode\";\nimport { App } from \"./app.component\";\nimport { ConfigurationService } from \"../providers/configuration\";\nimport { AuthenticationService } from \"../providers/authentication\";\nimport { AccountsService } from \"../providers/accounts\";\nimport { BooksService } from \"../providers/books\";\nimport { StatisticsService } from \"../providers/statistics\";\nimport { ResourcesService } from \"../providers/resources\";\nimport { HomePage } from \"../pages/home/home\";\nimport { SearchPage } from \"../pages/search/search\";\nimport { SignInPage } from \"../pages/accounts/signin/signin\";\nimport { ProfilePage } from \"../pages/accounts/profile/profile\";\nimport { SearchProfilesPage } from \"../pages/accounts/search/search\";\nimport { SurfBooksPage } from \"../pages/books/surf/surf\";\nimport { ReadBookPage } from \"../pages/books/read/read\";\nimport { BookInfoPage } from \"../pages/books/info/info\";\nimport { ReadingOptionsPage } from \"../pages/books/options/options\";\nvar cloudSettings = {\n    \"core\": {\n        \"app_id\": \"\"\n    }\n};\nvar AppModule = (function () {\n    function AppModule() {\n    }\n    return AppModule;\n}());\nAppModule = __decorate([\n    NgModule({\n        declarations: [\n            App,\n            HomePage,\n            SearchPage,\n            SignInPage,\n            ProfilePage,\n            SearchProfilesPage,\n            SurfBooksPage,\n            ReadBookPage,\n            BookInfoPage,\n            ReadingOptionsPage,\n        ],\n        imports: [\n            BrowserModule,\n            HttpModule,\n            FormsModule,\n            IonicModule.forRoot(App),\n            IonicStorageModule.forRoot({ name: \"vieappsDB\" }),\n            CloudModule.forRoot(cloudSettings),\n            Ng2CompleterModule,\n            ImageCropperModule,\n            RatingModule,\n            QRCodeModule,\n        ],\n        bootstrap: [IonicApp],\n        entryComponents: [\n            App,\n            HomePage,\n            SearchPage,\n            SignInPage,\n            ProfilePage,\n            SearchProfilesPage,\n            SurfBooksPage,\n            ReadBookPage,\n            BookInfoPage,\n            ReadingOptionsPage,\n        ],\n        providers: [\n            ConfigurationService,\n            AuthenticationService,\n            ResourcesService,\n            StatisticsService,\n            AccountsService,\n            BooksService,\n            StatusBar,\n            SplashScreen,\n            Device,\n            Keyboard,\n            FileTransfer,\n            Ng2CompleterModule,\n            ImageCropperModule,\n            RatingModule,\n            QRCodeModule,\n            { provide: ErrorHandler, useClass: IonicErrorHandler }\n        ]\n    })\n], AppModule);\nexport { AppModule };\n//# sourceMappingURL=app.module.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","/**\n * @fileoverview This file is generated by the Angular template compiler.\n * Do not edit.\n * @suppress {suspiciousCode,uselessCode,missingProperties,missingOverride}\n */\n/* tslint:disable */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as import0 from '@angular/core';\nimport * as import1 from './app.module';\nimport * as import2 from '@angular/common';\nimport * as import3 from 'ionic-angular/util/ionic-error-handler';\nimport * as import4 from 'ionic-angular/platform/dom-controller';\nimport * as import5 from 'ionic-angular/components/app/menu-controller';\nimport * as import6 from 'ionic-angular/components/app/app';\nimport * as import7 from 'ionic-angular/gestures/gesture-controller';\nimport * as import8 from 'ionic-angular/util/ng-module-loader';\nimport * as import9 from '@angular/platform-browser';\nimport * as import10 from '@angular/http';\nimport * as import11 from '@angular/forms';\nimport * as import12 from 'ionic-angular/module';\nimport * as import13 from '@ionic/storage/es2015/index';\nimport * as import14 from '@ionic/cloud-angular/dist/es5/index';\nimport * as import15 from 'ng2-completer/ng2-completer.module';\nimport * as import16 from 'ng2-img-cropper/src/imageCropperModule';\nimport * as import17 from 'ngx-rating/index';\nimport * as import18 from 'angular2-qrcode';\nimport * as import19 from 'ionic-angular/gestures/gesture-config';\nimport * as import20 from 'ng2-completer/services/completer-service';\nimport * as import21 from 'ionic-angular/components/action-sheet/action-sheet-controller';\nimport * as import22 from 'ionic-angular/components/alert/alert-controller';\nimport * as import23 from 'ionic-angular/util/events';\nimport * as import24 from 'ionic-angular/util/form';\nimport * as import25 from 'ionic-angular/tap-click/haptic';\nimport * as import26 from 'ionic-angular/platform/keyboard';\nimport * as import27 from 'ionic-angular/components/loading/loading-controller';\nimport * as import28 from 'ionic-angular/components/modal/modal-controller';\nimport * as import29 from 'ionic-angular/components/picker/picker-controller';\nimport * as import30 from 'ionic-angular/components/popover/popover-controller';\nimport * as import31 from 'ionic-angular/tap-click/tap-click';\nimport * as import32 from 'ionic-angular/components/toast/toast-controller';\nimport * as import33 from 'ionic-angular/transitions/transition-controller';\nimport * as import34 from '@ionic-native/device/index';\nimport * as import35 from '../providers/configuration';\nimport * as import36 from '../providers/authentication';\nimport * as import37 from '../providers/resources';\nimport * as import38 from '../providers/statistics';\nimport * as import39 from '../providers/accounts';\nimport * as import40 from '../providers/books';\nimport * as import41 from '@ionic-native/status-bar/index';\nimport * as import42 from '@ionic-native/splash-screen/index';\nimport * as import43 from '@ionic-native/keyboard/index';\nimport * as import44 from '@ionic-native/file-transfer/index';\nimport * as import45 from '../../node_modules/ionic-angular/components/action-sheet/action-sheet-component.ngfactory';\nimport * as import46 from '../../node_modules/ionic-angular/components/alert/alert-component.ngfactory';\nimport * as import47 from '../../node_modules/ionic-angular/components/app/app-root.ngfactory';\nimport * as import48 from '../../node_modules/ionic-angular/components/loading/loading-component.ngfactory';\nimport * as import49 from '../../node_modules/ionic-angular/components/modal/modal-component.ngfactory';\nimport * as import50 from '../../node_modules/ionic-angular/components/picker/picker-component.ngfactory';\nimport * as import51 from '../../node_modules/ionic-angular/components/popover/popover-component.ngfactory';\nimport * as import52 from '../../node_modules/ionic-angular/components/select/select-popover-component.ngfactory';\nimport * as import53 from '../../node_modules/ionic-angular/components/toast/toast-component.ngfactory';\nimport * as import54 from './app.component.ngfactory';\nimport * as import55 from '../pages/home/home.ngfactory';\nimport * as import56 from '../pages/search/search.ngfactory';\nimport * as import57 from '../pages/accounts/signin/signin.ngfactory';\nimport * as import58 from '../pages/accounts/profile/profile.ngfactory';\nimport * as import59 from '../pages/accounts/search/search.ngfactory';\nimport * as import60 from '../pages/books/surf/surf.ngfactory';\nimport * as import61 from '../pages/books/read/read.ngfactory';\nimport * as import62 from '../pages/books/info/info.ngfactory';\nimport * as import63 from '../pages/books/options/options.ngfactory';\nimport * as import64 from 'ng2-completer/services/completer-data-factory';\nimport * as import65 from 'ionic-angular/navigation/url-serializer';\nimport * as import66 from 'ionic-angular/navigation/deep-linker';\nimport * as import67 from '@ionic/storage/es2015/storage';\nimport * as import68 from 'ionic-angular/platform/platform-registry';\nimport * as import69 from 'ionic-angular/platform/platform';\nimport * as import70 from 'ionic-angular/config/config';\nimport * as import71 from 'ionic-angular/util/module-loader';\nimport * as import72 from 'ionic-angular/config/mode-registry';\nimport * as import73 from './app.component';\nimport * as import74 from 'ng2-completer/services/local-data';\nimport * as import75 from 'ng2-completer/services/remote-data';\nimport * as import76 from 'ionic-angular/components/app/app-root';\nimport * as import77 from '@ionic/cloud/dist/es5/di';\nimport * as import78 from '@ionic/cloud/dist/es5/auth';\nimport * as import79 from '@ionic/cloud/dist/es5/client';\nimport * as import80 from '@ionic/cloud/dist/es5/config';\nimport * as import81 from '@ionic/cloud/dist/es5/database';\nimport * as import82 from '@ionic/cloud/dist/es5/deploy/deploy';\nimport * as import83 from '@ionic/cloud/dist/es5/push/push';\nimport * as import84 from '@ionic/cloud/dist/es5/user/user';\nvar AppModuleInjector = (function (_super) {\n    __extends(AppModuleInjector, _super);\n    function AppModuleInjector(parent) {\n        return _super.call(this, parent, [\n            import45.ActionSheetCmpNgFactory,\n            import46.AlertCmpNgFactory,\n            import47.IonicAppNgFactory,\n            import48.LoadingCmpNgFactory,\n            import49.ModalCmpNgFactory,\n            import50.PickerCmpNgFactory,\n            import51.PopoverCmpNgFactory,\n            import52.SelectPopoverNgFactory,\n            import53.ToastCmpNgFactory,\n            import54.AppNgFactory,\n            import55.HomePageNgFactory,\n            import56.SearchPageNgFactory,\n            import57.SignInPageNgFactory,\n            import58.ProfilePageNgFactory,\n            import59.SearchProfilesPageNgFactory,\n            import60.SurfBooksPageNgFactory,\n            import61.ReadBookPageNgFactory,\n            import62.BookInfoPageNgFactory,\n            import63.ReadingOptionsPageNgFactory\n        ], [import47.IonicAppNgFactory]) || this;\n    }\n    Object.defineProperty(AppModuleInjector.prototype, \"_LOCALE_ID_32\", {\n        get: function () {\n            if ((this.__LOCALE_ID_32 == null)) {\n                (this.__LOCALE_ID_32 = import0.ɵn(this.parent.get(import0.LOCALE_ID, null)));\n            }\n            return this.__LOCALE_ID_32;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_NgLocalization_33\", {\n        get: function () {\n            if ((this.__NgLocalization_33 == null)) {\n                (this.__NgLocalization_33 = new import2.NgLocaleLocalization(this._LOCALE_ID_32));\n            }\n            return this.__NgLocalization_33;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_APP_ID_34\", {\n        get: function () {\n            if ((this.__APP_ID_34 == null)) {\n                (this.__APP_ID_34 = import0.ɵg());\n            }\n            return this.__APP_ID_34;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_IterableDiffers_35\", {\n        get: function () {\n            if ((this.__IterableDiffers_35 == null)) {\n                (this.__IterableDiffers_35 = import0.ɵl());\n            }\n            return this.__IterableDiffers_35;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_KeyValueDiffers_36\", {\n        get: function () {\n            if ((this.__KeyValueDiffers_36 == null)) {\n                (this.__KeyValueDiffers_36 = import0.ɵm());\n            }\n            return this.__KeyValueDiffers_36;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_DomSanitizer_37\", {\n        get: function () {\n            if ((this.__DomSanitizer_37 == null)) {\n                (this.__DomSanitizer_37 = new import9.ɵe(this.parent.get(import9.DOCUMENT)));\n            }\n            return this.__DomSanitizer_37;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Sanitizer_38\", {\n        get: function () {\n            if ((this.__Sanitizer_38 == null)) {\n                (this.__Sanitizer_38 = this._DomSanitizer_37);\n            }\n            return this.__Sanitizer_38;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_HAMMER_GESTURE_CONFIG_39\", {\n        get: function () {\n            if ((this.__HAMMER_GESTURE_CONFIG_39 == null)) {\n                (this.__HAMMER_GESTURE_CONFIG_39 = new import19.IonicGestureConfig());\n            }\n            return this.__HAMMER_GESTURE_CONFIG_39;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_EVENT_MANAGER_PLUGINS_40\", {\n        get: function () {\n            if ((this.__EVENT_MANAGER_PLUGINS_40 == null)) {\n                (this.__EVENT_MANAGER_PLUGINS_40 = [\n                    new import9.ɵDomEventsPlugin(this.parent.get(import9.DOCUMENT)),\n                    new import9.ɵKeyEventsPlugin(this.parent.get(import9.DOCUMENT)),\n                    new import9.ɵHammerGesturesPlugin(this.parent.get(import9.DOCUMENT), this._HAMMER_GESTURE_CONFIG_39)\n                ]);\n            }\n            return this.__EVENT_MANAGER_PLUGINS_40;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_EventManager_41\", {\n        get: function () {\n            if ((this.__EventManager_41 == null)) {\n                (this.__EventManager_41 = new import9.EventManager(this._EVENT_MANAGER_PLUGINS_40, this.parent.get(import0.NgZone)));\n            }\n            return this.__EventManager_41;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_\\u0275DomSharedStylesHost_42\", {\n        get: function () {\n            if ((this.__ɵDomSharedStylesHost_42 == null)) {\n                (this.__ɵDomSharedStylesHost_42 = new import9.ɵDomSharedStylesHost(this.parent.get(import9.DOCUMENT)));\n            }\n            return this.__ɵDomSharedStylesHost_42;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_\\u0275DomRendererFactory2_43\", {\n        get: function () {\n            if ((this.__ɵDomRendererFactory2_43 == null)) {\n                (this.__ɵDomRendererFactory2_43 = new import9.ɵDomRendererFactory2(this._EventManager_41, this._ɵDomSharedStylesHost_42));\n            }\n            return this.__ɵDomRendererFactory2_43;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_RendererFactory2_44\", {\n        get: function () {\n            if ((this.__RendererFactory2_44 == null)) {\n                (this.__RendererFactory2_44 = this._ɵDomRendererFactory2_43);\n            }\n            return this.__RendererFactory2_44;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_\\u0275SharedStylesHost_45\", {\n        get: function () {\n            if ((this.__ɵSharedStylesHost_45 == null)) {\n                (this.__ɵSharedStylesHost_45 = this._ɵDomSharedStylesHost_42);\n            }\n            return this.__ɵSharedStylesHost_45;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Testability_46\", {\n        get: function () {\n            if ((this.__Testability_46 == null)) {\n                (this.__Testability_46 = new import0.Testability(this.parent.get(import0.NgZone)));\n            }\n            return this.__Testability_46;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Meta_47\", {\n        get: function () {\n            if ((this.__Meta_47 == null)) {\n                (this.__Meta_47 = new import9.Meta(this.parent.get(import9.DOCUMENT)));\n            }\n            return this.__Meta_47;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Title_48\", {\n        get: function () {\n            if ((this.__Title_48 == null)) {\n                (this.__Title_48 = new import9.Title(this.parent.get(import9.DOCUMENT)));\n            }\n            return this.__Title_48;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_BrowserXhr_49\", {\n        get: function () {\n            if ((this.__BrowserXhr_49 == null)) {\n                (this.__BrowserXhr_49 = new import10.BrowserXhr());\n            }\n            return this.__BrowserXhr_49;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ResponseOptions_50\", {\n        get: function () {\n            if ((this.__ResponseOptions_50 == null)) {\n                (this.__ResponseOptions_50 = new import10.BaseResponseOptions());\n            }\n            return this.__ResponseOptions_50;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_XSRFStrategy_51\", {\n        get: function () {\n            if ((this.__XSRFStrategy_51 == null)) {\n                (this.__XSRFStrategy_51 = import10.ɵb());\n            }\n            return this.__XSRFStrategy_51;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_XHRBackend_52\", {\n        get: function () {\n            if ((this.__XHRBackend_52 == null)) {\n                (this.__XHRBackend_52 = new import10.XHRBackend(this._BrowserXhr_49, this._ResponseOptions_50, this._XSRFStrategy_51));\n            }\n            return this.__XHRBackend_52;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_RequestOptions_53\", {\n        get: function () {\n            if ((this.__RequestOptions_53 == null)) {\n                (this.__RequestOptions_53 = new import10.BaseRequestOptions());\n            }\n            return this.__RequestOptions_53;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Http_54\", {\n        get: function () {\n            if ((this.__Http_54 == null)) {\n                (this.__Http_54 = import10.ɵc(this._XHRBackend_52, this._RequestOptions_53));\n            }\n            return this.__Http_54;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_\\u0275i_55\", {\n        get: function () {\n            if ((this.__ɵi_55 == null)) {\n                (this.__ɵi_55 = new import11.ɵi());\n            }\n            return this.__ɵi_55;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_FormBuilder_56\", {\n        get: function () {\n            if ((this.__FormBuilder_56 == null)) {\n                (this.__FormBuilder_56 = new import11.FormBuilder());\n            }\n            return this.__FormBuilder_56;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_LocalData_57\", {\n        get: function () {\n            if ((this.__LocalData_57 == null)) {\n                (this.__LocalData_57 = import64.localDataFactory());\n            }\n            return this.__LocalData_57;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_RemoteData_58\", {\n        get: function () {\n            if ((this.__RemoteData_58 == null)) {\n                (this.__RemoteData_58 = import64.remoteDataFactory(this._Http_54));\n            }\n            return this.__RemoteData_58;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_CompleterService_59\", {\n        get: function () {\n            if ((this.__CompleterService_59 == null)) {\n                (this.__CompleterService_59 = new import20.CompleterService(this._LocalData_57, this._RemoteData_58));\n            }\n            return this.__CompleterService_59;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ActionSheetController_62\", {\n        get: function () {\n            if ((this.__ActionSheetController_62 == null)) {\n                (this.__ActionSheetController_62 = new import21.ActionSheetController(this._App_8, this._Config_5));\n            }\n            return this.__ActionSheetController_62;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_AlertController_63\", {\n        get: function () {\n            if ((this.__AlertController_63 == null)) {\n                (this.__AlertController_63 = new import22.AlertController(this._App_8, this._Config_5));\n            }\n            return this.__AlertController_63;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Events_64\", {\n        get: function () {\n            if ((this.__Events_64 == null)) {\n                (this.__Events_64 = new import23.Events());\n            }\n            return this.__Events_64;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Form_65\", {\n        get: function () {\n            if ((this.__Form_65 == null)) {\n                (this.__Form_65 = new import24.Form());\n            }\n            return this.__Form_65;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Haptic_66\", {\n        get: function () {\n            if ((this.__Haptic_66 == null)) {\n                (this.__Haptic_66 = new import25.Haptic(this._Platform_4));\n            }\n            return this.__Haptic_66;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Keyboard_67\", {\n        get: function () {\n            if ((this.__Keyboard_67 == null)) {\n                (this.__Keyboard_67 = new import26.Keyboard(this._Config_5, this._Platform_4, this.parent.get(import0.NgZone), this._DomController_6));\n            }\n            return this.__Keyboard_67;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_LoadingController_68\", {\n        get: function () {\n            if ((this.__LoadingController_68 == null)) {\n                (this.__LoadingController_68 = new import27.LoadingController(this._App_8, this._Config_5));\n            }\n            return this.__LoadingController_68;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_LocationStrategy_69\", {\n        get: function () {\n            if ((this.__LocationStrategy_69 == null)) {\n                (this.__LocationStrategy_69 = import12.provideLocationStrategy(this.parent.get(import2.PlatformLocation), this._APP_BASE_HREF_61, this._Config_5));\n            }\n            return this.__LocationStrategy_69;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Location_70\", {\n        get: function () {\n            if ((this.__Location_70 == null)) {\n                (this.__Location_70 = new import2.Location(this._LocationStrategy_69));\n            }\n            return this.__Location_70;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_UrlSerializer_71\", {\n        get: function () {\n            if ((this.__UrlSerializer_71 == null)) {\n                (this.__UrlSerializer_71 = import65.setupUrlSerializer(this._App_8, this._DeepLinkConfigToken_10));\n            }\n            return this.__UrlSerializer_71;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_DeepLinker_72\", {\n        get: function () {\n            if ((this.__DeepLinker_72 == null)) {\n                (this.__DeepLinker_72 = import66.setupDeepLinker(this._App_8, this._UrlSerializer_71, this._Location_70, this._ModuleLoader_13, this.componentFactoryResolver));\n            }\n            return this.__DeepLinker_72;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ModalController_73\", {\n        get: function () {\n            if ((this.__ModalController_73 == null)) {\n                (this.__ModalController_73 = new import28.ModalController(this._App_8, this._Config_5, this._DeepLinker_72));\n            }\n            return this.__ModalController_73;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_PickerController_74\", {\n        get: function () {\n            if ((this.__PickerController_74 == null)) {\n                (this.__PickerController_74 = new import29.PickerController(this._App_8, this._Config_5));\n            }\n            return this.__PickerController_74;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_PopoverController_75\", {\n        get: function () {\n            if ((this.__PopoverController_75 == null)) {\n                (this.__PopoverController_75 = new import30.PopoverController(this._App_8, this._Config_5, this._DeepLinker_72));\n            }\n            return this.__PopoverController_75;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_TapClick_76\", {\n        get: function () {\n            if ((this.__TapClick_76 == null)) {\n                (this.__TapClick_76 = new import31.TapClick(this._Config_5, this._Platform_4, this._DomController_6, this._App_8, this._GestureController_9));\n            }\n            return this.__TapClick_76;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ToastController_77\", {\n        get: function () {\n            if ((this.__ToastController_77 == null)) {\n                (this.__ToastController_77 = new import32.ToastController(this._App_8, this._Config_5));\n            }\n            return this.__ToastController_77;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_TransitionController_78\", {\n        get: function () {\n            if ((this.__TransitionController_78 == null)) {\n                (this.__TransitionController_78 = new import33.TransitionController(this._Platform_4, this._Config_5));\n            }\n            return this.__TransitionController_78;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Storage_80\", {\n        get: function () {\n            if ((this.__Storage_80 == null)) {\n                (this.__Storage_80 = import67.provideStorage(this._StorageConfigToken_79));\n            }\n            return this.__Storage_80;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Container_82\", {\n        get: function () {\n            if ((this.__Container_82 == null)) {\n                (this.__Container_82 = import14.provideContainer(this._CloudSettingsToken_81));\n            }\n            return this.__Container_82;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Auth_83\", {\n        get: function () {\n            if ((this.__Auth_83 == null)) {\n                (this.__Auth_83 = import14.provideAuth(this._Container_82));\n            }\n            return this.__Auth_83;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Client_84\", {\n        get: function () {\n            if ((this.__Client_84 == null)) {\n                (this.__Client_84 = import14.provideClient(this._Container_82));\n            }\n            return this.__Client_84;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Config_85\", {\n        get: function () {\n            if ((this.__Config_85 == null)) {\n                (this.__Config_85 = import14.provideConfig(this._Container_82));\n            }\n            return this.__Config_85;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Database_86\", {\n        get: function () {\n            if ((this.__Database_86 == null)) {\n                (this.__Database_86 = import14.provideDatabase(this._Container_82));\n            }\n            return this.__Database_86;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Deploy_87\", {\n        get: function () {\n            if ((this.__Deploy_87 == null)) {\n                (this.__Deploy_87 = import14.provideDeploy(this._Container_82));\n            }\n            return this.__Deploy_87;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Push_88\", {\n        get: function () {\n            if ((this.__Push_88 == null)) {\n                (this.__Push_88 = import14.providePush(this._Container_82));\n            }\n            return this.__Push_88;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_User_89\", {\n        get: function () {\n            if ((this.__User_89 == null)) {\n                (this.__User_89 = import14.provideUser(this._Container_82));\n            }\n            return this.__User_89;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_FacebookAuth_90\", {\n        get: function () {\n            if ((this.__FacebookAuth_90 == null)) {\n                (this.__FacebookAuth_90 = import14.provideFacebookAuth(this._Container_82));\n            }\n            return this.__FacebookAuth_90;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_GoogleAuth_91\", {\n        get: function () {\n            if ((this.__GoogleAuth_91 == null)) {\n                (this.__GoogleAuth_91 = import14.provideGoogleAuth(this._Container_82));\n            }\n            return this.__GoogleAuth_91;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Device_92\", {\n        get: function () {\n            if ((this.__Device_92 == null)) {\n                (this.__Device_92 = new import34.Device());\n            }\n            return this.__Device_92;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ConfigurationService_93\", {\n        get: function () {\n            if ((this.__ConfigurationService_93 == null)) {\n                (this.__ConfigurationService_93 = new import35.ConfigurationService(this._Http_54, this._Platform_4, this._Device_92, this._Storage_80));\n            }\n            return this.__ConfigurationService_93;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_AuthenticationService_94\", {\n        get: function () {\n            if ((this.__AuthenticationService_94 == null)) {\n                (this.__AuthenticationService_94 = new import36.AuthenticationService(this._Http_54, this._ConfigurationService_93));\n            }\n            return this.__AuthenticationService_94;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_ResourcesService_95\", {\n        get: function () {\n            if ((this.__ResourcesService_95 == null)) {\n                (this.__ResourcesService_95 = new import37.ResourcesService(this._Http_54, this._Storage_80));\n            }\n            return this.__ResourcesService_95;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_StatisticsService_96\", {\n        get: function () {\n            if ((this.__StatisticsService_96 == null)) {\n                (this.__StatisticsService_96 = new import38.StatisticsService(this._Http_54, this._Storage_80, this._ConfigurationService_93));\n            }\n            return this.__StatisticsService_96;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_AccountsService_97\", {\n        get: function () {\n            if ((this.__AccountsService_97 == null)) {\n                (this.__AccountsService_97 = new import39.AccountsService(this._Http_54));\n            }\n            return this.__AccountsService_97;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_BooksService_98\", {\n        get: function () {\n            if ((this.__BooksService_98 == null)) {\n                (this.__BooksService_98 = new import40.BooksService(this._Http_54, this._ConfigurationService_93, this._StatisticsService_96));\n            }\n            return this.__BooksService_98;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_StatusBar_99\", {\n        get: function () {\n            if ((this.__StatusBar_99 == null)) {\n                (this.__StatusBar_99 = new import41.StatusBar());\n            }\n            return this.__StatusBar_99;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_SplashScreen_100\", {\n        get: function () {\n            if ((this.__SplashScreen_100 == null)) {\n                (this.__SplashScreen_100 = new import42.SplashScreen());\n            }\n            return this.__SplashScreen_100;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_Keyboard_101\", {\n        get: function () {\n            if ((this.__Keyboard_101 == null)) {\n                (this.__Keyboard_101 = new import43.Keyboard());\n            }\n            return this.__Keyboard_101;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppModuleInjector.prototype, \"_FileTransfer_102\", {\n        get: function () {\n            if ((this.__FileTransfer_102 == null)) {\n                (this.__FileTransfer_102 = new import44.FileTransfer());\n            }\n            return this.__FileTransfer_102;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AppModuleInjector.prototype.createInternal = function () {\n        this._CommonModule_0 = new import2.CommonModule();\n        this._ErrorHandler_1 = new import3.IonicErrorHandler();\n        this._ConfigToken_2 = null;\n        this._PlatformConfigToken_3 = import68.providePlatformConfigs();\n        this._Platform_4 = import69.setupPlatform(this.parent.get(import9.DOCUMENT), this._PlatformConfigToken_3, this.parent.get(import0.NgZone));\n        this._Config_5 = import70.setupConfig(this._ConfigToken_2, this._Platform_4);\n        this._DomController_6 = new import4.DomController(this._Platform_4);\n        this._MenuController_7 = new import5.MenuController();\n        this._App_8 = new import6.App(this._Config_5, this._Platform_4, this._MenuController_7);\n        this._GestureController_9 = new import7.GestureController(this._App_8);\n        this._DeepLinkConfigToken_10 = null;\n        this._Compiler_11 = new import0.Compiler();\n        this._NgModuleLoader_12 = new import8.NgModuleLoader(this._Compiler_11);\n        this._ModuleLoader_13 = import71.provideModuleLoader(this._NgModuleLoader_12, this);\n        this._APP_INITIALIZER_14 = [\n            import0.ɵo,\n            import9.ɵc(this.parent.get(import9.NgProbeToken, null), this.parent.get(import0.NgProbeToken, null)),\n            import72.registerModeConfigs(this._Config_5),\n            import23.setupProvideEvents(this._Platform_4, this._DomController_6),\n            import31.setupTapClick(this._Config_5, this._Platform_4, this._DomController_6, this._App_8, this._GestureController_9),\n            import71.setupPreloading(this._Config_5, this._DeepLinkConfigToken_10, this._ModuleLoader_13, this.parent.get(import0.NgZone))\n        ];\n        this._ApplicationInitStatus_15 = new import0.ApplicationInitStatus(this._APP_INITIALIZER_14);\n        this._ɵf_16 = new import0.ɵf(this.parent.get(import0.NgZone), this.parent.get(import0.ɵConsole), this, this._ErrorHandler_1, this.componentFactoryResolver, this._ApplicationInitStatus_15);\n        this._ApplicationRef_17 = this._ɵf_16;\n        this._ApplicationModule_18 = new import0.ApplicationModule(this._ApplicationRef_17);\n        this._BrowserModule_19 = new import9.BrowserModule(this.parent.get(import9.BrowserModule, null));\n        this._HttpModule_20 = new import10.HttpModule();\n        this._ɵba_21 = new import11.ɵba();\n        this._FormsModule_22 = new import11.FormsModule();\n        this._ReactiveFormsModule_23 = new import11.ReactiveFormsModule();\n        this._IonicModule_24 = new import12.IonicModule();\n        this._IonicStorageModule_25 = new import13.IonicStorageModule();\n        this._CloudModule_26 = new import14.CloudModule();\n        this._Ng2CompleterModule_27 = new import15.Ng2CompleterModule();\n        this._ImageCropperModule_28 = new import16.ImageCropperModule();\n        this._RatingModule_29 = new import17.RatingModule();\n        this._QRCodeModule_30 = new import18.QRCodeModule();\n        this._AppModule_31 = new import1.AppModule();\n        this._AppRootToken_60 = import73.App;\n        this._APP_BASE_HREF_61 = '/';\n        this._StorageConfigToken_79 = { name: 'vieappsDB' };\n        this._CloudSettingsToken_81 = { core: { app_id: '' } };\n        return this._AppModule_31;\n    };\n    AppModuleInjector.prototype.getInternal = function (token, notFoundResult) {\n        if ((token === import2.CommonModule)) {\n            return this._CommonModule_0;\n        }\n        if ((token === import0.ErrorHandler)) {\n            return this._ErrorHandler_1;\n        }\n        if ((token === import70.ConfigToken)) {\n            return this._ConfigToken_2;\n        }\n        if ((token === import68.PlatformConfigToken)) {\n            return this._PlatformConfigToken_3;\n        }\n        if ((token === import69.Platform)) {\n            return this._Platform_4;\n        }\n        if ((token === import70.Config)) {\n            return this._Config_5;\n        }\n        if ((token === import4.DomController)) {\n            return this._DomController_6;\n        }\n        if ((token === import5.MenuController)) {\n            return this._MenuController_7;\n        }\n        if ((token === import6.App)) {\n            return this._App_8;\n        }\n        if ((token === import7.GestureController)) {\n            return this._GestureController_9;\n        }\n        if ((token === import65.DeepLinkConfigToken)) {\n            return this._DeepLinkConfigToken_10;\n        }\n        if ((token === import0.Compiler)) {\n            return this._Compiler_11;\n        }\n        if ((token === import8.NgModuleLoader)) {\n            return this._NgModuleLoader_12;\n        }\n        if ((token === import71.ModuleLoader)) {\n            return this._ModuleLoader_13;\n        }\n        if ((token === import0.APP_INITIALIZER)) {\n            return this._APP_INITIALIZER_14;\n        }\n        if ((token === import0.ApplicationInitStatus)) {\n            return this._ApplicationInitStatus_15;\n        }\n        if ((token === import0.ɵf)) {\n            return this._ɵf_16;\n        }\n        if ((token === import0.ApplicationRef)) {\n            return this._ApplicationRef_17;\n        }\n        if ((token === import0.ApplicationModule)) {\n            return this._ApplicationModule_18;\n        }\n        if ((token === import9.BrowserModule)) {\n            return this._BrowserModule_19;\n        }\n        if ((token === import10.HttpModule)) {\n            return this._HttpModule_20;\n        }\n        if ((token === import11.ɵba)) {\n            return this._ɵba_21;\n        }\n        if ((token === import11.FormsModule)) {\n            return this._FormsModule_22;\n        }\n        if ((token === import11.ReactiveFormsModule)) {\n            return this._ReactiveFormsModule_23;\n        }\n        if ((token === import12.IonicModule)) {\n            return this._IonicModule_24;\n        }\n        if ((token === import13.IonicStorageModule)) {\n            return this._IonicStorageModule_25;\n        }\n        if ((token === import14.CloudModule)) {\n            return this._CloudModule_26;\n        }\n        if ((token === import15.Ng2CompleterModule)) {\n            return this._Ng2CompleterModule_27;\n        }\n        if ((token === import16.ImageCropperModule)) {\n            return this._ImageCropperModule_28;\n        }\n        if ((token === import17.RatingModule)) {\n            return this._RatingModule_29;\n        }\n        if ((token === import18.QRCodeModule)) {\n            return this._QRCodeModule_30;\n        }\n        if ((token === import1.AppModule)) {\n            return this._AppModule_31;\n        }\n        if ((token === import0.LOCALE_ID)) {\n            return this._LOCALE_ID_32;\n        }\n        if ((token === import2.NgLocalization)) {\n            return this._NgLocalization_33;\n        }\n        if ((token === import0.APP_ID)) {\n            return this._APP_ID_34;\n        }\n        if ((token === import0.IterableDiffers)) {\n            return this._IterableDiffers_35;\n        }\n        if ((token === import0.KeyValueDiffers)) {\n            return this._KeyValueDiffers_36;\n        }\n        if ((token === import9.DomSanitizer)) {\n            return this._DomSanitizer_37;\n        }\n        if ((token === import0.Sanitizer)) {\n            return this._Sanitizer_38;\n        }\n        if ((token === import9.HAMMER_GESTURE_CONFIG)) {\n            return this._HAMMER_GESTURE_CONFIG_39;\n        }\n        if ((token === import9.EVENT_MANAGER_PLUGINS)) {\n            return this._EVENT_MANAGER_PLUGINS_40;\n        }\n        if ((token === import9.EventManager)) {\n            return this._EventManager_41;\n        }\n        if ((token === import9.ɵDomSharedStylesHost)) {\n            return this._ɵDomSharedStylesHost_42;\n        }\n        if ((token === import9.ɵDomRendererFactory2)) {\n            return this._ɵDomRendererFactory2_43;\n        }\n        if ((token === import0.RendererFactory2)) {\n            return this._RendererFactory2_44;\n        }\n        if ((token === import9.ɵSharedStylesHost)) {\n            return this._ɵSharedStylesHost_45;\n        }\n        if ((token === import0.Testability)) {\n            return this._Testability_46;\n        }\n        if ((token === import9.Meta)) {\n            return this._Meta_47;\n        }\n        if ((token === import9.Title)) {\n            return this._Title_48;\n        }\n        if ((token === import10.BrowserXhr)) {\n            return this._BrowserXhr_49;\n        }\n        if ((token === import10.ResponseOptions)) {\n            return this._ResponseOptions_50;\n        }\n        if ((token === import10.XSRFStrategy)) {\n            return this._XSRFStrategy_51;\n        }\n        if ((token === import10.XHRBackend)) {\n            return this._XHRBackend_52;\n        }\n        if ((token === import10.RequestOptions)) {\n            return this._RequestOptions_53;\n        }\n        if ((token === import10.Http)) {\n            return this._Http_54;\n        }\n        if ((token === import11.ɵi)) {\n            return this._ɵi_55;\n        }\n        if ((token === import11.FormBuilder)) {\n            return this._FormBuilder_56;\n        }\n        if ((token === import74.LocalData)) {\n            return this._LocalData_57;\n        }\n        if ((token === import75.RemoteData)) {\n            return this._RemoteData_58;\n        }\n        if ((token === import20.CompleterService)) {\n            return this._CompleterService_59;\n        }\n        if ((token === import76.AppRootToken)) {\n            return this._AppRootToken_60;\n        }\n        if ((token === import2.APP_BASE_HREF)) {\n            return this._APP_BASE_HREF_61;\n        }\n        if ((token === import21.ActionSheetController)) {\n            return this._ActionSheetController_62;\n        }\n        if ((token === import22.AlertController)) {\n            return this._AlertController_63;\n        }\n        if ((token === import23.Events)) {\n            return this._Events_64;\n        }\n        if ((token === import24.Form)) {\n            return this._Form_65;\n        }\n        if ((token === import25.Haptic)) {\n            return this._Haptic_66;\n        }\n        if ((token === import26.Keyboard)) {\n            return this._Keyboard_67;\n        }\n        if ((token === import27.LoadingController)) {\n            return this._LoadingController_68;\n        }\n        if ((token === import2.LocationStrategy)) {\n            return this._LocationStrategy_69;\n        }\n        if ((token === import2.Location)) {\n            return this._Location_70;\n        }\n        if ((token === import65.UrlSerializer)) {\n            return this._UrlSerializer_71;\n        }\n        if ((token === import66.DeepLinker)) {\n            return this._DeepLinker_72;\n        }\n        if ((token === import28.ModalController)) {\n            return this._ModalController_73;\n        }\n        if ((token === import29.PickerController)) {\n            return this._PickerController_74;\n        }\n        if ((token === import30.PopoverController)) {\n            return this._PopoverController_75;\n        }\n        if ((token === import31.TapClick)) {\n            return this._TapClick_76;\n        }\n        if ((token === import32.ToastController)) {\n            return this._ToastController_77;\n        }\n        if ((token === import33.TransitionController)) {\n            return this._TransitionController_78;\n        }\n        if ((token === import67.StorageConfigToken)) {\n            return this._StorageConfigToken_79;\n        }\n        if ((token === import67.Storage)) {\n            return this._Storage_80;\n        }\n        if ((token === import14.CloudSettingsToken)) {\n            return this._CloudSettingsToken_81;\n        }\n        if ((token === import77.Container)) {\n            return this._Container_82;\n        }\n        if ((token === import78.Auth)) {\n            return this._Auth_83;\n        }\n        if ((token === import79.Client)) {\n            return this._Client_84;\n        }\n        if ((token === import80.Config)) {\n            return this._Config_85;\n        }\n        if ((token === import81.Database)) {\n            return this._Database_86;\n        }\n        if ((token === import82.Deploy)) {\n            return this._Deploy_87;\n        }\n        if ((token === import83.Push)) {\n            return this._Push_88;\n        }\n        if ((token === import84.User)) {\n            return this._User_89;\n        }\n        if ((token === import78.FacebookAuth)) {\n            return this._FacebookAuth_90;\n        }\n        if ((token === import78.GoogleAuth)) {\n            return this._GoogleAuth_91;\n        }\n        if ((token === import34.Device)) {\n            return this._Device_92;\n        }\n        if ((token === import35.ConfigurationService)) {\n            return this._ConfigurationService_93;\n        }\n        if ((token === import36.AuthenticationService)) {\n            return this._AuthenticationService_94;\n        }\n        if ((token === import37.ResourcesService)) {\n            return this._ResourcesService_95;\n        }\n        if ((token === import38.StatisticsService)) {\n            return this._StatisticsService_96;\n        }\n        if ((token === import39.AccountsService)) {\n            return this._AccountsService_97;\n        }\n        if ((token === import40.BooksService)) {\n            return this._BooksService_98;\n        }\n        if ((token === import41.StatusBar)) {\n            return this._StatusBar_99;\n        }\n        if ((token === import42.SplashScreen)) {\n            return this._SplashScreen_100;\n        }\n        if ((token === import43.Keyboard)) {\n            return this._Keyboard_101;\n        }\n        if ((token === import44.FileTransfer)) {\n            return this._FileTransfer_102;\n        }\n        return notFoundResult;\n    };\n    AppModuleInjector.prototype.destroyInternal = function () {\n        this._ɵf_16.ngOnDestroy();\n        (this.__ɵDomSharedStylesHost_42 && this._ɵDomSharedStylesHost_42.ngOnDestroy());\n    };\n    return AppModuleInjector;\n}(import0.ɵNgModuleInjector));\nexport var AppModuleNgFactory = new import0.NgModuleFactory(AppModuleInjector, import1.AppModule);\n//# sourceMappingURL=data:application/json;base64,eyJmaWxlIjoiL1VzZXJzL3F1eW5obmd1eWVuL0RvY3VtZW50cy9WSUUgQXBwcy9BcHBzL0Jvb2tzLlBXQS9zcmMvYXBwL2FwcC5tb2R1bGUubmdmYWN0b3J5LnRzIiwidmVyc2lvbiI6Mywic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibmc6Ly8vVXNlcnMvcXV5bmhuZ3V5ZW4vRG9jdW1lbnRzL1ZJRSBBcHBzL0FwcHMvQm9va3MuUFdBL3NyYy9hcHAvYXBwLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIgIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsifQ==\n//# sourceMappingURL=app.module.ngfactory.js.map\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ngfactory.ts"]}